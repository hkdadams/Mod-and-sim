(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    301433,       6329]
NotebookOptionsPosition[    292689,       6203]
NotebookOutlinePosition[    293235,       6222]
CellTagsIndexPosition[    293192,       6219]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[" ", "BookChapterNumber",ExpressionUUID->"8acb7c6c-d3ae-364f-913e-789658128682"],

Cell["Wildfires", "BookChapterTitle",
 CellChangeTimes->{{3.9408347088209705`*^9, 3.940834713179878*^9}, {
  3.9427071037132244`*^9, 
  3.942707106114172*^9}},ExpressionUUID->"c525ce74-888d-264f-864b-\
dd137e0fd588"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["BookChapterNumber"],
 ". A simple SIR model"
}], "Subtitle",
 CellChangeTimes->{{3.940834717813463*^9, 3.9408347263932056`*^9}, {
  3.94083508946632*^9, 3.9408350901206665`*^9}, {3.942715994610756*^9, 
  3.9427159948469887`*^9}},ExpressionUUID->"9170263a-4ec9-0548-aa98-\
051e5ed25acc"],

Cell["\<\
In each of these models code has come from the lecture notes or my own work \
some of which used AI to help write functions.\
\>", "Text",
 CellChangeTimes->{{3.9427460177003746`*^9, 
  3.9427461043570786`*^9}},ExpressionUUID->"2593fa21-375a-d741-9909-\
241097411988"],

Cell[CellGroupData[{

Cell[TextData[{
 
 CounterBox["BookChapterNumber"],
 ".",
 
 CounterBox["Section"],
 " Initial model"
}], "Section",
 CellChangeTimes->{{3.9427054559271603`*^9, 3.9427054637643948`*^9}, {
  3.942715997525337*^9, 
  3.9427159979971447`*^9}},ExpressionUUID->"0ab83411-9d95-2040-a4a7-\
20cfe6d3b9ba"],

Cell["\<\
An SIR model based on how wildfires spread with variable inputs .\
\>", "Text",
 CellChangeTimes->{{3.9408350975721016`*^9, 3.940835113979746*^9}, {
  3.940835154692568*^9, 3.940835198439602*^9}, {3.9408360134099255`*^9, 
  3.9408360134099255`*^9}},ExpressionUUID->"d31298c6-f854-7e41-9ae1-\
07ad88d5d032"],

Cell["", "Text",
 CellChangeTimes->{{3.9408350975721016`*^9, 3.940835113979746*^9}, {
  3.940835154692568*^9, 3.940835198439602*^9}, {3.9408360162450504`*^9, 
  3.9408360162450504`*^9}},ExpressionUUID->"903f321c-5b54-3a40-9bdf-\
8082a610a377"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    StyleBox["dS",
     FontSlant->"Italic"], 
    StyleBox["dt",
     FontSlant->"Italic"]], "=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      StyleBox["firespread",
       FontSlant->"Italic"], "*", "S", "*", "F"}], 
     StyleBox[
      RowBox[{"population", " ", "size"}],
      FontSlant->"Italic"]]}]}], TraditionalForm]],
 FormatType->
  TraditionalForm,ExpressionUUID->"de60498b-e2a7-4f4a-8c7f-87e516ea61ea"]], \
"EquationNumbered",
 CellChangeTimes->{{3.9427054995004025`*^9, 3.942705698187731*^9}, {
  3.9427058152897606`*^9, 
  3.942705815610615*^9}},ExpressionUUID->"d80ffd99-bd60-0045-a62c-\
75cdcd409203"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dF",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "="}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "19e655b3-4070-224a-9e14-17c2a25cf5d5"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      StyleBox["firespread",
       FontSlant->"Italic"], "*", "S", "*", "F"}], 
     StyleBox[
      RowBox[{"population", " ", "size"}],
      FontSlant->"Italic"]], "-", 
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1fe6ff1f-871c-6241-be95-7594a32f345f"]
}], "EquationNumbered",
 CellChangeTimes->{{3.9427054995004025`*^9, 
  3.942705818774626*^9}},ExpressionUUID->"79f03985-80e9-ee47-9e87-\
480f8a4153fe"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dD",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "="}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5534ccd7-05d6-fd4b-9776-e5dc54d59e89"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["deathRate",
     FontSlant->"Italic"], 
    StyleBox["*",
     FontSlant->"Italic"], "F"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a1d01a1f-c721-6d4b-b33f-8edbf1fd86e2"]
}], "EquationNumbered",
 CellChangeTimes->{{3.9427054995004025`*^9, 
  3.9427058406947136`*^9}},ExpressionUUID->"5ebef9e8-e419-164b-9b6b-\
dad861e3db6d"],

Cell["", "Text",
 CellChangeTimes->{{3.9408350975721016`*^9, 3.940835113979746*^9}, {
   3.940835154692568*^9, 3.940835198439602*^9}, {3.940836016782152*^9, 
   3.940836026608843*^9}, {3.9408460569489784`*^9, 3.9408460581819324`*^9}, 
   3.94100568078825*^9},ExpressionUUID->"c8f5ed6b-1bc4-5e4d-bfed-\
748ced127682"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Total", " ", "population", " ", "size"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"populationSize", " ", "=", " ", "1000"}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"SIR", " ", "Model", " ", "Derivatives"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"sirModel", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"state", ",", " ", "fireSpreadRate", ",", " ", "deathRate"}], 
        "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"S", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"F", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
           RowBox[{"D", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", "\n", "   ", 
          RowBox[{"(*", 
           RowBox[{"dS", "/", "dt"}], "*)"}], "\n", "     ", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "fireSpreadRate"}], "*", "S", "*", 
            RowBox[{"F", "/", "populationSize"}]}], ",", "\n", "   ", 
           RowBox[{"(*", 
            RowBox[{"dF", "/", "dt"}], "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{"fireSpreadRate", "*", "S", "*", 
             RowBox[{"F", "/", "populationSize"}]}], " ", "-", " ", 
            RowBox[{"deathRate", "*", "F"}]}], ",", "\n", "   ", 
           RowBox[{"(*", 
            RowBox[{"dD", "/", "dt"}], "*)"}], "\n", "      ", 
           RowBox[{"deathRate", "*", "F"}]}], " ", "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"RK4", 
     RowBox[{"(", "5", ")"}], " ", "Integrator"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"rk45Integrator", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "modelFunction", ",", " ", "dt", ",", " ", "currentState", ",", " ", 
         "fireSpreadRate", ",", " ", "\n", "    ", "deathRate"}], "}"}], ",", 
       " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
           "k5", ",", " ", "k6", ",", " ", "nextState"}], "}"}], ",", " ", 
         "\n", "    ", 
         RowBox[{
          RowBox[{"k1", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
            "currentState", ",", " ", "fireSpreadRate", ",", " ", 
             "deathRate"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"k2", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"k1", "/", "4"}]}]}], ",", " ", "fireSpreadRate", ",", 
             " ", "\n", "      ", "deathRate"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"k3", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "k1"}], " ", "+", " ", 
                  RowBox[{"9", " ", "k2"}]}], ")"}], "/", "32"}]}]}], ",", 
             " ", "fireSpreadRate", ",", " ", "\n", "      ", "deathRate"}], 
            "]"}]}], ";", "\n", "    ", 
          RowBox[{"k4", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1932", " ", "k1"}], " ", "-", " ", 
                  RowBox[{"7200", " ", "k2"}], " ", "+", " ", 
                  RowBox[{"7296", " ", "k3"}]}], ")"}], "/", "2197"}]}]}], 
             ",", " ", "\n", "      ", "fireSpreadRate", ",", " ", 
             "deathRate"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"k5", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", "\n", "       ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"439", " ", 
                  RowBox[{"k1", "/", "216"}]}], " ", "-", " ", 
                 RowBox[{"8", " ", "k2"}], " ", "+", " ", 
                 RowBox[{"3680", " ", 
                  RowBox[{"k3", "/", "513"}]}], " ", "-", " ", 
                 RowBox[{"845", " ", 
                  RowBox[{"k4", "/", "4104"}]}]}], ")"}]}]}], ",", " ", "\n", 
             "      ", "fireSpreadRate", ",", " ", "deathRate"}], "]"}]}], 
          ";", "\n", "    ", 
          RowBox[{"k6", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", "\n", "       ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "8"}], " ", 
                  RowBox[{"k1", "/", "27"}]}], " ", "+", " ", 
                 RowBox[{"2", " ", "k2"}], " ", "-", " ", 
                 RowBox[{"3544", " ", 
                  RowBox[{"k3", "/", "2565"}]}], " ", "+", " ", 
                 RowBox[{"1859", " ", 
                  RowBox[{"k4", "/", "4104"}]}], " ", "-", " ", 
                 RowBox[{"11", " ", 
                  RowBox[{"k5", "/", "40"}]}]}], ")"}]}]}], ",", " ", "\n", 
             "      ", "fireSpreadRate", ",", " ", "deathRate"}], "]"}]}], 
          ";", "\n", "    ", 
          RowBox[{"nextState", " ", "=", " ", "\n", "     ", 
           RowBox[{"currentState", " ", "+", " ", "\n", "      ", 
            RowBox[{"dt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"16", " ", 
                RowBox[{"k1", "/", "135"}]}], " ", "+", " ", 
               RowBox[{"6656", " ", 
                RowBox[{"k3", "/", "12825"}]}], " ", "+", " ", 
               RowBox[{"28561", " ", 
                RowBox[{"k4", "/", "56430"}]}], " ", "-", " ", 
               RowBox[{"9", " ", 
                RowBox[{"k5", "/", "50"}]}], " ", "+", " ", "\n", "         ", 
               RowBox[{"2", " ", 
                RowBox[{"k6", "/", "55"}]}]}], ")"}]}]}]}], ";", "\n", "    ",
           "nextState"}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"SIR", " ", "Simulation", " ", "Function"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"simulateSIR", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "deathRate", ",", " ", "stepSize", ",", 
         " ", "maxTime", ",", " ", "\n", "    ", "immuneFrac", ",", " ", 
         "onFireFrac"}], "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "initialState", ",", " ", "steps", ",", " ", "validatedStepSize", 
           ",", " ", "validatedMaxTime", ",", " ", "\n", "     ", "S0", ",", 
           " ", "F0", ",", " ", "I0", ",", " ", "\n", "     ", "results"}], 
          "}"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Validate", " ", "step", " ", "size", " ", "and", " ", "max", " ", 
           "time", " ", "explicitly"}], "*)"}], "\n", "    ", 
         RowBox[{
          RowBox[{"validatedStepSize", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"0.001", ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"stepSize", ",", " ", "maxTime"}], "]"}]}], "]"}]}], 
          ";", "\n", "    ", 
          RowBox[{"validatedMaxTime", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"validatedStepSize", ",", " ", "maxTime"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"(*", 
           RowBox[{"Initial", " ", "conditions"}], "*)"}], "\n", "    ", 
          RowBox[{"S0", " ", "=", " ", 
           RowBox[{"populationSize", "*", 
            RowBox[{"(", 
             RowBox[{
             "1", " ", "-", " ", "immuneFrac", " ", "-", " ", "onFireFrac"}], 
             ")"}]}]}], ";", "\n", "    ", 
          RowBox[{"F0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "onFireFrac"}]}], ";", "\n", "    ", 
          RowBox[{"I0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "immuneFrac"}]}], ";", "\n", "    ", 
          RowBox[{"initialState", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"S0", ",", " ", "F0", ",", " ", "I0"}], "}"}]}], ";", 
          "\n", "    ", 
          RowBox[{"steps", " ", "=", " ", 
           RowBox[{"Range", "[", 
            RowBox[{
            "0", ",", " ", "validatedMaxTime", ",", " ", 
             "validatedStepSize"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"(*", 
           RowBox[{"Compute", " ", "simulation", " ", "results"}], "*)"}], 
          "\n", "    ", 
          RowBox[{"results", " ", "=", " ", "\n", "     ", 
           RowBox[{"NestList", "[", "\n", "      ", 
            RowBox[{
             RowBox[{
              RowBox[{"rk45Integrator", "[", 
               RowBox[{
               "sirModel", ",", " ", "validatedStepSize", ",", " ", "#", ",", 
                " ", "fireSpreadRate", ",", " ", "\n", "        ", 
                "deathRate"}], "]"}], " ", "&"}], ",", " ", "initialState", 
             ",", " ", 
             RowBox[{
              RowBox[{"Length", "[", "steps", "]"}], " ", "-", " ", "1"}]}], 
            "]"}]}], ";", "\n", "    ", 
          RowBox[{"(*", 
           RowBox[{
           "Normalize", " ", "results", " ", "to", " ", "proportions"}], 
           "*)"}], "\n", "    ", 
          RowBox[{
           RowBox[{"Transpose", "[", "results", "]"}], "/", 
           "populationSize"}]}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Visualization", " ", "and", " ", "Controls"}], "*)"}], "\n", 
   RowBox[{"Manipulate", "[", "\n", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", ",", " ", "xRange", ",", " ", "yRange"}], "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"Set", " ", "up", " ", "dynamic", " ", "ranges"}], "*)"}], 
       "\n", "  ", 
       RowBox[{
        RowBox[{"xRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"timeStart", ",", " ", 
           RowBox[{"timeStart", " ", "+", " ", "timeWindow"}]}], "}"}]}], ";",
         "\n", "  ", 
        RowBox[{"yRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"proportionStart", ",", " ", 
           RowBox[{"proportionStart", " ", "+", " ", "proportionWindow"}]}], 
          "}"}]}], ";", "\n", "  ", 
        RowBox[{"(*", 
         RowBox[{"Simulate", " ", "SIR", " ", "model"}], "*)"}], "\n", "  ", 
        RowBox[{"data", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "contactRate", ",", " ", "deathRate", ",", " ", "timeStep", ",", 
           " ", "duration", ",", " ", "\n", "    ", "immuneFraction", ",", 
           " ", "onFireFraction"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"(*", 
         RowBox[{"Plot", " ", "results"}], "*)"}], "\n", "  ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Susceptible", ",", "\n", "   ", 
            RowBox[{"On", " ", "Fire"}], ",", " ", "Burned"}], "*)"}], 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", " ", "yRange"}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", "\n", "      ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Blue", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}]}], "}"}]}], 
          ",", " ", "\n", "   ", 
          RowBox[{"AspectRatio", " ", "->", " ", "Full"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"400", ",", " ", "300"}], "}"}]}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "   ", 
          RowBox[{"FrameLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (days)\>\"", ",", " ", 
             "\"\<Proportion of Population\>\""}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotLegends", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Susceptible\>\"", ",", " ", "\"\<On Fire\>\"", ",", " ", 
             "\n", "     ", "\"\<Burned\>\""}], "}"}]}]}], "]"}]}]}], "]"}], 
     ",", 
     RowBox[{"(*", 
      RowBox[{"Parameter", " ", "Controls"}], "*)"}], "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Fire Parameters\>\"", ",", " ", "\n", "  ", "Bold"}], 
      "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "contactRate", ",", " ", "0.4", ",", " ", 
         "\"\<Fire Spread Rate\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1.0", ",", " ", "\n", "  ", "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "deathRate", ",", " ", "0.05", ",", " ", "\n", "   ", 
         "\"\<Death Rate\>\""}], "}"}], ",", " ", "0.005", ",", " ", "0.2", 
       ",", " ", "0.005", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "Delimiter", ",", " ", "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Initial Conditions\>\"", ",", " ", "\n", "  ", "Bold"}], 
      "]"}], ",", " ", 
     RowBox[{"(*", 
      RowBox[{
      "Added", " ", "to", " ", "make", " ", "it", " ", "easier", " ", "to", 
       " ", "scale", " ", "on", " ", "teh", " ", "graph", " ", "by", " ", 
       "starting", " ", "witha", " ", "smaller", " ", "number"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "immuneFraction", ",", " ", "0.1", ",", " ", 
         "\"\<Initially Immune\>\""}], "}"}], ",", " ", "0", ",", " ", "0.9", 
       ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "onFireFraction", ",", " ", "0.01", ",", " ", "\n", "   ", 
         "\"\<Initially on Fire\>\""}], "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"1", " ", "-", " ", "immuneFraction"}], ",", " ", "0.01", ",", 
       " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "Delimiter", ",", " ", "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Time Settings\>\"", ",", " ", "Bold"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStep", ",", " ", "1.0", ",", " ", "\"\<Time Step (days)\>\""}], 
        "}"}], ",", " ", "\n", "  ", "0.001", ",", " ", "1.0", ",", " ", 
       "0.001", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "duration", ",", " ", "150", ",", " ", "\"\<Total Time (days)\>\""}], 
        "}"}], ",", " ", "10", ",", "\n", "   ", "300", ",", " ", "10", ",", 
       " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeWindow", ",", " ", "150", ",", " ", 
         "\"\<Time Window (days)\>\""}], "}"}], ",", " ", "\n", "  ", "10", 
       ",", " ", "300", ",", " ", "1", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStart", ",", " ", "0", ",", " ", "\"\<Start Time (days)\>\""}], 
        "}"}], ",", " ", "0", ",", " ", "\n", "  ", 
       RowBox[{"duration", " ", "-", " ", "timeWindow"}], ",", " ", "1", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "Delimiter", ",", " ", "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Proportion Settings\>\"", ",", " ", "\n", "  ", "Bold"}], 
      "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionWindow", ",", " ", "1", ",", " ", 
         "\"\<Proportion Window\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1", ",", " ", "0.05", ",", "\n", "   ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionStart", ",", " ", "0.0", ",", " ", "\n", "   ", 
         "\"\<Proportion Start\>\""}], "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"1", " ", "-", " ", "proportionWindow"}], ",", " ", "0.05", 
       ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"ControlPlacement", " ", "->", " ", "Left"}], ",", " ", "\n", 
     " ", 
     RowBox[{"SaveDefinitions", " ", "->", " ", "True"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9408347685833206`*^9, 3.9408347689427013`*^9}, 
   3.9408355603406925`*^9, 3.940835600568966*^9, {3.9408360044057865`*^9, 
   3.9408360700744305`*^9}, 3.9410056620685368`*^9, {3.941007461020796*^9, 
   3.9410074643287163`*^9}, {3.9410077003213463`*^9, 3.941007747434826*^9}, {
   3.9410078032515507`*^9, 3.941007811922779*^9}, {3.9410079087650967`*^9, 
   3.941007909542801*^9}, {3.941008055020458*^9, 3.941008111815092*^9}, {
   3.9410085893643875`*^9, 3.9410086361751366`*^9}, {3.9410088663092594`*^9, 
   3.9410089360110245`*^9}, {3.9410097546417675`*^9, 3.941009755486244*^9}, {
   3.9412664891605854`*^9, 3.941266503373146*^9}, {3.9412666050149803`*^9, 
   3.941266645625292*^9}, {3.941283937978012*^9, 3.941283973771164*^9}, {
   3.9412840860910854`*^9, 3.94128409466407*^9}, {3.941284337691551*^9, 
   3.941284342184561*^9}, {3.941284408563101*^9, 3.941284415120825*^9}, {
   3.9412844567191944`*^9, 3.941284487319008*^9}, {3.9427125824523525`*^9, 
   3.9427126185861473`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ea636ad0-04f2-754e-ab82-1032df9ccbbb"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`contactRate$$ = 
    0.4, $CellContext`deathRate$$ = 0.05, $CellContext`duration$$ = 
    150, $CellContext`immuneFraction$$ = 0.1, $CellContext`onFireFraction$$ = 
    0.01, $CellContext`proportionStart$$ = 
    0., $CellContext`proportionWindow$$ = 1, $CellContext`timeStart$$ = 
    0, $CellContext`timeStep$$ = 1., $CellContext`timeWindow$$ = 150, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["Fire Parameters", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`contactRate$$], 0.4, "Fire Spread Rate"}, 0.05, 1., 
      0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`deathRate$$], 0.05, "Death Rate"}, 0.005, 0.2, 0.005,
       ControlType -> Manipulator}, {
      Hold[
       Style["Initial Conditions", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`immuneFraction$$], 0.1, "Initially Immune"}, 0, 0.9, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`onFireFraction$$], 0.01, "Initially on Fire"}, 0, 
      Dynamic[1 - $CellContext`immuneFraction$$], 0.01, ControlType -> 
      Manipulator}, {
      Hold[
       Style["Time Settings", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`timeStep$$], 1., "Time Step (days)"}, 0.001, 1., 
      0.001, ControlType -> Manipulator}, {{
       Hold[$CellContext`duration$$], 150, "Total Time (days)"}, 10, 300, 10, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`timeWindow$$], 150, "Time Window (days)"}, 10, 300, 
      1, ControlType -> Manipulator}, {{
       Hold[$CellContext`timeStart$$], 0, "Start Time (days)"}, 0, 
      Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
      ControlType -> Manipulator}, {
      Hold[
       Style["Proportion Settings", Bold]], Manipulate`Dump`ThisIsNotAControl,
       ControlType -> None}, {{
       Hold[$CellContext`proportionWindow$$], 1, "Proportion Window"}, 0.05, 
      1, 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`proportionStart$$], 0., "Proportion Start"}, 0, 
      Dynamic[1 - $CellContext`proportionWindow$$], 0.05, ControlType -> 
      Manipulator}}, Typeset`size$$ = {
    452.55515524864194`, {132.61904303182382`, 137.38095696817618`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`contactRate$$ = 
        0.4, $CellContext`deathRate$$ = 0.05, $CellContext`duration$$ = 
        150, $CellContext`immuneFraction$$ = 
        0.1, $CellContext`onFireFraction$$ = 
        0.01, $CellContext`proportionStart$$ = 
        0., $CellContext`proportionWindow$$ = 1, $CellContext`timeStart$$ = 
        0, $CellContext`timeStep$$ = 1., $CellContext`timeWindow$$ = 150}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> 
      Module[{$CellContext`data$, $CellContext`xRange$, \
$CellContext`yRange$}, $CellContext`xRange$ = {$CellContext`timeStart$$, \
$CellContext`timeStart$$ + $CellContext`timeWindow$$}; $CellContext`yRange$ = \
{$CellContext`proportionStart$$, $CellContext`proportionStart$$ + \
$CellContext`proportionWindow$$}; $CellContext`data$ = \
$CellContext`simulateSIR[$CellContext`contactRate$$, \
$CellContext`deathRate$$, $CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]; ListLinePlot[{
           Part[$CellContext`data$, 1], 
           Part[$CellContext`data$, 2], 
           Part[$CellContext`data$, 3]}, 
          PlotRange -> {$CellContext`xRange$, $CellContext`yRange$}, 
          PlotStyle -> {{
             Darker[Green], 
             Thickness[0.007]}, {
             Lighter[Red], 
             Thickness[0.007]}, {
             Lighter[Blue], 
             Thickness[0.007]}}, AspectRatio -> Full, ImageSize -> {400, 300},
           Frame -> True, 
          FrameLabel -> {"Time (days)", "Proportion of Population"}, 
          PlotLegends -> {"Susceptible", "On Fire", "Burned"}]], 
      "Specifications" :> {
        Style[
        "Fire Parameters", 
         Bold], {{$CellContext`contactRate$$, 0.4, "Fire Spread Rate"}, 0.05, 
         1., 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`deathRate$$, 0.05, "Death Rate"}, 0.005, 
         0.2, 0.005, Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Initial Conditions", 
         Bold], {{$CellContext`immuneFraction$$, 0.1, "Initially Immune"}, 0, 
         0.9, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`onFireFraction$$, 0.01, 
          "Initially on Fire"}, 0, 
         Dynamic[1 - $CellContext`immuneFraction$$], 0.01, Appearance -> 
         "Labeled"}, Delimiter, 
        Style[
        "Time Settings", 
         Bold], {{$CellContext`timeStep$$, 1., "Time Step (days)"}, 0.001, 1.,
          0.001, Appearance -> 
         "Labeled"}, {{$CellContext`duration$$, 150, "Total Time (days)"}, 10,
          300, 10, Appearance -> 
         "Labeled"}, {{$CellContext`timeWindow$$, 150, "Time Window (days)"}, 
         10, 300, 1, Appearance -> 
         "Labeled"}, {{$CellContext`timeStart$$, 0, "Start Time (days)"}, 0, 
         Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
         Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Proportion Settings", 
         Bold], {{$CellContext`proportionWindow$$, 1, "Proportion Window"}, 
         0.05, 1, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`proportionStart$$, 0., 
          "Proportion Start"}, 0, 
         Dynamic[1 - $CellContext`proportionWindow$$], 0.05, Appearance -> 
         "Labeled"}}, "Options" :> {ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{
      784.3429940471649, {158.50189459432383`, 163.2638085306762}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`simulateSIR = 
       Function[{$CellContext`fireSpreadRate, $CellContext`deathRate, \
$CellContext`stepSize, $CellContext`maxTime, $CellContext`immuneFrac, \
$CellContext`onFireFrac}, 
         Module[{$CellContext`initialState, $CellContext`steps, \
$CellContext`validatedStepSize, $CellContext`validatedMaxTime, \
$CellContext`S0, $CellContext`F0, $CellContext`I0, $CellContext`results}, \
$CellContext`validatedStepSize = Max[0.001, 
             
             Min[$CellContext`stepSize, $CellContext`maxTime]]; \
$CellContext`validatedMaxTime = 
           Max[$CellContext`validatedStepSize, $CellContext`maxTime]; \
$CellContext`S0 = $CellContext`populationSize (
             1 - $CellContext`immuneFrac - $CellContext`onFireFrac); \
$CellContext`F0 = $CellContext`populationSize $CellContext`onFireFrac; \
$CellContext`I0 = $CellContext`populationSize $CellContext`immuneFrac; \
$CellContext`initialState = {$CellContext`S0, $CellContext`F0, \
$CellContext`I0}; $CellContext`steps = 
           Range[0, $CellContext`validatedMaxTime, \
$CellContext`validatedStepSize]; $CellContext`results = 
           NestList[$CellContext`rk45Integrator[$CellContext`sirModel, \
$CellContext`validatedStepSize, #, $CellContext`fireSpreadRate, \
$CellContext`deathRate]& , $CellContext`initialState, 
             Length[$CellContext`steps] - 1]; 
          Transpose[$CellContext`results]/$CellContext`populationSize]], \
$CellContext`populationSize = 1000, $CellContext`rk45Integrator = 
       Function[{$CellContext`modelFunction, $CellContext`dt, \
$CellContext`currentState, $CellContext`fireSpreadRate, \
$CellContext`deathRate}, 
         Module[{$CellContext`k1, $CellContext`k2, $CellContext`k3, \
$CellContext`k4, $CellContext`k5, $CellContext`k6, $CellContext`nextState}, \
$CellContext`k1 = $CellContext`modelFunction[$CellContext`currentState, \
$CellContext`fireSpreadRate, $CellContext`deathRate]; $CellContext`k2 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt \
($CellContext`k1/
               4), $CellContext`fireSpreadRate, $CellContext`deathRate]; \
$CellContext`k3 = $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt ((3 $CellContext`k1 + 9 $CellContext`k2)/
               32), $CellContext`fireSpreadRate, $CellContext`deathRate]; \
$CellContext`k4 = $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt ((1932 $CellContext`k1 - 7200 $CellContext`k2 + 
                7296 $CellContext`k3)/
               2197), $CellContext`fireSpreadRate, $CellContext`deathRate]; \
$CellContext`k5 = $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt (439 ($CellContext`k1/216) - 8 $CellContext`k2 + 
               3680 ($CellContext`k3/513) - 
               845 ($CellContext`k4/
                4104)), $CellContext`fireSpreadRate, $CellContext`deathRate]; \
$CellContext`k6 = $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt ((-8) ($CellContext`k1/27) + 2 $CellContext`k2 - 
               3544 ($CellContext`k3/2565) + 1859 ($CellContext`k4/4104) - 
               11 ($CellContext`k5/
                40)), $CellContext`fireSpreadRate, $CellContext`deathRate]; \
$CellContext`nextState = $CellContext`currentState + $CellContext`dt (
              16 ($CellContext`k1/135) + 6656 ($CellContext`k3/12825) + 
              28561 ($CellContext`k4/56430) - 9 ($CellContext`k5/50) + 
              2 ($CellContext`k6/
                55)); $CellContext`nextState]], $CellContext`sirModel = 
       Function[{$CellContext`state, $CellContext`fireSpreadRate, \
$CellContext`deathRate}, 
         Module[{$CellContext`S = Part[$CellContext`state, 1], $CellContext`F = 
           Part[$CellContext`state, 2], D = 
           Part[$CellContext`state, 
             3]}, {(-$CellContext`fireSpreadRate) $CellContext`S \
($CellContext`F/$CellContext`populationSize), $CellContext`fireSpreadRate \
$CellContext`S ($CellContext`F/$CellContext`populationSize) - \
$CellContext`deathRate $CellContext`F, $CellContext`deathRate \
$CellContext`F}]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.941005668743431*^9, {3.9410079404797916`*^9, 3.941007948708544*^9}, {
   3.9410081192183304`*^9, 3.9410081393273163`*^9}, 3.941008646614073*^9, {
   3.941009740478222*^9, 3.941009762349123*^9}, 3.9412666684274063`*^9, 
   3.941283926289074*^9, 3.941283980935709*^9, 3.941284231469496*^9, 
   3.941284347344927*^9, 3.941284416946993*^9, 3.9412844901815414`*^9, 
   3.942554435911545*^9, 3.942600084191889*^9, 3.94270637188451*^9, 
   3.942744456372286*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"02f16c01-ccc7-994b-8678-b0e0811fa8ee"]
}, Open  ]],

Cell["\<\
Increasing the fire spread rate reduces the time it takes for the fire to \
consume the whole area.\
\>", "Text",
 CellChangeTimes->{{3.9408347685833206`*^9, 3.9408347689427013`*^9}, 
   3.9408355603406925`*^9, 3.940835600568966*^9, {3.9408360044057865`*^9, 
   3.940836125478552*^9}, {3.941005664918358*^9, 3.9410056662353535`*^9}, {
   3.9412845763028393`*^9, 3.94128459350317*^9}, {3.941284634930525*^9, 
   3.941284634930525*^9}, {3.941285224701565*^9, 
   3.9412852737484646`*^9}},ExpressionUUID->"2ee45434-cfba-d14a-a4a8-\
550b224a82d2"],

Cell["\<\
Increasing the death rate increases the speed in which the forest burns up to \
a point. If it is too high then the forest will effectively burn itself out \
before it burns the whole forest. As the number which convert to \
\[OpenCurlyDoubleQuote]Burned\[CloseCurlyDoubleQuote] is a percent of those \
\[OpenCurlyDoubleQuote]On Fire\[CloseCurlyDoubleQuote] and there are no other \
factors which remove from \[OpenCurlyDoubleQuote]On Fire\
\[CloseCurlyDoubleQuote] the fire will never go out, just tend to 0, meaning \
in the simulation the whole area will eventually burn.\
\>", "Text",
 CellChangeTimes->{{3.9408347685833206`*^9, 3.9408347689427013`*^9}, 
   3.9408355603406925`*^9, 3.940835600568966*^9, {3.9408360044057865`*^9, 
   3.940836125478552*^9}, {3.941005664918358*^9, 3.9410056662353535`*^9}, {
   3.9412845763028393`*^9, 3.94128459350317*^9}, {3.9412846359654408`*^9, 
   3.9412846743207016`*^9}, {3.941284783668997*^9, 3.9412848106646004`*^9}, {
   3.941284850032503*^9, 3.9412848664897404`*^9}, {3.9412849122166576`*^9, 
   3.9412849282445374`*^9}, {3.941284989461912*^9, 3.9412851083710327`*^9}, {
   3.94128515057205*^9, 
   3.94128521241704*^9}},ExpressionUUID->"9b259509-3a40-a048-a438-\
80ff2c0c7e77"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.940834744151245*^9, 
  3.9408347441667995`*^9}},ExpressionUUID->"9de6ff98-9836-5347-83bf-\
7cb79fe0cae6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. SIR second Iteration", "Subtitle",
 CellChangeTimes->{{3.942707764768982*^9, 3.942707779637411*^9}, {
  3.942715984681978*^9, 
  3.942715989706352*^9}},ExpressionUUID->"ae7dbb48-688a-ab42-974a-\
3e6f9af9da45"],

Cell[CellGroupData[{

Cell["\<\
2.1 Adding growth, regrowth and natural extinction to the fire simulation.\
\>", "Section",
 CellChangeTimes->{{3.9410099375405865`*^9, 3.9410099375416164`*^9}, {
  3.942715767773651*^9, 3.9427158083901596`*^9}, {3.942716005622572*^9, 
  3.942716007215782*^9}},ExpressionUUID->"54333da6-be24-ed40-89c4-\
b4ca05e51e70"],

Cell["", "Text",ExpressionUUID->"68e12762-c2a7-6f4d-9fc6-62f376de2341"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dS",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "=", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       StyleBox["firespread",
        FontSlant->"Italic"], "*", "S", "*", "F"}], 
      StyleBox[
       RowBox[{"population", " ", "size"}],
       FontSlant->"Italic"]]}]}], TraditionalForm]],ExpressionUUID->
  "bd3c9ccb-a23e-ff4f-bf4a-64c672c1c6db"],
 "+ ",
 StyleBox["regrowthRate*D",
  FontSlant->"Italic"]
}], "EquationNumbered",
 CellChangeTimes->{{3.9427054995004025`*^9, 3.942705698187731*^9}, {
  3.9427058152897606`*^9, 3.942705815610615*^9}, {3.9427077092999268`*^9, 
  3.9427077333172836`*^9}},ExpressionUUID->"68e42aeb-15d2-f44f-9dba-\
e08b0a4e8a7e"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dF",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "="}], TraditionalForm]],ExpressionUUID->
  "9f9f5cc1-a3eb-da49-9da4-75ff913f0bd2"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      StyleBox["firespread",
       FontSlant->"Italic"], "*", "S", "*", "F"}], 
     StyleBox[
      RowBox[{"population", " ", "size"}],
      FontSlant->"Italic"]], "-", 
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}]}], TraditionalForm]],ExpressionUUID->
  "dc6e9bff-0b59-4640-a99f-a83bcc093e3c"],
 " ",
 StyleBox["- naturalExtinction",
  FontSlant->"Italic"]
}], "EquationNumbered",
 CellChangeTimes->{{3.9427054995004025`*^9, 3.942705818774626*^9}, {
  3.9427157447421227`*^9, 
  3.942715754311426*^9}},ExpressionUUID->"84979b7c-7777-9f41-ae82-\
25e8d09fb98f"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dD",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "="}], TraditionalForm]],ExpressionUUID->
  "2f0ad4c7-0005-af4c-8031-a779e046cfbd"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}], " ", "-", 
    StyleBox[
     RowBox[{"regrowthRate", "*", "D"}],
     FontSlant->"Italic"]}], TraditionalForm]],ExpressionUUID->
  "ae52cd2a-ba37-0b48-8c79-86705bf1dd5d"]
}], "EquationNumbered",
 CellChangeTimes->{{3.9427054995004025`*^9, 3.9427058406947136`*^9}, {
  3.9427077442986393`*^9, 
  3.9427077468953247`*^9}},ExpressionUUID->"e4d2aac6-aa1b-354c-9614-\
df52cf34420c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "population", " ", "size"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"populationSize", " ", "=", " ", "1000"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "SIR", " ", "Model", " ", "Derivatives", " ", "with", " ", "Natural", " ",
      "Extinction"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"sirModel", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "state", ",", " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", 
         " ", "deathRate", ",", " ", "growthRate", ",", " ", "\n", "    ", 
         "naturalExtinction"}], "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"S", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"F", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
           RowBox[{"D", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", "\n", "   ", 
          RowBox[{"(*", " ", 
           RowBox[{"dS", "/", "dt"}], " ", "*)"}], "\n", "     ", 
          RowBox[{
           RowBox[{
            RowBox[{"growthRate", "*", "S"}], " ", "-", " ", 
            RowBox[{"fireSpreadRate", "*", "S", "*", 
             RowBox[{"F", "/", "populationSize"}]}], " ", "+", " ", 
            RowBox[{"regrowthRate", "*", "D"}]}], ",", "\n", "   ", 
           RowBox[{"(*", " ", 
            RowBox[{"dF", "/", "dt"}], " ", "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{"fireSpreadRate", "*", "S", "*", 
             RowBox[{"F", "/", "populationSize"}]}], " ", "-", " ", 
            RowBox[{"deathRate", "*", "F"}], " ", "-", " ", 
            "naturalExtinction"}], ",", "\n", "   ", 
           RowBox[{"(*", " ", 
            RowBox[{"dD", "/", "dt"}], " ", "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{"deathRate", "*", "F"}], " ", "-", " ", 
            RowBox[{"regrowthRate", "*", "D"}]}]}], "\n", "     ", "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"RK4", 
     RowBox[{"(", "5", ")"}], " ", "Integrator"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"rk45Integrator", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "modelFunction", ",", " ", "dt", ",", " ", "currentState", ",", " ", 
         "fireSpreadRate", ",", " ", "\n", "    ", "regrowthRate", ",", " ", 
         "deathRate", ",", " ", "growthRate", ",", " ", "naturalExtinction"}],
         "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
           "k5", ",", " ", "k6", ",", " ", "nextState"}], "}"}], ",", " ", 
         "\n", "    ", 
         RowBox[{
          RowBox[{"k1", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
            "currentState", ",", " ", "fireSpreadRate", ",", " ", 
             "regrowthRate", ",", " ", "\n", "       ", "deathRate", ",", " ",
              "growthRate", ",", " ", "naturalExtinction"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"k2", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"k1", "/", "4"}]}]}], ",", " ", "fireSpreadRate", ",", 
             " ", "\n", "      ", "regrowthRate", ",", " ", "deathRate", ",", 
             " ", "growthRate", ",", " ", "naturalExtinction"}], "]"}]}], ";",
           "\n", "    ", 
          RowBox[{"k3", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "k1"}], " ", "+", " ", 
                  RowBox[{"9", " ", "k2"}]}], ")"}], "/", "32"}]}]}], ",", 
             " ", "\n", "      ", "fireSpreadRate", ",", " ", "regrowthRate", 
             ",", " ", "deathRate", ",", " ", "growthRate", ",", " ", "\n", 
             "      ", "naturalExtinction"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"k4", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1932", " ", "k1"}], " ", "-", " ", 
                  RowBox[{"7200", " ", "k2"}], " ", "+", " ", 
                  RowBox[{"7296", " ", "k3"}]}], ")"}], "/", "2197"}]}]}], 
             ",", " ", "\n", "      ", "fireSpreadRate", ",", " ", 
             "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate", 
             ",", " ", "\n", "      ", "naturalExtinction"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"k5", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", "\n", "       ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"439", " ", 
                  RowBox[{"k1", "/", "216"}]}], " ", "-", " ", 
                 RowBox[{"8", " ", "k2"}], " ", "+", " ", 
                 RowBox[{"3680", " ", 
                  RowBox[{"k3", "/", "513"}]}], " ", "-", " ", 
                 RowBox[{"845", " ", 
                  RowBox[{"k4", "/", "4104"}]}]}], ")"}]}]}], ",", " ", "\n", 
             "      ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "\n", "      ", 
             "naturalExtinction"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"k6", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", "\n", "       ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "8"}], " ", 
                  RowBox[{"k1", "/", "27"}]}], " ", "+", " ", 
                 RowBox[{"2", " ", "k2"}], " ", "-", " ", 
                 RowBox[{"3544", " ", 
                  RowBox[{"k3", "/", "2565"}]}], " ", "+", " ", 
                 RowBox[{"1859", " ", 
                  RowBox[{"k4", "/", "4104"}]}], " ", "-", " ", 
                 RowBox[{"11", " ", 
                  RowBox[{"k5", "/", "40"}]}]}], ")"}]}]}], ",", " ", "\n", 
             "      ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "\n", "      ", 
             "naturalExtinction"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"nextState", " ", "=", " ", "\n", "     ", 
           RowBox[{"currentState", " ", "+", " ", "\n", "      ", 
            RowBox[{"dt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"16", " ", 
                RowBox[{"k1", "/", "135"}]}], " ", "+", " ", 
               RowBox[{"6656", " ", 
                RowBox[{"k3", "/", "12825"}]}], " ", "+", " ", 
               RowBox[{"28561", " ", 
                RowBox[{"k4", "/", "56430"}]}], " ", "-", " ", 
               RowBox[{"9", " ", 
                RowBox[{"k5", "/", "50"}]}], " ", "+", " ", "\n", "         ", 
               RowBox[{"2", " ", 
                RowBox[{"k6", "/", "55"}]}]}], ")"}]}]}]}], ";", "\n", "    ",
           "nextState"}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "SIR", " ", "Simulation", " ", "Function", " ", "with", " ", "Natural", 
     " ", "Extinction"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"simulateSIR", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
         ",", " ", "growthRate", ",", " ", "\n", "    ", "naturalExtinction", 
         ",", " ", "stepSize", ",", " ", "maxTime", ",", " ", "immuneFrac", 
         ",", " ", "onFireFrac"}], "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "initialState", ",", " ", "steps", ",", " ", "validatedStepSize", 
           ",", " ", "validatedMaxTime", ",", " ", "\n", "     ", "S0", ",", 
           " ", "F0", ",", " ", "D0", ",", " ", "results"}], "}"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Validate", " ", "step", " ", "size", " ", "and", " ", "max", " ", 
           "time", " ", "\n", "      ", "explicitly"}], " ", "*)"}], "\n", 
         "    ", 
         RowBox[{
          RowBox[{"validatedStepSize", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"0.001", ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"stepSize", ",", " ", "maxTime"}], "]"}]}], "]"}]}], 
          ";", "\n", "    ", 
          RowBox[{"validatedMaxTime", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"validatedStepSize", ",", " ", "maxTime"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"(*", " ", 
           RowBox[{"Initial", " ", "conditions"}], " ", "*)"}], "\n", "    ", 
          RowBox[{"S0", " ", "=", " ", 
           RowBox[{"populationSize", "*", 
            RowBox[{"(", 
             RowBox[{
             "1", " ", "-", " ", "immuneFrac", " ", "-", " ", "onFireFrac"}], 
             ")"}]}]}], ";", "\n", "    ", 
          RowBox[{"F0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "onFireFrac"}]}], ";", "\n", "    ", 
          RowBox[{"D0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "immuneFrac"}]}], ";", "\n", "    ", 
          RowBox[{"initialState", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"S0", ",", " ", "F0", ",", " ", "D0"}], "}"}]}], ";", 
          "\n", "    ", 
          RowBox[{"steps", " ", "=", " ", 
           RowBox[{"Range", "[", 
            RowBox[{
            "0", ",", " ", "validatedMaxTime", ",", " ", 
             "validatedStepSize"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"(*", " ", 
           RowBox[{"Compute", " ", "simulation", " ", "results"}], " ", 
           "*)"}], "\n", "    ", 
          RowBox[{"results", " ", "=", " ", "\n", "     ", 
           RowBox[{"NestList", "[", "\n", "      ", 
            RowBox[{
             RowBox[{
              RowBox[{"rk45Integrator", "[", 
               RowBox[{
               "sirModel", ",", " ", "validatedStepSize", ",", " ", "#", ",", 
                " ", "fireSpreadRate", ",", " ", "\n", "        ", 
                "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate",
                 ",", " ", "naturalExtinction"}], "]"}], " ", "&"}], ",", " ",
              "\n", "      ", "initialState", ",", " ", 
             RowBox[{
              RowBox[{"Length", "[", "steps", "]"}], " ", "-", " ", "1"}]}], 
            "]"}]}], ";", "\n", "    ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Normalize", " ", "results", " ", "to", " ", "proportions"}], " ", 
           "*)"}], "\n", "    ", 
          RowBox[{
           RowBox[{"Transpose", "[", "results", "]"}], "/", 
           "populationSize"}]}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Visualization", " ", "and", " ", "Controls", " ", "with", " ", "Natural",
      " ", "Extinction"}], " ", "*)"}], "\n", 
   RowBox[{"Manipulate", "[", "\n", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", ",", " ", "xRange", ",", " ", "yRange"}], "}"}], ",", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Set", " ", "up", " ", "dynamic", " ", "ranges"}], " ", 
        "*)"}], "\n", "  ", 
       RowBox[{
        RowBox[{"xRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"timeStart", ",", " ", 
           RowBox[{"timeStart", " ", "+", " ", "timeWindow"}]}], "}"}]}], ";",
         "\n", "  ", 
        RowBox[{"yRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"proportionStart", ",", " ", 
           RowBox[{"proportionStart", " ", "+", " ", "proportionWindow"}]}], 
          "}"}]}], ";", "\n", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{"Simulate", " ", "SIR", " ", "model"}], " ", "*)"}], "\n", 
        "  ", 
        RowBox[{"data", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
           ",", " ", "\n", "    ", "growthRate", ",", " ", 
           "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
           ",", " ", "\n", "    ", "immuneFraction", ",", " ", 
           "onFireFraction"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{"Plot", " ", "results"}], " ", "*)"}], "\n", "  ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"Susceptible", ",", " ", "\n", "    ", 
            RowBox[{"On", " ", "Fire"}], ",", " ", "Recovered"}], " ", "*)"}],
           "\n", "   ", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", " ", "yRange"}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", "\n", "      ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Blue", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}]}], "}"}]}], 
          ",", " ", "\n", "   ", 
          RowBox[{"AspectRatio", " ", "->", " ", "Full"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"400", ",", " ", "300"}], "}"}]}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "   ", 
          RowBox[{"FrameLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (days)\>\"", ",", " ", 
             "\"\<Proportion of Population\>\""}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotLegends", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Susceptible\>\"", ",", " ", "\"\<On Fire\>\"", ",", " ", 
             "\"\<Burned\>\""}], "}"}]}]}], "]"}]}]}], "]"}], ",", " ", "\n", 
     " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Fire Parameters\>\"", ",", " ", "Bold"}], "]"}], ",", " ", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "0.4", ",", " ", 
         "\"\<Fire Spread Rate\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1.0", ",", " ", "0.05", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "growthRate", ",", " ", "0.01", ",", " ", "\"\<Growth Rate\>\""}], 
        "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ", 
       "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "regrowthRate", ",", " ", "0.01", ",", " ", "\"\<Regrowth Rate\>\""}],
         "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.01", ",", " ", 
       "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "deathRate", ",", " ", "0.1", ",", " ", "\"\<Death Rate\>\""}], "}"}],
        ",", " ", "0.05", ",", " ", "0.3", ",", " ", "0.05", ",", " ", "\n", 
       "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "naturalExtinction", ",", " ", "1.5", ",", " ", 
         "\"\<Natural Extinction Rate\>\""}], "}"}], ",", " ", "0.0", ",", 
       " ", "1.6", ",", " ", "\n", "  ", "0.1", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", "Delimiter", ",", " ", "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Initial Conditions\>\"", ",", " ", "Bold"}], "]"}], ",", 
     " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "immuneFraction", ",", " ", "0.1", ",", " ", 
         "\"\<Initially Immune\>\""}], "}"}], ",", " ", "0", ",", " ", "0.9", 
       ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "onFireFraction", ",", " ", "0.01", ",", " ", 
         "\"\<Initially on Fire\>\""}], "}"}], ",", " ", "0", ",", " ", "\n", 
       "  ", 
       RowBox[{"1", " ", "-", " ", "immuneFraction"}], ",", " ", "0.01", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", "Delimiter", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Time Settings\>\"", ",", " ", "Bold"}], "]"}], ",", " ", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStep", ",", " ", "1.0", ",", " ", "\"\<Time Step (days)\>\""}], 
        "}"}], ",", " ", "0.001", ",", " ", "1.0", ",", " ", "0.001", ",", 
       " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "duration", ",", " ", "150", ",", " ", "\"\<Total Time (days)\>\""}], 
        "}"}], ",", " ", "10", ",", " ", "300", ",", " ", "10", ",", " ", 
       "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeWindow", ",", " ", "150", ",", " ", 
         "\"\<Time Window (days)\>\""}], "}"}], ",", " ", "10", ",", " ", 
       "300", ",", " ", "1", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStart", ",", " ", "0", ",", " ", "\"\<Start Time (days)\>\""}], 
        "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"duration", " ", "-", " ", "timeWindow"}], ",", " ", "1", ",", 
       " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", "Delimiter", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Proportion Settings\>\"", ",", " ", "Bold"}], "]"}], ",", 
     " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionWindow", ",", " ", "1", ",", " ", 
         "\"\<Proportion Window\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1", ",", " ", "0.05", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionStart", ",", " ", "0.0", ",", " ", 
         "\"\<Proportion Start\>\""}], "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"1", " ", "-", " ", "proportionWindow"}], ",", " ", "\n", "  ",
        "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"ControlPlacement", " ", "->", " ", "Left"}], ",", " ", "\n", 
     " ", 
     RowBox[{"SaveDefinitions", " ", "->", " ", "True"}]}], "]"}], 
   "\n"}]}]], "Code",
 CellChangeTimes->{
  3.940847341408312*^9, {3.940847795111536*^9, 3.940847798663988*^9}, {
   3.940847901405201*^9, 3.940847907729658*^9}, {3.940848243779993*^9, 
   3.940848302320215*^9}, {3.9408483489295063`*^9, 3.9408483511914234`*^9}, {
   3.9408484688094063`*^9, 3.9408485147722836`*^9}, {3.9408485574864807`*^9, 
   3.9408485581351833`*^9}, {3.9408486455446606`*^9, 
   3.9408486703923836`*^9}, {3.940848702665909*^9, 3.940848725307581*^9}, {
   3.9408487966503925`*^9, 3.940848830227211*^9}, {3.9408488681301575`*^9, 
   3.940848909501644*^9}, {3.941003603935236*^9, 3.941003659594572*^9}, {
   3.9410039111156616`*^9, 3.9410040315871334`*^9}, {3.9410040783421707`*^9, 
   3.941004082280401*^9}, {3.9410041125340405`*^9, 3.941004117237337*^9}, {
   3.9410041692913685`*^9, 3.9410042245930634`*^9}, {3.941004305174902*^9, 
   3.941004308201586*^9}, {3.9410044215013313`*^9, 3.9410044519555435`*^9}, {
   3.9410044981954327`*^9, 3.941004510736309*^9}, {3.9410045697360153`*^9, 
   3.9410045702410145`*^9}, {3.941004622737404*^9, 3.941004633384266*^9}, {
   3.941004665315817*^9, 3.941004707303137*^9}, {3.941004908434511*^9, 
   3.941004998576103*^9}, {3.9410051476337395`*^9, 3.9410051582244663`*^9}, {
   3.9410074112931976`*^9, 3.9410075410735626`*^9}, {3.941009098183857*^9, 
   3.94100909980266*^9}, {3.941009704835823*^9, 3.9410097080722485`*^9}, {
   3.941266756053732*^9, 3.9412667833143177`*^9}, {3.9412829478035755`*^9, 
   3.9412829855300713`*^9}, {3.941283059644518*^9, 3.941283094920761*^9}, {
   3.9412831358098736`*^9, 3.9412831540288296`*^9}, {3.941283360832079*^9, 
   3.941283496190443*^9}, {3.94128358925984*^9, 3.9412837227599106`*^9}, {
   3.9412837766681843`*^9, 3.941283850486288*^9}, {3.9412854038141937`*^9, 
   3.941285437393547*^9}, {3.941285578922653*^9, 3.9412855797059097`*^9}, {
   3.941285912319414*^9, 3.941285940231207*^9}, {3.94128626844664*^9, 
   3.9412864224718914`*^9}, {3.9412866073254623`*^9, 3.941286620673729*^9}, {
   3.9412866980782337`*^9, 3.94128671060709*^9}, {3.941286760252161*^9, 
   3.94128698721632*^9}, {3.941287058006609*^9, 3.9412870601219044`*^9}, 
   3.9425546237724285`*^9, {3.9427116712805367`*^9, 3.9427116890948887`*^9}, {
   3.9427117833545876`*^9, 3.942711791122732*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7a686e6c-7c70-0b43-917a-000412e26724"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ =
     150, $CellContext`fireSpreadRate$$ = 0.4, $CellContext`growthRate$$ = 
    0.01, $CellContext`immuneFraction$$ = 
    0.1, $CellContext`naturalExtinction$$ = 
    1.5, $CellContext`onFireFraction$$ = 
    0.01, $CellContext`proportionStart$$ = 
    0., $CellContext`proportionWindow$$ = 1, $CellContext`regrowthRate$$ = 
    0.01, $CellContext`timeStart$$ = 0, $CellContext`timeStep$$ = 
    1., $CellContext`timeWindow$$ = 150, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["Fire Parameters", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`fireSpreadRate$$], 0.4, "Fire Spread Rate"}, 0.05, 
      1., 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`growthRate$$], 0.01, "Growth Rate"}, 0., 0.05, 0.005,
       ControlType -> Manipulator}, {{
       Hold[$CellContext`regrowthRate$$], 0.01, "Regrowth Rate"}, 0., 0.05, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`deathRate$$], 0.1, "Death Rate"}, 0.05, 0.3, 0.05, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`naturalExtinction$$], 1.5, 
       "Natural Extinction Rate"}, 0., 1.6, 0.1, ControlType -> Manipulator}, {
      Hold[
       Style["Initial Conditions", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`immuneFraction$$], 0.1, "Initially Immune"}, 0, 0.9, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`onFireFraction$$], 0.01, "Initially on Fire"}, 0, 
      Dynamic[1 - $CellContext`immuneFraction$$], 0.01, ControlType -> 
      Manipulator}, {
      Hold[
       Style["Time Settings", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`timeStep$$], 1., "Time Step (days)"}, 0.001, 1., 
      0.001, ControlType -> Manipulator}, {{
       Hold[$CellContext`duration$$], 150, "Total Time (days)"}, 10, 300, 10, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`timeWindow$$], 150, "Time Window (days)"}, 10, 300, 
      1, ControlType -> Manipulator}, {{
       Hold[$CellContext`timeStart$$], 0, "Start Time (days)"}, 0, 
      Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
      ControlType -> Manipulator}, {
      Hold[
       Style["Proportion Settings", Bold]], Manipulate`Dump`ThisIsNotAControl,
       ControlType -> None}, {{
       Hold[$CellContext`proportionWindow$$], 1, "Proportion Window"}, 0.05, 
      1, 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`proportionStart$$], 0., "Proportion Start"}, 0, 
      Dynamic[1 - $CellContext`proportionWindow$$], 0.05, ControlType -> 
      Manipulator}}, Typeset`size$$ = {
    452.55515524864194`, {132.61904303182382`, 137.38095696817618`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ = 
        150, $CellContext`fireSpreadRate$$ = 0.4, $CellContext`growthRate$$ = 
        0.01, $CellContext`immuneFraction$$ = 
        0.1, $CellContext`naturalExtinction$$ = 
        1.5, $CellContext`onFireFraction$$ = 
        0.01, $CellContext`proportionStart$$ = 
        0., $CellContext`proportionWindow$$ = 1, $CellContext`regrowthRate$$ = 
        0.01, $CellContext`timeStart$$ = 0, $CellContext`timeStep$$ = 
        1., $CellContext`timeWindow$$ = 150}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> 
      Module[{$CellContext`data$, $CellContext`xRange$, \
$CellContext`yRange$}, $CellContext`xRange$ = {$CellContext`timeStart$$, \
$CellContext`timeStart$$ + $CellContext`timeWindow$$}; $CellContext`yRange$ = \
{$CellContext`proportionStart$$, $CellContext`proportionStart$$ + \
$CellContext`proportionWindow$$}; $CellContext`data$ = \
$CellContext`simulateSIR[$CellContext`fireSpreadRate$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]; ListLinePlot[{
           Part[$CellContext`data$, 1], 
           Part[$CellContext`data$, 2], 
           Part[$CellContext`data$, 3]}, 
          PlotRange -> {$CellContext`xRange$, $CellContext`yRange$}, 
          PlotStyle -> {{
             Darker[Green], 
             Thickness[0.007]}, {
             Lighter[Red], 
             Thickness[0.007]}, {
             Lighter[Blue], 
             Thickness[0.007]}}, AspectRatio -> Full, ImageSize -> {400, 300},
           Frame -> True, 
          FrameLabel -> {"Time (days)", "Proportion of Population"}, 
          PlotLegends -> {"Susceptible", "On Fire", "Burned"}]], 
      "Specifications" :> {
        Style[
        "Fire Parameters", 
         Bold], {{$CellContext`fireSpreadRate$$, 0.4, "Fire Spread Rate"}, 
         0.05, 1., 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`growthRate$$, 0.01, "Growth Rate"}, 0., 
         0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`regrowthRate$$, 0.01, "Regrowth Rate"}, 
         0., 0.05, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`deathRate$$, 0.1, "Death Rate"}, 0.05, 
         0.3, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`naturalExtinction$$, 1.5, 
          "Natural Extinction Rate"}, 0., 1.6, 0.1, Appearance -> "Labeled"}, 
        Delimiter, 
        Style[
        "Initial Conditions", 
         Bold], {{$CellContext`immuneFraction$$, 0.1, "Initially Immune"}, 0, 
         0.9, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`onFireFraction$$, 0.01, 
          "Initially on Fire"}, 0, 
         Dynamic[1 - $CellContext`immuneFraction$$], 0.01, Appearance -> 
         "Labeled"}, Delimiter, 
        Style[
        "Time Settings", 
         Bold], {{$CellContext`timeStep$$, 1., "Time Step (days)"}, 0.001, 1.,
          0.001, Appearance -> 
         "Labeled"}, {{$CellContext`duration$$, 150, "Total Time (days)"}, 10,
          300, 10, Appearance -> 
         "Labeled"}, {{$CellContext`timeWindow$$, 150, "Time Window (days)"}, 
         10, 300, 1, Appearance -> 
         "Labeled"}, {{$CellContext`timeStart$$, 0, "Start Time (days)"}, 0, 
         Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
         Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Proportion Settings", 
         Bold], {{$CellContext`proportionWindow$$, 1, "Proportion Window"}, 
         0.05, 1, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`proportionStart$$, 0., 
          "Proportion Start"}, 0, 
         Dynamic[1 - $CellContext`proportionWindow$$], 0.05, Appearance -> 
         "Labeled"}}, "Options" :> {ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{
      792.6732673773765, {173.29283265255853`, 178.0547465889109}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`simulateSIR = 
       Function[{$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction, $CellContext`stepSize, $CellContext`maxTime, \
$CellContext`immuneFrac, $CellContext`onFireFrac}, 
         Module[{$CellContext`initialState, $CellContext`steps, \
$CellContext`validatedStepSize, $CellContext`validatedMaxTime, \
$CellContext`S0, $CellContext`F0, $CellContext`D0, $CellContext`results}, \
$CellContext`validatedStepSize = Max[0.001, 
             
             Min[$CellContext`stepSize, $CellContext`maxTime]]; \
$CellContext`validatedMaxTime = 
           Max[$CellContext`validatedStepSize, $CellContext`maxTime]; \
$CellContext`S0 = $CellContext`populationSize (
             1 - $CellContext`immuneFrac - $CellContext`onFireFrac); \
$CellContext`F0 = $CellContext`populationSize $CellContext`onFireFrac; \
$CellContext`D0 = $CellContext`populationSize $CellContext`immuneFrac; \
$CellContext`initialState = {$CellContext`S0, $CellContext`F0, \
$CellContext`D0}; $CellContext`steps = 
           Range[0, $CellContext`validatedMaxTime, \
$CellContext`validatedStepSize]; $CellContext`results = 
           NestList[$CellContext`rk45Integrator[$CellContext`sirModel, \
$CellContext`validatedStepSize, #, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]& , $CellContext`initialState, 
             Length[$CellContext`steps] - 1]; 
          Transpose[$CellContext`results]/$CellContext`populationSize]], \
$CellContext`populationSize = 1000, $CellContext`rk45Integrator = 
       Function[{$CellContext`modelFunction, $CellContext`dt, \
$CellContext`currentState, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction}, 
         Module[{$CellContext`k1, $CellContext`k2, $CellContext`k3, \
$CellContext`k4, $CellContext`k5, $CellContext`k6, $CellContext`nextState}, \
$CellContext`k1 = $CellContext`modelFunction[$CellContext`currentState, \
$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k2 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt \
($CellContext`k1/
               4), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k3 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                3 $CellContext`k1 + 9 $CellContext`k2)/
               32), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k4 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                1932 $CellContext`k1 - 7200 $CellContext`k2 + 
                7296 $CellContext`k3)/
               2197), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k5 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt (
               439 ($CellContext`k1/216) - 8 $CellContext`k2 + 
               3680 ($CellContext`k3/513) - 
               845 ($CellContext`k4/
                4104)), $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k6 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((-8) \
($CellContext`k1/27) + 2 $CellContext`k2 - 3544 ($CellContext`k3/2565) + 
               1859 ($CellContext`k4/4104) - 
               11 ($CellContext`k5/
                40)), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`nextState = \
$CellContext`currentState + $CellContext`dt (16 ($CellContext`k1/135) + 
              6656 ($CellContext`k3/12825) + 28561 ($CellContext`k4/56430) - 
              9 ($CellContext`k5/50) + 
              2 ($CellContext`k6/
                55)); $CellContext`nextState]], $CellContext`sirModel = 
       Function[{$CellContext`state, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction}, 
         Module[{$CellContext`S = Part[$CellContext`state, 1], $CellContext`F = 
           Part[$CellContext`state, 2], D = 
           Part[$CellContext`state, 
             3]}, {$CellContext`growthRate $CellContext`S - \
$CellContext`fireSpreadRate $CellContext`S \
($CellContext`F/$CellContext`populationSize) + $CellContext`regrowthRate 
            D, $CellContext`fireSpreadRate $CellContext`S \
($CellContext`F/$CellContext`populationSize) - $CellContext`deathRate \
$CellContext`F - $CellContext`naturalExtinction, $CellContext`deathRate \
$CellContext`F - $CellContext`regrowthRate D}]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.94084734472118*^9, {3.9408478049285965`*^9, 3.940847818410866*^9}, 
   3.9408479117496166`*^9, 3.94084830465547*^9, 3.9408483544297466`*^9, 
   3.940848494841305*^9, 3.9408485600741234`*^9, {3.9408487074353447`*^9, 
   3.940848729822233*^9}, {3.940848803292391*^9, 3.9408488332579556`*^9}, {
   3.940848899524828*^9, 3.9408489360560036`*^9}, 3.941003314597275*^9, 
   3.941003370183243*^9, 3.9410035254665203`*^9, 3.9410035845495033`*^9, {
   3.941004127418556*^9, 3.941004145953535*^9}, 3.941004232691469*^9, {
   3.941004718557913*^9, 3.9410047373970547`*^9}, 3.9410050102584915`*^9, 
   3.941005128210203*^9, 3.9410051614616127`*^9, {3.9410079580122185`*^9, 
   3.941007960644745*^9}, {3.9410079991306057`*^9, 3.9410080255363216`*^9}, 
   3.941008645979971*^9, 3.941008681177601*^9, 3.94128528457522*^9, 
   3.9412854405258465`*^9, 3.941285669113043*^9, 3.9412864298878365`*^9, 
   3.941286622630823*^9, 3.941286714486332*^9, 3.941286959446459*^9, 
   3.941286989662548*^9, {3.94255443524057*^9, 3.942554464922003*^9}, 
   3.942554626112892*^9, 3.9427105899566345`*^9, {3.942711676031128*^9, 
   3.942711691272932*^9}, 3.942711797059641*^9, 3.942716108691374*^9, 
   3.9427447277772675`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"ba4c0222-5803-5443-bc05-c9e354ca65a2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "2.",
 
 CounterBox["Section"],
 " Rapid fire spread"
}], "Section",
 CellChangeTimes->{{3.9412680000325966`*^9, 3.941268005623913*^9}, {
  3.9425565199031143`*^9, 3.9425565268839207`*^9}, {3.942715863718685*^9, 
  3.942715890928713*^9}, {3.9427160161936817`*^9, 
  3.942716017220356*^9}},ExpressionUUID->"0dbbeaeb-a675-e044-b36e-\
755dbf0b77f2"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dS",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "=", 
    RowBox[{
     RowBox[{
      StyleBox["growthRate",
       FontSlant->"Italic"], 
      StyleBox["*",
       FontSlant->"Italic"], "S"}], "-", 
     FractionBox[
      RowBox[{
       StyleBox["firespread",
        FontSlant->"Italic"], "*", "S", "*", 
       SuperscriptBox["F", "2"]}], 
      StyleBox[
       RowBox[{"population", " ", "size"}],
       FontSlant->"Italic"]]}]}], TraditionalForm]],ExpressionUUID->
  "40e8c789-d96b-2746-83d8-8624adaf2781"],
 "+ ",
 StyleBox["regrowthRate*D",
  FontSlant->"Italic"]
}], "EquationNumbered",
 CellChangeTimes->{{3.942711197092924*^9, 3.9427112036044674`*^9}, {
  3.9427112726101017`*^9, 3.942711281606632*^9}, {3.942715831449566*^9, 
  3.9427158459487514`*^9}},ExpressionUUID->"3792d7d4-f4be-7840-a4e2-\
1c57bcb083da"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dF",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "="}], TraditionalForm]],ExpressionUUID->
  "05dccd9b-a60d-b74c-a2ab-5310c60b8d86"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      StyleBox["firespread",
       FontSlant->"Italic"], "*", "S", "*", 
      SuperscriptBox["F", "2"]}], 
     StyleBox[
      RowBox[{"population", " ", "size"}],
      FontSlant->"Italic"]], "-", 
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}], "-", 
    StyleBox["naturalExtinction",
     FontSlant->"Italic"]}], TraditionalForm]],ExpressionUUID->
  "88ec0230-62a7-8f4e-9b12-82aaa9ef5e1b"]
}], "EquationNumbered",
 CellChangeTimes->{{3.942711197092924*^9, 3.942711248180626*^9}, {
  3.9427158551476574`*^9, 
  3.942715855462532*^9}},ExpressionUUID->"89d365ce-5858-9947-a7bc-\
7b0237ad375c"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dD",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "="}], TraditionalForm]],ExpressionUUID->
  "283a4e8e-abb6-6946-b63c-5ae6e9b88953"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}], " ", "-", 
    StyleBox[
     RowBox[{"regrowthRate", "*", "D"}],
     FontSlant->"Italic"]}], TraditionalForm]],ExpressionUUID->
  "8345f1e0-168e-cc47-9c8f-fd4f147f909b"]
}], "EquationNumbered",
 CellChangeTimes->{{3.942711197092924*^9, 
  3.942711220202753*^9}},ExpressionUUID->"2e18719f-ccc6-8841-9840-\
1f556bc2cc10"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "population", " ", "size"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"populationSize", " ", "=", " ", "1000"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "SIR", " ", "Model", " ", "Derivatives", " ", "with", " ", "Natural", " ",
      "Extinction"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"sirModel", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "state", ",", " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", 
         " ", "deathRate", ",", " ", "growthRate", ",", " ", "\n", "    ", 
         "naturalExtinction"}], "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"S", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"F", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
           RowBox[{"D", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", "\n", "   ", 
          RowBox[{"(*", " ", 
           RowBox[{"dS", "/", "dt"}], " ", "*)"}], "\n", "     ", 
          RowBox[{
           RowBox[{
            RowBox[{"growthRate", "*", "S"}], " ", "-", " ", 
            RowBox[{"fireSpreadRate", "*", "S", "*", 
             RowBox[{
              SuperscriptBox["F", "2"], "/", "populationSize"}]}], " ", "+", 
            " ", 
            RowBox[{"regrowthRate", "*", "D"}]}], ",", "\n", "   ", 
           RowBox[{"(*", " ", 
            RowBox[{"dF", "/", "dt"}], " ", "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{"fireSpreadRate", "*", "S", "*", 
             RowBox[{
              SuperscriptBox["F", "2"], "/", "populationSize"}]}], " ", "-", 
            " ", 
            RowBox[{"deathRate", "*", "F"}], " ", "-", " ", 
            "naturalExtinction"}], ",", "\n", "   ", 
           RowBox[{"(*", " ", 
            RowBox[{"dD", "/", "dt"}], " ", "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{"deathRate", "*", "F"}], " ", "-", " ", 
            RowBox[{"regrowthRate", "*", "D"}]}]}], "\n", "     ", "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"RK4", 
     RowBox[{"(", "5", ")"}], " ", "Integrator"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"rk45Integrator", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "modelFunction", ",", " ", "dt", ",", " ", "currentState", ",", " ", 
         "fireSpreadRate", ",", " ", "\n", "    ", "regrowthRate", ",", " ", 
         "deathRate", ",", " ", "growthRate", ",", " ", "naturalExtinction"}],
         "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
           "k5", ",", " ", "k6", ",", " ", "nextState"}], "}"}], ",", " ", 
         "\n", "    ", 
         RowBox[{
          RowBox[{"k1", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
            "currentState", ",", " ", "fireSpreadRate", ",", " ", 
             "regrowthRate", ",", " ", "\n", "       ", "deathRate", ",", " ",
              "growthRate", ",", " ", "naturalExtinction"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"k2", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"k1", "/", "4"}]}]}], ",", " ", "fireSpreadRate", ",", 
             " ", "\n", "      ", "regrowthRate", ",", " ", "deathRate", ",", 
             " ", "growthRate", ",", " ", "naturalExtinction"}], "]"}]}], ";",
           "\n", "    ", 
          RowBox[{"k3", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "k1"}], " ", "+", " ", 
                  RowBox[{"9", " ", "k2"}]}], ")"}], "/", "32"}]}]}], ",", 
             " ", "\n", "      ", "fireSpreadRate", ",", " ", "regrowthRate", 
             ",", " ", "deathRate", ",", " ", "growthRate", ",", " ", "\n", 
             "      ", "naturalExtinction"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"k4", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1932", " ", "k1"}], " ", "-", " ", 
                  RowBox[{"7200", " ", "k2"}], " ", "+", " ", 
                  RowBox[{"7296", " ", "k3"}]}], ")"}], "/", "2197"}]}]}], 
             ",", " ", "\n", "      ", "fireSpreadRate", ",", " ", 
             "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate", 
             ",", " ", "\n", "      ", "naturalExtinction"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"k5", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", "\n", "       ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"439", " ", 
                  RowBox[{"k1", "/", "216"}]}], " ", "-", " ", 
                 RowBox[{"8", " ", "k2"}], " ", "+", " ", 
                 RowBox[{"3680", " ", 
                  RowBox[{"k3", "/", "513"}]}], " ", "-", " ", 
                 RowBox[{"845", " ", 
                  RowBox[{"k4", "/", "4104"}]}]}], ")"}]}]}], ",", " ", "\n", 
             "      ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "\n", "      ", 
             "naturalExtinction"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"k6", " ", "=", " ", "\n", "     ", 
           RowBox[{"modelFunction", "[", "\n", "      ", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", "\n", "       ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "8"}], " ", 
                  RowBox[{"k1", "/", "27"}]}], " ", "+", " ", 
                 RowBox[{"2", " ", "k2"}], " ", "-", " ", 
                 RowBox[{"3544", " ", 
                  RowBox[{"k3", "/", "2565"}]}], " ", "+", " ", 
                 RowBox[{"1859", " ", 
                  RowBox[{"k4", "/", "4104"}]}], " ", "-", " ", 
                 RowBox[{"11", " ", 
                  RowBox[{"k5", "/", "40"}]}]}], ")"}]}]}], ",", " ", "\n", 
             "      ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "\n", "      ", 
             "naturalExtinction"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"nextState", " ", "=", " ", "\n", "     ", 
           RowBox[{"currentState", " ", "+", " ", "\n", "      ", 
            RowBox[{"dt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"16", " ", 
                RowBox[{"k1", "/", "135"}]}], " ", "+", " ", 
               RowBox[{"6656", " ", 
                RowBox[{"k3", "/", "12825"}]}], " ", "+", " ", 
               RowBox[{"28561", " ", 
                RowBox[{"k4", "/", "56430"}]}], " ", "-", " ", 
               RowBox[{"9", " ", 
                RowBox[{"k5", "/", "50"}]}], " ", "+", " ", "\n", "         ", 
               RowBox[{"2", " ", 
                RowBox[{"k6", "/", "55"}]}]}], ")"}]}]}]}], ";", "\n", "    ",
           "nextState"}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "SIR", " ", "Simulation", " ", "Function", " ", "with", " ", "Natural", 
     " ", "Extinction"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"simulateSIR", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
         ",", " ", "growthRate", ",", " ", "\n", "    ", "naturalExtinction", 
         ",", " ", "stepSize", ",", " ", "maxTime", ",", " ", "immuneFrac", 
         ",", " ", "onFireFrac"}], "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "initialState", ",", " ", "steps", ",", " ", "validatedStepSize", 
           ",", " ", "validatedMaxTime", ",", " ", "\n", "     ", "S0", ",", 
           " ", "F0", ",", " ", "D0", ",", " ", "results"}], "}"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Validate", " ", "step", " ", "size", " ", "and", " ", "max", " ", 
           "time", " ", "\n", "      ", "explicitly"}], " ", "*)"}], "\n", 
         "    ", 
         RowBox[{
          RowBox[{"validatedStepSize", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"0.001", ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"stepSize", ",", " ", "maxTime"}], "]"}]}], "]"}]}], 
          ";", "\n", "    ", 
          RowBox[{"validatedMaxTime", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"validatedStepSize", ",", " ", "maxTime"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"(*", " ", 
           RowBox[{"Initial", " ", "conditions"}], " ", "*)"}], "\n", "    ", 
          RowBox[{"S0", " ", "=", " ", 
           RowBox[{"populationSize", "*", 
            RowBox[{"(", 
             RowBox[{
             "1", " ", "-", " ", "immuneFrac", " ", "-", " ", "onFireFrac"}], 
             ")"}]}]}], ";", "\n", "    ", 
          RowBox[{"F0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "onFireFrac"}]}], ";", "\n", "    ", 
          RowBox[{"D0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "immuneFrac"}]}], ";", "\n", "    ", 
          RowBox[{"initialState", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"S0", ",", " ", "F0", ",", " ", "D0"}], "}"}]}], ";", 
          "\n", "    ", 
          RowBox[{"steps", " ", "=", " ", 
           RowBox[{"Range", "[", 
            RowBox[{
            "0", ",", " ", "validatedMaxTime", ",", " ", 
             "validatedStepSize"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"(*", " ", 
           RowBox[{"Compute", " ", "simulation", " ", "results"}], " ", 
           "*)"}], "\n", "    ", 
          RowBox[{"results", " ", "=", " ", "\n", "     ", 
           RowBox[{"NestList", "[", "\n", "      ", 
            RowBox[{
             RowBox[{
              RowBox[{"rk45Integrator", "[", 
               RowBox[{
               "sirModel", ",", " ", "validatedStepSize", ",", " ", "#", ",", 
                " ", "fireSpreadRate", ",", " ", "\n", "        ", 
                "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate",
                 ",", " ", "naturalExtinction"}], "]"}], " ", "&"}], ",", " ",
              "\n", "      ", "initialState", ",", " ", 
             RowBox[{
              RowBox[{"Length", "[", "steps", "]"}], " ", "-", " ", "1"}]}], 
            "]"}]}], ";", "\n", "    ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Normalize", " ", "results", " ", "to", " ", "proportions"}], " ", 
           "*)"}], "\n", "    ", 
          RowBox[{
           RowBox[{"Transpose", "[", "results", "]"}], "/", 
           "populationSize"}]}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Visualization", " ", "and", " ", "Controls", " ", "with", " ", "Natural",
      " ", "Extinction"}], " ", "*)"}], "\n", 
   RowBox[{"Manipulate", "[", "\n", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", ",", " ", "xRange", ",", " ", "yRange"}], "}"}], ",", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Set", " ", "up", " ", "dynamic", " ", "ranges"}], " ", 
        "*)"}], "\n", "  ", 
       RowBox[{
        RowBox[{"xRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"timeStart", ",", " ", 
           RowBox[{"timeStart", " ", "+", " ", "timeWindow"}]}], "}"}]}], ";",
         "\n", "  ", 
        RowBox[{"yRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"proportionStart", ",", " ", 
           RowBox[{"proportionStart", " ", "+", " ", "proportionWindow"}]}], 
          "}"}]}], ";", "\n", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{"Simulate", " ", "SIR", " ", "model"}], " ", "*)"}], "\n", 
        "  ", 
        RowBox[{"data", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
           ",", " ", "\n", "    ", "growthRate", ",", " ", 
           "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
           ",", " ", "\n", "    ", "immuneFraction", ",", " ", 
           "onFireFraction"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{"Plot", " ", "results"}], " ", "*)"}], "\n", "  ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"Susceptible", ",", " ", "\n", "    ", 
            RowBox[{"On", " ", "Fire"}], ",", " ", "Recovered"}], " ", "*)"}],
           "\n", "   ", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", " ", "yRange"}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", "\n", "      ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Blue", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}]}], "}"}]}], 
          ",", " ", "\n", "   ", 
          RowBox[{"AspectRatio", " ", "->", " ", "Full"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"400", ",", " ", "300"}], "}"}]}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "   ", 
          RowBox[{"FrameLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (days)\>\"", ",", " ", 
             "\"\<Proportion of Population\>\""}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotLegends", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Susceptible\>\"", ",", " ", "\"\<On Fire\>\"", ",", " ", 
             "\"\<Burned\>\""}], "}"}]}]}], "]"}]}]}], "]"}], ",", " ", "\n", 
     " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Fire Parameters\>\"", ",", " ", "Bold"}], "]"}], ",", " ", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "0.01", ",", " ", 
         "\"\<Fire Spread Rate\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1.0", ",", " ", "0.05", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "growthRate", ",", " ", "0.01", ",", " ", "\"\<Growth Rate\>\""}], 
        "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ", 
       "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "regrowthRate", ",", " ", "0.01", ",", " ", "\"\<Regrowth Rate\>\""}],
         "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.01", ",", " ", 
       "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "deathRate", ",", " ", "0.1", ",", " ", "\"\<Death Rate\>\""}], "}"}],
        ",", " ", "0.05", ",", " ", "0.3", ",", " ", "0.05", ",", " ", "\n", 
       "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "naturalExtinction", ",", " ", "1.5", ",", " ", 
         "\"\<Natural Extinction Rate\>\""}], "}"}], ",", " ", "0.0", ",", 
       " ", "1.6", ",", " ", "\n", "  ", "0.1", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", "Delimiter", ",", " ", "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Initial Conditions\>\"", ",", " ", "Bold"}], "]"}], ",", 
     " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "immuneFraction", ",", " ", "0.1", ",", " ", 
         "\"\<Initially Immune\>\""}], "}"}], ",", " ", "0", ",", " ", "0.9", 
       ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "onFireFraction", ",", " ", "0.01", ",", " ", 
         "\"\<Initially on Fire\>\""}], "}"}], ",", " ", "0", ",", " ", "\n", 
       "  ", 
       RowBox[{"1", " ", "-", " ", "immuneFraction"}], ",", " ", "0.01", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", "Delimiter", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Time Settings\>\"", ",", " ", "Bold"}], "]"}], ",", " ", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStep", ",", " ", "1.0", ",", " ", "\"\<Time Step (days)\>\""}], 
        "}"}], ",", " ", "0.001", ",", " ", "1.0", ",", " ", "0.001", ",", 
       " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "duration", ",", " ", "150", ",", " ", "\"\<Total Time (days)\>\""}], 
        "}"}], ",", " ", "10", ",", " ", "300", ",", " ", "10", ",", " ", 
       "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeWindow", ",", " ", "150", ",", " ", 
         "\"\<Time Window (days)\>\""}], "}"}], ",", " ", "10", ",", " ", 
       "300", ",", " ", "1", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStart", ",", " ", "0", ",", " ", "\"\<Start Time (days)\>\""}], 
        "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"duration", " ", "-", " ", "timeWindow"}], ",", " ", "1", ",", 
       " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", "Delimiter", ",", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Proportion Settings\>\"", ",", " ", "Bold"}], "]"}], ",", 
     " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionWindow", ",", " ", "1", ",", " ", 
         "\"\<Proportion Window\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1", ",", " ", "0.05", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionStart", ",", " ", "0.0", ",", " ", 
         "\"\<Proportion Start\>\""}], "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"1", " ", "-", " ", "proportionWindow"}], ",", " ", "\n", "  ",
        "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"ControlPlacement", " ", "->", " ", "Left"}], ",", " ", "\n", 
     " ", 
     RowBox[{"SaveDefinitions", " ", "->", " ", "True"}]}], "]"}], 
   "\n"}]}]], "Code",
 CellChangeTimes->{{3.9427107840714245`*^9, 3.9427107916294804`*^9}, 
   3.942710863254162*^9, {3.9427109862954636`*^9, 3.9427110241526165`*^9}, {
   3.942711088763151*^9, 3.9427110896089535`*^9}, {3.9427113221791725`*^9, 
   3.94271133134033*^9}, {3.942711375898159*^9, 3.9427113763539333`*^9}, {
   3.9427122189426727`*^9, 3.942712222901119*^9}, {3.942712308798916*^9, 
   3.9427123096886864`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"b32f7c62-1bf0-e84b-8b7e-e343fa6d2d8f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ =
     150, $CellContext`fireSpreadRate$$ = 0.05, $CellContext`growthRate$$ = 
    0.01, $CellContext`immuneFraction$$ = 
    0.1, $CellContext`naturalExtinction$$ = 
    1.5, $CellContext`onFireFraction$$ = 
    0.01, $CellContext`proportionStart$$ = 
    0., $CellContext`proportionWindow$$ = 1, $CellContext`regrowthRate$$ = 
    0.01, $CellContext`timeStart$$ = 0, $CellContext`timeStep$$ = 
    1., $CellContext`timeWindow$$ = 150, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["Fire Parameters", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`fireSpreadRate$$], 0.01, "Fire Spread Rate"}, 0.05, 
      1., 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`growthRate$$], 0.01, "Growth Rate"}, 0., 0.05, 0.005,
       ControlType -> Manipulator}, {{
       Hold[$CellContext`regrowthRate$$], 0.01, "Regrowth Rate"}, 0., 0.05, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`deathRate$$], 0.1, "Death Rate"}, 0.05, 0.3, 0.05, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`naturalExtinction$$], 1.5, 
       "Natural Extinction Rate"}, 0., 1.6, 0.1, ControlType -> Manipulator}, {
      Hold[
       Style["Initial Conditions", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`immuneFraction$$], 0.1, "Initially Immune"}, 0, 0.9, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`onFireFraction$$], 0.01, "Initially on Fire"}, 0, 
      Dynamic[1 - $CellContext`immuneFraction$$], 0.01, ControlType -> 
      Manipulator}, {
      Hold[
       Style["Time Settings", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`timeStep$$], 1., "Time Step (days)"}, 0.001, 1., 
      0.001, ControlType -> Manipulator}, {{
       Hold[$CellContext`duration$$], 150, "Total Time (days)"}, 10, 300, 10, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`timeWindow$$], 150, "Time Window (days)"}, 10, 300, 
      1, ControlType -> Manipulator}, {{
       Hold[$CellContext`timeStart$$], 0, "Start Time (days)"}, 0, 
      Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
      ControlType -> Manipulator}, {
      Hold[
       Style["Proportion Settings", Bold]], Manipulate`Dump`ThisIsNotAControl,
       ControlType -> None}, {{
       Hold[$CellContext`proportionWindow$$], 1, "Proportion Window"}, 0.05, 
      1, 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`proportionStart$$], 0., "Proportion Start"}, 0, 
      Dynamic[1 - $CellContext`proportionWindow$$], 0.05, ControlType -> 
      Manipulator}}, Typeset`size$$ = {
    452.55515524864194`, {132.61904303182382`, 137.38095696817618`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ = 
        150, $CellContext`fireSpreadRate$$ = 0.01, $CellContext`growthRate$$ = 
        0.01, $CellContext`immuneFraction$$ = 
        0.1, $CellContext`naturalExtinction$$ = 
        1.5, $CellContext`onFireFraction$$ = 
        0.01, $CellContext`proportionStart$$ = 
        0., $CellContext`proportionWindow$$ = 1, $CellContext`regrowthRate$$ = 
        0.01, $CellContext`timeStart$$ = 0, $CellContext`timeStep$$ = 
        1., $CellContext`timeWindow$$ = 150}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> 
      Module[{$CellContext`data$, $CellContext`xRange$, \
$CellContext`yRange$}, $CellContext`xRange$ = {$CellContext`timeStart$$, \
$CellContext`timeStart$$ + $CellContext`timeWindow$$}; $CellContext`yRange$ = \
{$CellContext`proportionStart$$, $CellContext`proportionStart$$ + \
$CellContext`proportionWindow$$}; $CellContext`data$ = \
$CellContext`simulateSIR[$CellContext`fireSpreadRate$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]; ListLinePlot[{
           Part[$CellContext`data$, 1], 
           Part[$CellContext`data$, 2], 
           Part[$CellContext`data$, 3]}, 
          PlotRange -> {$CellContext`xRange$, $CellContext`yRange$}, 
          PlotStyle -> {{
             Darker[Green], 
             Thickness[0.007]}, {
             Lighter[Red], 
             Thickness[0.007]}, {
             Lighter[Blue], 
             Thickness[0.007]}}, AspectRatio -> Full, ImageSize -> {400, 300},
           Frame -> True, 
          FrameLabel -> {"Time (days)", "Proportion of Population"}, 
          PlotLegends -> {"Susceptible", "On Fire", "Burned"}]], 
      "Specifications" :> {
        Style[
        "Fire Parameters", 
         Bold], {{$CellContext`fireSpreadRate$$, 0.01, "Fire Spread Rate"}, 
         0.05, 1., 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`growthRate$$, 0.01, "Growth Rate"}, 0., 
         0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`regrowthRate$$, 0.01, "Regrowth Rate"}, 
         0., 0.05, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`deathRate$$, 0.1, "Death Rate"}, 0.05, 
         0.3, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`naturalExtinction$$, 1.5, 
          "Natural Extinction Rate"}, 0., 1.6, 0.1, Appearance -> "Labeled"}, 
        Delimiter, 
        Style[
        "Initial Conditions", 
         Bold], {{$CellContext`immuneFraction$$, 0.1, "Initially Immune"}, 0, 
         0.9, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`onFireFraction$$, 0.01, 
          "Initially on Fire"}, 0, 
         Dynamic[1 - $CellContext`immuneFraction$$], 0.01, Appearance -> 
         "Labeled"}, Delimiter, 
        Style[
        "Time Settings", 
         Bold], {{$CellContext`timeStep$$, 1., "Time Step (days)"}, 0.001, 1.,
          0.001, Appearance -> 
         "Labeled"}, {{$CellContext`duration$$, 150, "Total Time (days)"}, 10,
          300, 10, Appearance -> 
         "Labeled"}, {{$CellContext`timeWindow$$, 150, "Time Window (days)"}, 
         10, 300, 1, Appearance -> 
         "Labeled"}, {{$CellContext`timeStart$$, 0, "Start Time (days)"}, 0, 
         Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
         Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Proportion Settings", 
         Bold], {{$CellContext`proportionWindow$$, 1, "Proportion Window"}, 
         0.05, 1, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`proportionStart$$, 0., 
          "Proportion Start"}, 0, 
         Dynamic[1 - $CellContext`proportionWindow$$], 0.05, Appearance -> 
         "Labeled"}}, "Options" :> {ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{
      792.6732673773765, {181.90133265255855`, 186.6632465889109}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`simulateSIR = 
       Function[{$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction, $CellContext`stepSize, $CellContext`maxTime, \
$CellContext`immuneFrac, $CellContext`onFireFrac}, 
         Module[{$CellContext`initialState, $CellContext`steps, \
$CellContext`validatedStepSize, $CellContext`validatedMaxTime, \
$CellContext`S0, $CellContext`F0, $CellContext`D0, $CellContext`results}, \
$CellContext`validatedStepSize = Max[0.001, 
             
             Min[$CellContext`stepSize, $CellContext`maxTime]]; \
$CellContext`validatedMaxTime = 
           Max[$CellContext`validatedStepSize, $CellContext`maxTime]; \
$CellContext`S0 = $CellContext`populationSize (
             1 - $CellContext`immuneFrac - $CellContext`onFireFrac); \
$CellContext`F0 = $CellContext`populationSize $CellContext`onFireFrac; \
$CellContext`D0 = $CellContext`populationSize $CellContext`immuneFrac; \
$CellContext`initialState = {$CellContext`S0, $CellContext`F0, \
$CellContext`D0}; $CellContext`steps = 
           Range[0, $CellContext`validatedMaxTime, \
$CellContext`validatedStepSize]; $CellContext`results = 
           NestList[$CellContext`rk45Integrator[$CellContext`sirModel, \
$CellContext`validatedStepSize, #, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]& , $CellContext`initialState, 
             Length[$CellContext`steps] - 1]; 
          Transpose[$CellContext`results]/$CellContext`populationSize]], \
$CellContext`populationSize = 1000, $CellContext`rk45Integrator = 
       Function[{$CellContext`modelFunction, $CellContext`dt, \
$CellContext`currentState, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction}, 
         Module[{$CellContext`k1, $CellContext`k2, $CellContext`k3, \
$CellContext`k4, $CellContext`k5, $CellContext`k6, $CellContext`nextState}, \
$CellContext`k1 = $CellContext`modelFunction[$CellContext`currentState, \
$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k2 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt \
($CellContext`k1/
               4), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k3 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                3 $CellContext`k1 + 9 $CellContext`k2)/
               32), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k4 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                1932 $CellContext`k1 - 7200 $CellContext`k2 + 
                7296 $CellContext`k3)/
               2197), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k5 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt (
               439 ($CellContext`k1/216) - 8 $CellContext`k2 + 
               3680 ($CellContext`k3/513) - 
               845 ($CellContext`k4/
                4104)), $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`k6 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((-8) \
($CellContext`k1/27) + 2 $CellContext`k2 - 3544 ($CellContext`k3/2565) + 
               1859 ($CellContext`k4/4104) - 
               11 ($CellContext`k5/
                40)), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]; $CellContext`nextState = \
$CellContext`currentState + $CellContext`dt (16 ($CellContext`k1/135) + 
              6656 ($CellContext`k3/12825) + 28561 ($CellContext`k4/56430) - 
              9 ($CellContext`k5/50) + 
              2 ($CellContext`k6/
                55)); $CellContext`nextState]], $CellContext`sirModel = 
       Function[{$CellContext`state, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction}, 
         Module[{$CellContext`S = Part[$CellContext`state, 1], $CellContext`F = 
           Part[$CellContext`state, 2], D = 
           Part[$CellContext`state, 
             3]}, {$CellContext`growthRate $CellContext`S - \
$CellContext`fireSpreadRate $CellContext`S \
($CellContext`F^2/$CellContext`populationSize) + $CellContext`regrowthRate 
            D, $CellContext`fireSpreadRate $CellContext`S \
($CellContext`F^2/$CellContext`populationSize) - $CellContext`deathRate \
$CellContext`F - $CellContext`naturalExtinction, $CellContext`deathRate \
$CellContext`F - $CellContext`regrowthRate D}]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.9427108652774067`*^9, 3.9427108790359325`*^9}, 
   3.9427110297616005`*^9, 3.9427110910998783`*^9, 3.9427113374215794`*^9, 
   3.9427113820764313`*^9, {3.9427123219583607`*^9, 3.942712343476719*^9}, {
   3.9427126509477997`*^9, 3.942712655289234*^9}, 3.9427149033359127`*^9, 
   3.94271495816276*^9, 3.9427258371702766`*^9, 3.942726255305271*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"bab8c22a-8feb-594b-a4c3-ecd4a15e31f3"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 99, 745, 
   23997341684384632305, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942726259527687*^9},
 CellLabel->"",ExpressionUUID->"4e81a163-def2-604e-a4f9-4eb49a172bf4"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 99, 746, 
   23997341684384632305, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942726259527687*^9},
 CellLabel->"",ExpressionUUID->"038f795b-89fb-5444-bd35-f3dc23c3f1eb"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 99, 747, 
   23997341684384632305, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942726259527687*^9},
 CellLabel->"",ExpressionUUID->"d65741ef-facb-4b40-afcf-84d5c6370f11"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ovfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 99, 748, 23997341684384632305, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427262595427*^9},
 CellLabel->"",ExpressionUUID->"8420246c-47cb-5a42-8ddf-c88b046f1f57"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 6, 401, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942726684280712*^9},
 CellLabel->"",ExpressionUUID->"cddfe44c-5e66-734c-b02e-122ee5e893d7"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 6, 402, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942726684295828*^9},
 CellLabel->"",ExpressionUUID->"fbb12755-cdd4-8548-ac19-5a93ef500798"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 6, 403, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942726684295828*^9},
 CellLabel->"",ExpressionUUID->"0feff29b-1797-bf49-8f61-748621e28547"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ovfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 6, 404, 23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942726684312443*^9},
 CellLabel->"",ExpressionUUID->"19595ba0-0a7c-ad4d-9a47-df16d454ded7"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 22, 887, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942727094004963*^9},
 CellLabel->"",ExpressionUUID->"12b827a0-4b33-9e48-a56c-defa76e30565"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 22, 888, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942727094004963*^9},
 CellLabel->"",ExpressionUUID->"b03c3276-d2f9-8a4b-a9c5-2220a5be1ea3"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 22, 889, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942727094036749*^9},
 CellLabel->"",ExpressionUUID->"fe7b9c1b-0af5-fd47-afca-75d4f369f657"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ovfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 22, 890, 23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427270940681973`*^9},
 CellLabel->"",ExpressionUUID->"67f1890b-828b-dc45-8d91-d01493aaf329"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 34, 2326, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942728586001734*^9},
 CellLabel->"",ExpressionUUID->"abf81de1-d3ab-5c4e-bf46-bf05f0a8ebba"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 34, 2327, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427285860374928`*^9},
 CellLabel->"",ExpressionUUID->"d0784125-1e83-b547-ac1f-5ec77124ab5f"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 34, 2328, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942728586064909*^9},
 CellLabel->"",ExpressionUUID->"b22305c9-a3a2-cc47-b25d-b8d6c1e546c5"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ovfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 34, 2329, 23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427285860984116`*^9},
 CellLabel->"",ExpressionUUID->"bd3ac80b-8e43-e34e-9bfd-75a9570ed289"],

Cell[BoxData[
 TemplateBox[{
  "Function", "fpct", 
   "\"Too many parameters in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \
\\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}]\\) to be filled from \
\\!\\(\\*RowBox[{RowBox[{\\\"Function\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \
\\\",\\\", \\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Module\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"initialState\\\", \
\\\",\\\", \\\"steps\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \\\
\"validatedMaxTime\\\", \\\",\\\", \\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\
\", \\\"D0\\\", \\\",\\\", \\\"results\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"validatedStepSize\\\", \\\"=\\\", RowBox[{\\\"Max\\\", \\\
\"[\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", RowBox[{\\\"Min\\\", \\\"[\\\", \
RowBox[{\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\"}], \\\"]\\\"}]}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"validatedMaxTime\\\", \\\"=\\\", \
RowBox[{\\\"Max\\\", \\\"[\\\", RowBox[{\\\"validatedStepSize\\\", \\\",\\\", \
\\\"maxTime\\\"}], \\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"S0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\
\", \\\"-\\\", \\\"immuneFrac\\\", \\\"-\\\", \\\"onFireFrac\\\"}], \
\\\")\\\"}]}]}], \\\";\\\", RowBox[{\\\"F0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", \\\"onFireFrac\\\"}]}], \\\";\\\", \
RowBox[{\\\"D0\\\", \\\"=\\\", RowBox[{\\\"populationSize\\\", \\\" \\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"10\\\", \\\"\[RightSkeleton]\\\"}]}]}], \
\\\";\\\", RowBox[{\\\"initialState\\\", \\\"=\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\", \\\"D0\\\"}], \
\\\"}\\\"}]}], \\\";\\\", RowBox[{\\\"steps\\\", \\\"=\\\", RowBox[{\\\"Range\
\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"validatedMaxTime\\\", \
\\\",\\\", \\\"validatedStepSize\\\"}], \\\"]\\\"}]}], \\\";\\\", \
RowBox[{\\\"results\\\", \\\"=\\\", RowBox[{\\\"NestList\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"rk45Integrator\\\", \\\"[\\\", \
RowBox[{\\\"sirModel\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \
RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"fireSpreadRate\\\", \
\\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \\\"deathRate\\\", \\\",\\\", \
\\\"growthRate\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"initialState\\\", \\\",\\\", RowBox[{RowBox[{\\\"Length\\\", \\\"[\\\", \
\\\"steps\\\", \\\"]\\\"}], \\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]}], \
\\\";\\\", FractionBox[TemplateBox[List[\\\"results\\\"], \\\"Transpose\\\", \
Rule[SyntaxForm, SuperscriptBox]], \\\"populationSize\\\"]}]}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]\\).\"", 2, 228, 2528, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427444035107956`*^9},
 CellLabel->"",ExpressionUUID->"2cdcd35d-9a7d-5843-950a-626323661319"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "population", " ", "size"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"populationSize", " ", "=", " ", "1000"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "SIR", " ", "Model", " ", "Derivatives", " ", "with", " ", "Natural", " ",
      "Extinction"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"sirModel", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "state", ",", " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", 
         " ", "deathRate", ",", " ", "\n", "    ", "growthRate", ",", " ", 
         "naturalExtinction"}], "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"S", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"F", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
           RowBox[{"D", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", "\n", "     ", 
          RowBox[{"(*", " ", 
           RowBox[{"dS", "/", "dt"}], " ", "*)"}], "\n", "     ", 
          RowBox[{
           RowBox[{
            RowBox[{"growthRate", "*", "S"}], " ", "-", " ", 
            RowBox[{"fireSpreadRate", "*", "S", "*", 
             RowBox[{
              RowBox[{"F", "^", "2"}], "/", "populationSize"}]}], " ", "+", 
            " ", "\n", "      ", 
            RowBox[{"regrowthRate", "*", "D"}]}], ",", "\n", "     ", 
           RowBox[{"(*", " ", 
            RowBox[{"dF", "/", "dt"}], " ", "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{"fireSpreadRate", "*", "S", "*", 
             RowBox[{
              RowBox[{"F", "^", "2"}], "/", "populationSize"}]}], " ", "-", 
            " ", 
            RowBox[{"deathRate", "*", "F"}], " ", "-", " ", "\n", "      ", 
            "naturalExtinction"}], ",", "\n", "     ", 
           RowBox[{"(*", " ", 
            RowBox[{"dD", "/", "dt"}], " ", "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{"deathRate", "*", "F"}], " ", "-", " ", 
            RowBox[{"regrowthRate", "*", "D"}]}]}], "\n", "     ", "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"RK4", 
     RowBox[{"(", "5", ")"}], " ", "Integrator"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"rk45Integrator", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "modelFunction", ",", " ", "dt", ",", " ", "currentState", ",", " ", 
         "fireSpreadRate", ",", " ", "\n", "    ", "regrowthRate", ",", " ", 
         "deathRate", ",", " ", "growthRate", ",", " ", "naturalExtinction"}],
         "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
           "k5", ",", " ", "k6", ",", " ", "nextState"}], "}"}], ",", " ", 
         "\n", "    ", 
         RowBox[{
          RowBox[{"k1", " ", "=", " ", "\n", "     ", 
           RowBox[{"Quiet", "[", 
            RowBox[{"modelFunction", "[", 
             RowBox[{
             "currentState", ",", " ", "fireSpreadRate", ",", " ", "\n", 
              "       ", "regrowthRate", ",", " ", "deathRate", ",", " ", 
              "growthRate", ",", " ", "naturalExtinction"}], "]"}], "]"}]}], 
          ";", "\n", "    ", 
          RowBox[{"k2", " ", "=", " ", "\n", "     ", 
           RowBox[{"Quiet", "[", 
            RowBox[{"modelFunction", "[", 
             RowBox[{
              RowBox[{"currentState", " ", "+", " ", 
               RowBox[{"dt", " ", 
                RowBox[{"k1", "/", "4"}]}]}], ",", " ", "fireSpreadRate", ",",
               " ", "\n", "       ", "regrowthRate", ",", " ", "deathRate", 
              ",", " ", "growthRate", ",", " ", "naturalExtinction"}], "]"}], 
            "]"}]}], ";", "\n", "    ", 
          RowBox[{"k3", " ", "=", " ", "\n", "     ", 
           RowBox[{"Quiet", "[", 
            RowBox[{"modelFunction", "[", 
             RowBox[{
              RowBox[{"currentState", " ", "+", " ", 
               RowBox[{"dt", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"3", " ", "k1"}], " ", "+", " ", 
                   RowBox[{"9", " ", "k2"}]}], ")"}], "/", "32"}]}]}], ",", 
              " ", "\n", "       ", "fireSpreadRate", ",", " ", 
              "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate", 
              ",", " ", "\n", "       ", "naturalExtinction"}], "]"}], 
            "]"}]}], ";", "\n", "    ", 
          RowBox[{"k4", " ", "=", " ", "\n", "     ", 
           RowBox[{"Quiet", "[", 
            RowBox[{"modelFunction", "[", "\n", "       ", 
             RowBox[{
              RowBox[{"currentState", " ", "+", " ", 
               RowBox[{"dt", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"1932", " ", "k1"}], " ", "-", " ", 
                   RowBox[{"7200", " ", "k2"}], " ", "+", " ", 
                   RowBox[{"7296", " ", "k3"}]}], ")"}], "/", "2197"}]}]}], 
              ",", " ", "\n", "       ", "fireSpreadRate", ",", " ", 
              "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate", 
              ",", " ", "\n", "       ", "naturalExtinction"}], "]"}], 
            "]"}]}], ";", "\n", "    ", 
          RowBox[{"k5", " ", "=", " ", "\n", "     ", 
           RowBox[{"Quiet", "[", 
            RowBox[{"modelFunction", "[", "\n", "       ", 
             RowBox[{
              RowBox[{"currentState", " ", "+", " ", "\n", "        ", 
               RowBox[{"dt", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"439", " ", 
                   RowBox[{"k1", "/", "216"}]}], " ", "-", " ", 
                  RowBox[{"8", " ", "k2"}], " ", "+", " ", 
                  RowBox[{"3680", " ", 
                   RowBox[{"k3", "/", "513"}]}], " ", "-", " ", 
                  RowBox[{"845", " ", 
                   RowBox[{"k4", "/", "4104"}]}]}], ")"}]}]}], ",", " ", "\n",
               "       ", "fireSpreadRate", ",", " ", "regrowthRate", ",", 
              " ", "deathRate", ",", " ", "growthRate", ",", " ", "\n", 
              "       ", "naturalExtinction"}], "]"}], "]"}]}], ";", "\n", 
          "    ", 
          RowBox[{"k6", " ", "=", " ", "\n", "     ", 
           RowBox[{"Quiet", "[", 
            RowBox[{"modelFunction", "[", "\n", "       ", 
             RowBox[{
              RowBox[{"currentState", " ", "+", " ", "\n", "        ", 
               RowBox[{"dt", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "8"}], " ", 
                   RowBox[{"k1", "/", "27"}]}], " ", "+", " ", 
                  RowBox[{"2", " ", "k2"}], " ", "-", " ", 
                  RowBox[{"3544", " ", 
                   RowBox[{"k3", "/", "2565"}]}], " ", "+", " ", 
                  RowBox[{"1859", " ", 
                   RowBox[{"k4", "/", "4104"}]}], " ", "-", " ", "\n", 
                  "           ", 
                  RowBox[{"11", " ", 
                   RowBox[{"k5", "/", "40"}]}]}], ")"}]}]}], ",", " ", 
              "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
              "deathRate", ",", " ", "\n", "       ", "growthRate", ",", " ", 
              "naturalExtinction"}], "]"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"nextState", " ", "=", " ", "\n", "     ", 
           RowBox[{"Quiet", "[", 
            RowBox[{"currentState", " ", "+", " ", "\n", "       ", 
             RowBox[{"dt", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"16", " ", 
                 RowBox[{"k1", "/", "135"}]}], " ", "+", " ", 
                RowBox[{"6656", " ", 
                 RowBox[{"k3", "/", "12825"}]}], " ", "+", " ", 
                RowBox[{"28561", " ", 
                 RowBox[{"k4", "/", "56430"}]}], " ", "-", " ", "\n", 
                "          ", 
                RowBox[{"9", " ", 
                 RowBox[{"k5", "/", "50"}]}], " ", "+", " ", 
                RowBox[{"2", " ", 
                 RowBox[{"k6", "/", "55"}]}]}], ")"}]}]}], "]"}]}], ";", "\n",
           "    ", "nextState"}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "SIR", " ", "Simulation", " ", "Function", " ", "with", " ", "Quiet"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"simulateSIR", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
         ",", " ", "growthRate", ",", " ", "\n", "    ", "naturalExtinction", 
         ",", " ", "stepSize", ",", " ", "maxTime", ",", " ", "immuneFrac", 
         ",", " ", "onFireFrac"}], "}"}], ",", " ", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "initialState", ",", " ", "steps", ",", " ", "validatedStepSize", 
           ",", " ", "validatedMaxTime", ",", " ", "\n", "     ", "S0", ",", 
           " ", "F0", ",", " ", "D0", ",", " ", "results"}], "}"}], ",", " ", 
         "\n", "    ", 
         RowBox[{
          RowBox[{"validatedStepSize", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"0.001", ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"stepSize", ",", " ", "maxTime"}], "]"}]}], "]"}]}], 
          ";", "\n", "    ", 
          RowBox[{"validatedMaxTime", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"validatedStepSize", ",", " ", "maxTime"}], "]"}]}], ";", 
          "\n", "    ", 
          RowBox[{"S0", " ", "=", " ", 
           RowBox[{"populationSize", "*", 
            RowBox[{"(", 
             RowBox[{
             "1", " ", "-", " ", "immuneFrac", " ", "-", " ", "onFireFrac"}], 
             ")"}]}]}], ";", "\n", "    ", 
          RowBox[{"F0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "onFireFrac"}]}], ";", "\n", "    ", 
          RowBox[{"D0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "immuneFrac"}]}], ";", "\n", "    ", 
          RowBox[{"initialState", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"S0", ",", " ", "F0", ",", " ", "D0"}], "}"}]}], ";", 
          "\n", "    ", 
          RowBox[{"steps", " ", "=", " ", 
           RowBox[{"Range", "[", 
            RowBox[{
            "0", ",", " ", "validatedMaxTime", ",", " ", 
             "validatedStepSize"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"results", " ", "=", " ", "\n", "     ", 
           RowBox[{"Quiet", "[", 
            RowBox[{"NestList", "[", "\n", "       ", 
             RowBox[{
              RowBox[{
               RowBox[{"rk45Integrator", "[", 
                RowBox[{
                "sirModel", ",", " ", "validatedStepSize", ",", " ", "#", ",",
                  " ", "fireSpreadRate", ",", " ", "\n", "         ", 
                 "regrowthRate", ",", " ", "deathRate", ",", " ", 
                 "growthRate", ",", " ", "naturalExtinction"}], "]"}], " ", 
               "&"}], ",", " ", "\n", "       ", "initialState", ",", " ", 
              RowBox[{
               RowBox[{"Length", "[", "steps", "]"}], " ", "-", " ", "1"}]}], 
             "]"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{
           RowBox[{"Transpose", "[", "results", "]"}], "/", 
           "populationSize"}]}]}], "]"}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Visualization", " ", "and", " ", "Controls", " ", "for", " ", "Ensemble",
      " ", "Simulation"}], " ", "*)"}], "\n", 
   RowBox[{"Manipulate", "[", "\n", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data1", ",", " ", "data2", ",", " ", "data3", ",", " ", "data4", ",",
          " ", "xRange", ",", " ", "yRange"}], "}"}], ",", " ", "\n", "  ", 
       RowBox[{
        RowBox[{"xRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "duration"}], "}"}]}], ";", "\n", "  ", 
        RowBox[{"yRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "1"}], "}"}]}], ";", "\n", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Simulate", " ", "each", " ", "data", " ", "set", " ", "with", " ", 
          "Quiet", " ", "to", " ", "suppress", " ", "warnings"}], " ", "*)"}],
         "\n", "  ", 
        RowBox[{"data1", " ", "=", " ", 
         RowBox[{"Quiet", "[", 
          RowBox[{"simulateSIR", "[", 
           RowBox[{
           "fireSpreadRate1", ",", " ", "regrowthRate", ",", " ", "deathRate",
             ",", " ", "\n", "     ", "growthRate", ",", " ", 
            "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
            ",", " ", "\n", "     ", "immuneFraction", ",", " ", 
            "onFireFraction"}], "]"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"data2", " ", "=", " ", 
         RowBox[{"Quiet", "[", 
          RowBox[{"simulateSIR", "[", 
           RowBox[{
           "fireSpreadRate2", ",", " ", "regrowthRate", ",", " ", "deathRate",
             ",", " ", "\n", "     ", "growthRate", ",", " ", 
            "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
            ",", " ", "\n", "     ", "immuneFraction", ",", " ", 
            "onFireFraction"}], "]"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"data3", " ", "=", " ", 
         RowBox[{"Quiet", "[", 
          RowBox[{"simulateSIR", "[", 
           RowBox[{
           "fireSpreadRate3", ",", " ", "regrowthRate", ",", " ", "deathRate",
             ",", " ", "\n", "     ", "growthRate", ",", " ", 
            "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
            ",", " ", "\n", "     ", "immuneFraction", ",", " ", 
            "onFireFraction"}], "]"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"data4", " ", "=", " ", 
         RowBox[{"Quiet", "[", 
          RowBox[{"simulateSIR", "[", 
           RowBox[{
           "fireSpreadRate4", ",", " ", "regrowthRate", ",", " ", "deathRate",
             ",", " ", "\n", "     ", "growthRate", ",", " ", 
            "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
            ",", " ", "\n", "     ", "immuneFraction", ",", " ", 
            "onFireFraction"}], "]"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{"Plot", " ", "results"}], " ", "*)"}], "\n", "  ", 
        RowBox[{"ListLinePlot", "[", "\n", "   ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data4", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", "\n", "   ", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", " ", "yRange"}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Red", ",", " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", " ", 
             "\n", "     ", 
             RowBox[{"{", 
              RowBox[{"Green", ",", " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"Purple", ",", " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}]}], "}"}]}], 
          ",", " ", "\n", "   ", 
          RowBox[{"AspectRatio", " ", "->", " ", "Full"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"600", ",", " ", "400"}], "}"}]}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "   ", 
          RowBox[{"FrameLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (days)\>\"", ",", " ", 
             "\"\<Proportion of Population On Fire\>\""}], "}"}]}], ",", " ", 
          "\n", "   ", 
          RowBox[{"PlotLegends", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Spread Rate 1\>\"", ",", " ", "\"\<Spread Rate 2\>\"", ",", 
             " ", "\"\<Spread Rate 3\>\"", ",", " ", "\n", "     ", 
             "\"\<Spread Rate 4\>\""}], "}"}]}]}], "]"}]}]}], "]"}], ",", 
     "\n", "\n", " ", 
     RowBox[{"(*", " ", "Controls", " ", "*)"}], "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate1", ",", " ", "0.01", ",", " ", 
         "\"\<Fire Spread Rate 1\>\""}], "}"}], ",", " ", "0.01", ",", " ", 
       "1", ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate2", ",", " ", "0.02", ",", " ", 
         "\"\<Fire Spread Rate 2\>\""}], "}"}], ",", " ", "0.01", ",", " ", 
       "1", ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate3", ",", " ", "0.03", ",", " ", 
         "\"\<Fire Spread Rate 3\>\""}], "}"}], ",", " ", "0.01", ",", " ", 
       "1", ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate4", ",", " ", "0.04", ",", " ", 
         "\"\<Fire Spread Rate 4\>\""}], "}"}], ",", " ", "0.01", ",", " ", 
       "1", ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "regrowthRate", ",", " ", "0.01", ",", " ", "\"\<Regrowth Rate\>\""}],
         "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ",
        "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "deathRate", ",", " ", "0.1", ",", " ", "\"\<Death Rate\>\""}], "}"}],
        ",", " ", "0.05", ",", " ", "0.3", ",", " ", "0.05", ",", " ", "\n", 
       "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "naturalExtinction", ",", " ", "0.1", ",", " ", 
         "\"\<Natural Extinction\>\""}], "}"}], ",", " ", "0.", ",", " ", 
       "1.0", ",", " ", "0.05", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "growthRate", ",", " ", "0.01", ",", " ", "\"\<Growth Rate\>\""}], 
        "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ", 
       "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "immuneFraction", ",", " ", "0.1", ",", " ", 
         "\"\<Initially Immune\>\""}], "}"}], ",", " ", "0", ",", " ", "0.9", 
       ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "onFireFraction", ",", " ", "0.01", ",", " ", 
         "\"\<Initially On Fire\>\""}], "}"}], ",", " ", "0", ",", " ", "\n", 
       "  ", 
       RowBox[{"1", " ", "-", " ", "immuneFraction"}], ",", " ", "0.01", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStep", ",", " ", "1.0", ",", " ", "\"\<Time Step (days)\>\""}], 
        "}"}], ",", " ", "0.001", ",", " ", "1.0", ",", " ", "0.001", ",", 
       " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "duration", ",", " ", "90", ",", " ", 
         "\"\<Simulation Time (days)\>\""}], "}"}], ",", " ", "10", ",", " ", 
       "300", ",", " ", "10", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"SaveDefinitions", " ", "->", " ", "True"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9427265825241337`*^9, 3.942726612833809*^9}, {
  3.942726746587879*^9, 3.942726871771681*^9}, {3.942727065744442*^9, 
  3.9427270978378773`*^9}, {3.9427285858930016`*^9, 3.9427285868844795`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"5bee933d-6a2a-ec4d-a2c5-69472cb92f4c"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ =
     90, $CellContext`fireSpreadRate1$$ = 
    0.01, $CellContext`fireSpreadRate2$$ = 
    0.02, $CellContext`fireSpreadRate3$$ = 
    0.03, $CellContext`fireSpreadRate4$$ = 0.04, $CellContext`growthRate$$ = 
    0.01, $CellContext`immuneFraction$$ = 
    0.1, $CellContext`naturalExtinction$$ = 
    0.1, $CellContext`onFireFraction$$ = 0.01, $CellContext`regrowthRate$$ = 
    0.01, $CellContext`timeStep$$ = 1., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`fireSpreadRate1$$], 0.01, "Fire Spread Rate 1"}, 
      0.01, 1, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`fireSpreadRate2$$], 0.02, "Fire Spread Rate 2"}, 
      0.01, 1, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`fireSpreadRate3$$], 0.03, "Fire Spread Rate 3"}, 
      0.01, 1, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`fireSpreadRate4$$], 0.04, "Fire Spread Rate 4"}, 
      0.01, 1, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`regrowthRate$$], 0.01, "Regrowth Rate"}, 0., 0.05, 
      0.005, ControlType -> Manipulator}, {{
       Hold[$CellContext`deathRate$$], 0.1, "Death Rate"}, 0.05, 0.3, 0.05, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`naturalExtinction$$], 0.1, "Natural Extinction"}, 0.,
       1., 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`growthRate$$], 0.01, "Growth Rate"}, 0., 0.05, 0.005,
       ControlType -> Manipulator}, {{
       Hold[$CellContext`immuneFraction$$], 0.1, "Initially Immune"}, 0, 0.9, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`onFireFraction$$], 0.01, "Initially On Fire"}, 0, 
      Dynamic[1 - $CellContext`immuneFraction$$], 0.01, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`timeStep$$], 1., "Time Step (days)"}, 0.001, 1., 
      0.001, ControlType -> Manipulator}, {{
       Hold[$CellContext`duration$$], 90, "Simulation Time (days)"}, 10, 300, 
      10, ControlType -> Manipulator}}, Typeset`size$$ = {
    646.366287560463, {177.61904303182382`, 182.38095696817618`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ = 
        90, $CellContext`fireSpreadRate1$$ = 
        0.01, $CellContext`fireSpreadRate2$$ = 
        0.02, $CellContext`fireSpreadRate3$$ = 
        0.03, $CellContext`fireSpreadRate4$$ = 
        0.04, $CellContext`growthRate$$ = 0.01, $CellContext`immuneFraction$$ = 
        0.1, $CellContext`naturalExtinction$$ = 
        0.1, $CellContext`onFireFraction$$ = 
        0.01, $CellContext`regrowthRate$$ = 0.01, $CellContext`timeStep$$ = 
        1.}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> 
      Module[{$CellContext`data1$, $CellContext`data2$, $CellContext`data3$, \
$CellContext`data4$, $CellContext`xRange$, $CellContext`yRange$}, \
$CellContext`xRange$ = {0, $CellContext`duration$$}; $CellContext`yRange$ = {
          0, 1}; $CellContext`data1$ = Quiet[
           $CellContext`simulateSIR[$CellContext`fireSpreadRate1$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]]; \
$CellContext`data2$ = Quiet[
           $CellContext`simulateSIR[$CellContext`fireSpreadRate2$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]]; \
$CellContext`data3$ = Quiet[
           $CellContext`simulateSIR[$CellContext`fireSpreadRate3$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]]; \
$CellContext`data4$ = Quiet[
           $CellContext`simulateSIR[$CellContext`fireSpreadRate4$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]]; ListLinePlot[{
           Part[$CellContext`data1$, 2], 
           Part[$CellContext`data2$, 2], 
           Part[$CellContext`data3$, 2], 
           Part[$CellContext`data4$, 2]}, 
          PlotRange -> {$CellContext`xRange$, $CellContext`yRange$}, 
          PlotStyle -> {{Red, 
             Thickness[0.005]}, {Blue, 
             Thickness[0.005]}, {Green, 
             Thickness[0.005]}, {Purple, 
             Thickness[0.005]}}, AspectRatio -> Full, ImageSize -> {600, 400},
           Frame -> True, 
          FrameLabel -> {"Time (days)", "Proportion of Population On Fire"}, 
          PlotLegends -> {
           "Spread Rate 1", "Spread Rate 2", "Spread Rate 3", 
            "Spread Rate 4"}]], 
      "Specifications" :> {{{$CellContext`fireSpreadRate1$$, 0.01, 
          "Fire Spread Rate 1"}, 0.01, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`fireSpreadRate2$$, 0.02, 
          "Fire Spread Rate 2"}, 0.01, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`fireSpreadRate3$$, 0.03, 
          "Fire Spread Rate 3"}, 0.01, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`fireSpreadRate4$$, 0.04, 
          "Fire Spread Rate 4"}, 0.01, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`regrowthRate$$, 0.01, "Regrowth Rate"}, 
         0., 0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`deathRate$$, 0.1, "Death Rate"}, 0.05, 
         0.3, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`naturalExtinction$$, 0.1, 
          "Natural Extinction"}, 0., 1., 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`growthRate$$, 0.01, "Growth Rate"}, 0., 
         0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`immuneFraction$$, 0.1, 
          "Initially Immune"}, 0, 0.9, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`onFireFraction$$, 0.01, 
          "Initially On Fire"}, 0, 
         Dynamic[1 - $CellContext`immuneFraction$$], 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`timeStep$$, 1., "Time Step (days)"}, 
         0.001, 1., 0.001, Appearance -> 
         "Labeled"}, {{$CellContext`duration$$, 90, "Simulation Time (days)"},
          10, 300, 10, Appearance -> "Labeled"}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{
      985.6775638589859, {203.50189459432383`, 208.2638085306762}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`simulateSIR = 
       Function[{$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction, $CellContext`stepSize, $CellContext`maxTime, \
$CellContext`immuneFrac, $CellContext`onFireFrac}, 
         Module[{$CellContext`initialState, $CellContext`steps, \
$CellContext`validatedStepSize, $CellContext`validatedMaxTime, \
$CellContext`S0, $CellContext`F0, $CellContext`D0, $CellContext`results}, \
$CellContext`validatedStepSize = Max[0.001, 
             
             Min[$CellContext`stepSize, $CellContext`maxTime]]; \
$CellContext`validatedMaxTime = 
           Max[$CellContext`validatedStepSize, $CellContext`maxTime]; \
$CellContext`S0 = $CellContext`populationSize (
             1 - $CellContext`immuneFrac - $CellContext`onFireFrac); \
$CellContext`F0 = $CellContext`populationSize $CellContext`onFireFrac; \
$CellContext`D0 = $CellContext`populationSize $CellContext`immuneFrac; \
$CellContext`initialState = {$CellContext`S0, $CellContext`F0, \
$CellContext`D0}; $CellContext`steps = 
           Range[0, $CellContext`validatedMaxTime, \
$CellContext`validatedStepSize]; $CellContext`results = Quiet[
             
             NestList[$CellContext`rk45Integrator[$CellContext`sirModel, \
$CellContext`validatedStepSize, #, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]& , $CellContext`initialState, 
              Length[$CellContext`steps] - 1]]; 
          Transpose[$CellContext`results]/$CellContext`populationSize]], \
$CellContext`populationSize = 1000, $CellContext`rk45Integrator = 
       Function[{$CellContext`modelFunction, $CellContext`dt, \
$CellContext`currentState, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction}, 
         Module[{$CellContext`k1, $CellContext`k2, $CellContext`k3, \
$CellContext`k4, $CellContext`k5, $CellContext`k6, $CellContext`nextState}, \
$CellContext`k1 = Quiet[
             $CellContext`modelFunction[$CellContext`currentState, \
$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]]; $CellContext`k2 = Quiet[
             $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt ($CellContext`k1/
                4), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]]; $CellContext`k3 = Quiet[
             $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt ((3 $CellContext`k1 + 9 $CellContext`k2)/
                32), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]]; $CellContext`k4 = Quiet[
             $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt ((1932 $CellContext`k1 - 7200 $CellContext`k2 + 
                 7296 $CellContext`k3)/
                2197), $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]]; $CellContext`k5 = Quiet[
             $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt (439 ($CellContext`k1/216) - 8 $CellContext`k2 + 
                3680 ($CellContext`k3/513) - 
                845 ($CellContext`k4/
                 4104)), $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]]; $CellContext`k6 = Quiet[
             $CellContext`modelFunction[$CellContext`currentState + \
$CellContext`dt ((-8) ($CellContext`k1/27) + 2 $CellContext`k2 - 
                3544 ($CellContext`k3/2565) + 1859 ($CellContext`k4/4104) - 
                11 ($CellContext`k5/
                 40)), $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction]]; $CellContext`nextState = 
           Quiet[$CellContext`currentState + $CellContext`dt (
               16 ($CellContext`k1/135) + 6656 ($CellContext`k3/12825) + 
               28561 ($CellContext`k4/56430) - 9 ($CellContext`k5/50) + 
               2 ($CellContext`k6/
                 55))]; $CellContext`nextState]], $CellContext`sirModel = 
       Function[{$CellContext`state, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`naturalExtinction}, 
         Module[{$CellContext`S = Part[$CellContext`state, 1], $CellContext`F = 
           Part[$CellContext`state, 2], D = 
           Part[$CellContext`state, 
             3]}, {$CellContext`growthRate $CellContext`S - \
$CellContext`fireSpreadRate $CellContext`S \
($CellContext`F^2/$CellContext`populationSize) + $CellContext`regrowthRate 
            D, $CellContext`fireSpreadRate $CellContext`S \
($CellContext`F^2/$CellContext`populationSize) - $CellContext`deathRate \
$CellContext`F - $CellContext`naturalExtinction, $CellContext`deathRate \
$CellContext`F - $CellContext`regrowthRate D}]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.9427266168229103`*^9, 3.942726781566847*^9, 3.9427268392479*^9, {
   3.9427270841953926`*^9, 3.942727099404604*^9}, 3.942727454057808*^9, 
   3.9427277494768124`*^9, 3.942727908350462*^9, 3.94272859048015*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"0e791458-cd12-3d48-9258-8a1cc4f1c66f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Visualization", " ", "and", " ", "Controls", " ", "for", " ", "Ensemble", 
    " ", "Simulation", " ", "with", " ", "Susceptible", " ", "Trees"}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"Manipulate", "[", "\n", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data1", ",", " ", "data2", ",", " ", "data3", ",", " ", "data4", ",",
          " ", "xRange", ",", " ", "yRange"}], "}"}], ",", " ", "\n", "  ", 
       RowBox[{
        RowBox[{"xRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "duration"}], "}"}]}], ";", "\n", "  ", 
        RowBox[{"yRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "1"}], "}"}]}], ";", "\n", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Simulate", " ", "SIR", " ", "model", " ", "for", " ", "all", " ", 
          "fireSpreadRate", " ", "scenarios"}], " ", "*)"}], "\n", "  ", 
        RowBox[{"data1", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "fireSpreadRate1", ",", " ", "regrowthRate", ",", " ", "deathRate", 
           ",", " ", "\n", "     ", "growthRate", ",", " ", 
           "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
           ",", " ", "\n", "     ", "immuneFraction", ",", " ", 
           "onFireFraction"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"data2", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "fireSpreadRate2", ",", " ", "regrowthRate", ",", " ", "deathRate", 
           ",", " ", "\n", "     ", "growthRate", ",", " ", 
           "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
           ",", " ", "\n", "     ", "immuneFraction", ",", " ", 
           "onFireFraction"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"data3", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "fireSpreadRate3", ",", " ", "regrowthRate", ",", " ", "deathRate", 
           ",", " ", "\n", "     ", "growthRate", ",", " ", 
           "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
           ",", " ", "\n", "     ", "immuneFraction", ",", " ", 
           "onFireFraction"}], "]"}]}], ";", "\n", "  ", 
        RowBox[{"data4", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "fireSpreadRate4", ",", " ", "regrowthRate", ",", " ", "deathRate", 
           ",", " ", "\n", "     ", "growthRate", ",", " ", 
           "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
           ",", " ", "\n", "     ", "immuneFraction", ",", " ", 
           "onFireFraction"}], "]"}]}], ";", "\n", "  ", "\n", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Plot", " ", "results", " ", "for", " ", "\"\<on fire\>\"", " ", 
          "and", " ", "\"\<susceptible\>\"", " ", "trees"}], " ", "*)"}], 
        "\n", "  ", 
        RowBox[{"ListLinePlot", "[", "\n", "   ", 
         RowBox[{
          RowBox[{"{", "\n", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Susceptible", " ", "trees", " ", "for", " ", "each", " ", 
             "spread", " ", "rate"}], " ", "*)"}], "\n", "    ", 
           RowBox[{
            RowBox[{"data1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"data2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"data3", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"data4", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "    ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "On", " ", "fire", " ", "trees", " ", "for", " ", "each", " ", 
              "spread", " ", "rate"}], " ", "*)"}], "\n", "    ", 
            RowBox[{"data1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data4", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "\n", "   ", "}"}], ",", " ", 
          "\n", "   ", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", " ", "yRange"}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", "\n", "     ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", "Dashed", ",",
                " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", "\n", 
             "     ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", "DotDashed", 
               ",", " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", "Dotted", ",",
                " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", "\n", 
             "     ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", "Dashed", ",", 
               " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", "\n", 
             "     ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", "DotDashed", 
               ",", " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", "Dotted", ",", 
               " ", 
               RowBox[{"Thickness", "[", "0.005", "]"}]}], "}"}]}], "\n", 
            "   ", "}"}]}], ",", " ", "\n", "   ", 
          RowBox[{"AspectRatio", " ", "->", " ", "Full"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"600", ",", " ", "400"}], "}"}]}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "   ", 
          RowBox[{"FrameLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (days)\>\"", ",", " ", 
             "\"\<Proportion of Population\>\""}], "}"}]}], ",", " ", "\n", 
          "   ", 
          RowBox[{"PlotLegends", " ", "->", " ", 
           RowBox[{"{", "\n", "     ", 
            RowBox[{
            "\"\<S (Spread Rate 1)\>\"", ",", " ", 
             "\"\<S (Spread Rate 2)\>\"", ",", " ", 
             "\"\<S (Spread Rate 3)\>\"", ",", " ", "\n", "     ", 
             "\"\<S (Spread Rate 4)\>\"", ",", " ", 
             "\"\<F (Spread Rate 1)\>\"", ",", " ", 
             "\"\<F (Spread Rate 2)\>\"", ",", " ", "\n", "     ", 
             "\"\<F (Spread Rate 3)\>\"", ",", " ", 
             "\"\<F (Spread Rate 4)\>\""}], "\n", "   ", "}"}]}]}], "\n", 
         "  ", "]"}]}]}], "\n", " ", "]"}], ",", "\n", " ", 
     RowBox[{"(*", " ", "Controls", " ", "*)"}], "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate1", ",", " ", "0.01", ",", " ", 
         "\"\<Fire Spread Rate 1\>\""}], "}"}], ",", " ", "0.01", ",", " ", 
       "1", ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate2", ",", " ", "0.02", ",", " ", 
         "\"\<Fire Spread Rate 2\>\""}], "}"}], ",", " ", "0.01", ",", " ", 
       "1", ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate3", ",", " ", "0.03", ",", " ", 
         "\"\<Fire Spread Rate 3\>\""}], "}"}], ",", " ", "0.01", ",", " ", 
       "1", ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate4", ",", " ", "0.04", ",", " ", 
         "\"\<Fire Spread Rate 4\>\""}], "}"}], ",", " ", "0.01", ",", " ", 
       "1", ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "regrowthRate", ",", " ", "0.01", ",", " ", "\"\<Regrowth Rate\>\""}],
         "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ",
        "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "deathRate", ",", " ", "0.1", ",", " ", "\"\<Death Rate\>\""}], "}"}],
        ",", " ", "0.05", ",", " ", "0.3", ",", " ", "0.05", ",", " ", "\n", 
       "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "naturalExtinction", ",", " ", "0.1", ",", " ", 
         "\"\<Natural Extinction\>\""}], "}"}], ",", " ", "0.", ",", " ", 
       "1.0", ",", " ", "0.05", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "growthRate", ",", " ", "0.01", ",", " ", "\"\<Growth Rate\>\""}], 
        "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ", 
       "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "immuneFraction", ",", " ", "0.1", ",", " ", 
         "\"\<Initially Immune\>\""}], "}"}], ",", " ", "0", ",", " ", "0.9", 
       ",", " ", "0.01", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "onFireFraction", ",", " ", "0.01", ",", " ", 
         "\"\<Initially On Fire\>\""}], "}"}], ",", " ", "0", ",", " ", "\n", 
       "  ", 
       RowBox[{"1", " ", "-", " ", "immuneFraction"}], ",", " ", "0.01", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStep", ",", " ", "1.0", ",", " ", "\"\<Time Step (days)\>\""}], 
        "}"}], ",", " ", "0.001", ",", " ", "1.0", ",", " ", "0.001", ",", 
       " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "duration", ",", " ", "150", ",", " ", 
         "\"\<Simulation Time (days)\>\""}], "}"}], ",", " ", "10", ",", " ", 
       "300", ",", " ", "10", ",", " ", "\n", "  ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", " ", 
     RowBox[{"SaveDefinitions", " ", "->", " ", "True"}]}], "]"}], 
   "\n"}]}]], "Code",
 CellChangeTimes->{
  3.9427276530511417`*^9, {3.942727732009638*^9, 3.942727734716673*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"26632834-c4fe-064a-9549-29ff6f83ea8b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ =
     150, $CellContext`fireSpreadRate1$$ = 
    0.01, $CellContext`fireSpreadRate2$$ = 
    0.02, $CellContext`fireSpreadRate3$$ = 
    0.03, $CellContext`fireSpreadRate4$$ = 0.04, $CellContext`growthRate$$ = 
    0.01, $CellContext`immuneFraction$$ = 
    0.1, $CellContext`naturalExtinction$$ = 
    0.1, $CellContext`onFireFraction$$ = 0.01, $CellContext`regrowthRate$$ = 
    0.01, $CellContext`timeStep$$ = 1., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`fireSpreadRate1$$], 0.01, "Fire Spread Rate 1"}, 
      0.01, 1, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`fireSpreadRate2$$], 0.02, "Fire Spread Rate 2"}, 
      0.01, 1, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`fireSpreadRate3$$], 0.03, "Fire Spread Rate 3"}, 
      0.01, 1, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`fireSpreadRate4$$], 0.04, "Fire Spread Rate 4"}, 
      0.01, 1, 0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`regrowthRate$$], 0.01, "Regrowth Rate"}, 0., 0.05, 
      0.005, ControlType -> Manipulator}, {{
       Hold[$CellContext`deathRate$$], 0.1, "Death Rate"}, 0.05, 0.3, 0.05, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`naturalExtinction$$], 0.1, "Natural Extinction"}, 0.,
       1., 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`growthRate$$], 0.01, "Growth Rate"}, 0., 0.05, 0.005,
       ControlType -> Manipulator}, {{
       Hold[$CellContext`immuneFraction$$], 0.1, "Initially Immune"}, 0, 0.9, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`onFireFraction$$], 0.01, "Initially On Fire"}, 0, 
      Dynamic[1 - $CellContext`immuneFraction$$], 0.01, ControlType -> 
      Manipulator}, {{
       Hold[$CellContext`timeStep$$], 1., "Time Step (days)"}, 0.001, 1., 
      0.001, ControlType -> Manipulator}, {{
       Hold[$CellContext`duration$$], 150, "Simulation Time (days)"}, 10, 300,
       10, ControlType -> Manipulator}}, Typeset`size$$ = {
    663.7633577299118, {177.61904303182382`, 182.38095696817618`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ = 
        150, $CellContext`fireSpreadRate1$$ = 
        0.01, $CellContext`fireSpreadRate2$$ = 
        0.02, $CellContext`fireSpreadRate3$$ = 
        0.03, $CellContext`fireSpreadRate4$$ = 
        0.04, $CellContext`growthRate$$ = 0.01, $CellContext`immuneFraction$$ = 
        0.1, $CellContext`naturalExtinction$$ = 
        0.1, $CellContext`onFireFraction$$ = 
        0.01, $CellContext`regrowthRate$$ = 0.01, $CellContext`timeStep$$ = 
        1.}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> 
      Module[{$CellContext`data1$, $CellContext`data2$, $CellContext`data3$, \
$CellContext`data4$, $CellContext`xRange$, $CellContext`yRange$}, \
$CellContext`xRange$ = {0, $CellContext`duration$$}; $CellContext`yRange$ = {
          0, 1}; $CellContext`data1$ = \
$CellContext`simulateSIR[$CellContext`fireSpreadRate1$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]; \
$CellContext`data2$ = \
$CellContext`simulateSIR[$CellContext`fireSpreadRate2$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]; \
$CellContext`data3$ = \
$CellContext`simulateSIR[$CellContext`fireSpreadRate3$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]; \
$CellContext`data4$ = \
$CellContext`simulateSIR[$CellContext`fireSpreadRate4$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`naturalExtinction$$, \
$CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$]; ListLinePlot[{
           Part[$CellContext`data1$, 1], 
           Part[$CellContext`data2$, 1], 
           Part[$CellContext`data3$, 1], 
           Part[$CellContext`data4$, 1], 
           Part[$CellContext`data1$, 2], 
           Part[$CellContext`data2$, 2], 
           Part[$CellContext`data3$, 2], 
           Part[$CellContext`data4$, 2]}, 
          PlotRange -> {$CellContext`xRange$, $CellContext`yRange$}, 
          PlotStyle -> {{
             Darker[Green], 
             Thickness[0.005]}, {
             Darker[Green], Dashed, 
             Thickness[0.005]}, {
             Darker[Green], DotDashed, 
             Thickness[0.005]}, {
             Darker[Green], Dotted, 
             Thickness[0.005]}, {
             Lighter[Red], 
             Thickness[0.005]}, {
             Lighter[Red], Dashed, 
             Thickness[0.005]}, {
             Lighter[Red], DotDashed, 
             Thickness[0.005]}, {
             Lighter[Red], Dotted, 
             Thickness[0.005]}}, AspectRatio -> Full, ImageSize -> {600, 400},
           Frame -> True, 
          FrameLabel -> {"Time (days)", "Proportion of Population"}, 
          PlotLegends -> {
           "S (Spread Rate 1)", "S (Spread Rate 2)", "S (Spread Rate 3)", 
            "S (Spread Rate 4)", "F (Spread Rate 1)", "F (Spread Rate 2)", 
            "F (Spread Rate 3)", "F (Spread Rate 4)"}]], 
      "Specifications" :> {{{$CellContext`fireSpreadRate1$$, 0.01, 
          "Fire Spread Rate 1"}, 0.01, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`fireSpreadRate2$$, 0.02, 
          "Fire Spread Rate 2"}, 0.01, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`fireSpreadRate3$$, 0.03, 
          "Fire Spread Rate 3"}, 0.01, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`fireSpreadRate4$$, 0.04, 
          "Fire Spread Rate 4"}, 0.01, 1, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`regrowthRate$$, 0.01, "Regrowth Rate"}, 
         0., 0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`deathRate$$, 0.1, "Death Rate"}, 0.05, 
         0.3, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`naturalExtinction$$, 0.1, 
          "Natural Extinction"}, 0., 1., 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`growthRate$$, 0.01, "Growth Rate"}, 0., 
         0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`immuneFraction$$, 0.1, 
          "Initially Immune"}, 0, 0.9, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`onFireFraction$$, 0.01, 
          "Initially On Fire"}, 0, 
         Dynamic[1 - $CellContext`immuneFraction$$], 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`timeStep$$, 1., "Time Step (days)"}, 
         0.001, 1., 0.001, Appearance -> 
         "Labeled"}, {{$CellContext`duration$$, 150, 
          "Simulation Time (days)"}, 10, 300, 10, Appearance -> "Labeled"}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{
      1003.0746340284347`, {203.50189459432383`, 208.2638085306762}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`simulateSIR = 
       Function[{$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`stepSize, \
$CellContext`maxTime, $CellContext`immuneFrac, $CellContext`onFireFrac, \
$CellContext`fireLimit, $CellContext`naturalExtinction}, 
         Module[{$CellContext`initialState, $CellContext`steps, \
$CellContext`validatedStepSize, $CellContext`validatedMaxTime, \
$CellContext`S0, $CellContext`F0, $CellContext`D0, $CellContext`results}, \
$CellContext`validatedStepSize = Max[0.001, 
             
             Min[$CellContext`stepSize, $CellContext`maxTime]]; \
$CellContext`validatedMaxTime = 
           Max[$CellContext`validatedStepSize, $CellContext`maxTime]; \
$CellContext`S0 = $CellContext`populationSize (
             1 - $CellContext`immuneFrac - $CellContext`onFireFrac); \
$CellContext`F0 = $CellContext`populationSize $CellContext`onFireFrac; \
$CellContext`D0 = $CellContext`populationSize $CellContext`immuneFrac; \
$CellContext`initialState = {$CellContext`S0, $CellContext`F0, \
$CellContext`D0}; $CellContext`steps = 
           Range[0, $CellContext`validatedMaxTime, \
$CellContext`validatedStepSize]; $CellContext`results = 
           NestList[$CellContext`rk45Integrator[$CellContext`sirModel, \
$CellContext`validatedStepSize, #, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction]& , \
$CellContext`initialState, Length[$CellContext`steps] - 1]; 
          Transpose[$CellContext`results]/$CellContext`populationSize]], \
$CellContext`populationSize = 1000, $CellContext`rk45Integrator = 
       Function[{$CellContext`modelFunction, $CellContext`dt, \
$CellContext`currentState, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction}, 
         Module[{$CellContext`k1, $CellContext`k2, $CellContext`k3, \
$CellContext`k4, $CellContext`k5, $CellContext`k6, $CellContext`nextState}, \
$CellContext`k1 = $CellContext`modelFunction[$CellContext`currentState, \
$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k2 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt \
($CellContext`k1/
               4), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k3 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                3 $CellContext`k1 + 9 $CellContext`k2)/
               32), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k4 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                1932 $CellContext`k1 - 7200 $CellContext`k2 + 
                7296 $CellContext`k3)/
               2197), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k5 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt (
               439 ($CellContext`k1/216) - 8 $CellContext`k2 + 
               3680 ($CellContext`k3/513) - 
               845 ($CellContext`k4/
                4104)), $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction]; $CellContext`k6 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((-8) \
($CellContext`k1/27) + 2 $CellContext`k2 - 3544 ($CellContext`k3/2565) + 
               1859 ($CellContext`k4/4104) - 
               11 ($CellContext`k5/
                40)), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`nextState = \
$CellContext`currentState + $CellContext`dt (16 ($CellContext`k1/135) + 
              6656 ($CellContext`k3/12825) + 28561 ($CellContext`k4/56430) - 
              9 ($CellContext`k5/50) + 
              2 ($CellContext`k6/
                55)); $CellContext`nextState]], $CellContext`sirModel = 
       Function[{$CellContext`state, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction}, 
         Module[{$CellContext`S = Part[$CellContext`state, 1], $CellContext`F = 
           Part[$CellContext`state, 2], D = 
           Part[$CellContext`state, 
             3]}, {$CellContext`growthRate $CellContext`S - \
($CellContext`fireSpreadRate $CellContext`S \
$CellContext`F)/$CellContext`populationSize + 
           D $CellContext`regrowthRate, ($CellContext`fireSpreadRate \
$CellContext`S $CellContext`F (
              1 - $CellContext`F/$CellContext`fireLimit))/$CellContext`\
populationSize - $CellContext`F $CellContext`deathRate - $CellContext`F^2/(
           1 + $CellContext`F^2) - $CellContext`naturalExtinction, \
$CellContext`F $CellContext`deathRate - D $CellContext`regrowthRate}]]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.9427276546745033`*^9, 3.9427276745334167`*^9}, 
   3.942727736122616*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"359ff6c5-0d34-ee4a-9ac9-c8311925d9af"],

Cell[BoxData[
 TemplateBox[{
  "Function", "fpct", 
   "\"Too many parameters in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \
\\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}]\\) to be filled from \
\\!\\(\\*RowBox[{RowBox[{\\\"Function\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \
\\\",\\\", \\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Module\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"initialState\\\", \
\\\",\\\", \\\"steps\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \\\
\"validatedMaxTime\\\", \\\",\\\", \\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\
\", \\\"D0\\\", \\\",\\\", \\\"results\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"validatedStepSize\\\", \\\"=\\\", RowBox[{\\\"Max\\\", \\\
\"[\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", RowBox[{\\\"Min\\\", \\\"[\\\", \
RowBox[{\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\"}], \\\"]\\\"}]}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"validatedMaxTime\\\", \\\"=\\\", \
RowBox[{\\\"Max\\\", \\\"[\\\", RowBox[{\\\"validatedStepSize\\\", \\\",\\\", \
\\\"maxTime\\\"}], \\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"S0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\
\", \\\"-\\\", \\\"immuneFrac\\\", \\\"-\\\", \\\"onFireFrac\\\"}], \
\\\")\\\"}]}]}], \\\";\\\", RowBox[{\\\"F0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", \\\"onFireFrac\\\"}]}], \\\";\\\", \
RowBox[{\\\"D0\\\", \\\"=\\\", RowBox[{\\\"populationSize\\\", \\\" \\\", \
\\\"immuneFrac\\\"}]}], \\\";\\\", RowBox[{\\\"initialState\\\", \\\"=\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\", \
\\\"D0\\\"}], \\\"}\\\"}]}], \\\";\\\", RowBox[{\\\"steps\\\", \\\"=\\\", \
RowBox[{\\\"Range\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"validatedMaxTime\\\", \\\",\\\", \\\"validatedStepSize\\\"}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"results\\\", \\\"=\\\", \
RowBox[{\\\"NestList\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"rk45Integrator\\\", \\\"[\\\", \
RowBox[{\\\"sirModel\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \
RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"fireSpreadRate\\\", \
\\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \\\"deathRate\\\", \\\",\\\", \
\\\"growthRate\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"initialState\\\", \\\",\\\", RowBox[{RowBox[{\\\"Length\\\", \\\"[\\\", \
\\\"steps\\\", \\\"]\\\"}], \\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]}], \
\\\";\\\", FractionBox[TemplateBox[List[\\\"results\\\"], \\\"Transpose\\\", \
Rule[SyntaxForm, SuperscriptBox]], \\\"populationSize\\\"]}]}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"[\\\", RowBox[{\\\"0.01`\\\", \\\",\\\", \
\\\"0.01`\\\", \\\",\\\", \\\"0.1`\\\", \\\",\\\", \\\"0.01`\\\", \\\",\\\", \
\\\"0.1`\\\", \\\",\\\", \\\"1.`\\\", \\\",\\\", \\\"150\\\", \\\",\\\", \
\\\"0.1`\\\", \\\",\\\", \\\"0.01`\\\"}], \\\"]\\\"}]\\).\"", 2, 29, 2322, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427277363594627`*^9},
 CellLabel->"",ExpressionUUID->"9920a177-b082-3342-b8ad-241e73df6ec5"],

Cell[BoxData[
 TemplateBox[{
  "Function", "fpct", 
   "\"Too many parameters in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \
\\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}]\\) to be filled from \
\\!\\(\\*RowBox[{RowBox[{\\\"Function\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \
\\\",\\\", \\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Module\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"initialState\\\", \
\\\",\\\", \\\"steps\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \\\
\"validatedMaxTime\\\", \\\",\\\", \\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\
\", \\\"D0\\\", \\\",\\\", \\\"results\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"validatedStepSize\\\", \\\"=\\\", RowBox[{\\\"Max\\\", \\\
\"[\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", RowBox[{\\\"Min\\\", \\\"[\\\", \
RowBox[{\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\"}], \\\"]\\\"}]}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"validatedMaxTime\\\", \\\"=\\\", \
RowBox[{\\\"Max\\\", \\\"[\\\", RowBox[{\\\"validatedStepSize\\\", \\\",\\\", \
\\\"maxTime\\\"}], \\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"S0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\
\", \\\"-\\\", \\\"immuneFrac\\\", \\\"-\\\", \\\"onFireFrac\\\"}], \
\\\")\\\"}]}]}], \\\";\\\", RowBox[{\\\"F0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", \\\"onFireFrac\\\"}]}], \\\";\\\", \
RowBox[{\\\"D0\\\", \\\"=\\\", RowBox[{\\\"populationSize\\\", \\\" \\\", \
\\\"immuneFrac\\\"}]}], \\\";\\\", RowBox[{\\\"initialState\\\", \\\"=\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\", \
\\\"D0\\\"}], \\\"}\\\"}]}], \\\";\\\", RowBox[{\\\"steps\\\", \\\"=\\\", \
RowBox[{\\\"Range\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"validatedMaxTime\\\", \\\",\\\", \\\"validatedStepSize\\\"}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"results\\\", \\\"=\\\", \
RowBox[{\\\"NestList\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"rk45Integrator\\\", \\\"[\\\", \
RowBox[{\\\"sirModel\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \
RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"fireSpreadRate\\\", \
\\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \\\"deathRate\\\", \\\",\\\", \
\\\"growthRate\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"initialState\\\", \\\",\\\", RowBox[{RowBox[{\\\"Length\\\", \\\"[\\\", \
\\\"steps\\\", \\\"]\\\"}], \\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]}], \
\\\";\\\", FractionBox[TemplateBox[List[\\\"results\\\"], \\\"Transpose\\\", \
Rule[SyntaxForm, SuperscriptBox]], \\\"populationSize\\\"]}]}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"[\\\", RowBox[{\\\"0.02`\\\", \\\",\\\", \
\\\"0.01`\\\", \\\",\\\", \\\"0.1`\\\", \\\",\\\", \\\"0.01`\\\", \\\",\\\", \
\\\"0.1`\\\", \\\",\\\", \\\"1.`\\\", \\\",\\\", \\\"150\\\", \\\",\\\", \
\\\"0.1`\\\", \\\",\\\", \\\"0.01`\\\"}], \\\"]\\\"}]\\).\"", 2, 29, 2323, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427277363759747`*^9},
 CellLabel->"",ExpressionUUID->"0aef425a-c9d8-f54f-9eb9-a8a91326d759"],

Cell[BoxData[
 TemplateBox[{
  "Function", "fpct", 
   "\"Too many parameters in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \
\\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}]\\) to be filled from \
\\!\\(\\*RowBox[{RowBox[{\\\"Function\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \
\\\",\\\", \\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Module\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"initialState\\\", \
\\\",\\\", \\\"steps\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \\\
\"validatedMaxTime\\\", \\\",\\\", \\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\
\", \\\"D0\\\", \\\",\\\", \\\"results\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"validatedStepSize\\\", \\\"=\\\", RowBox[{\\\"Max\\\", \\\
\"[\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", RowBox[{\\\"Min\\\", \\\"[\\\", \
RowBox[{\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\"}], \\\"]\\\"}]}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"validatedMaxTime\\\", \\\"=\\\", \
RowBox[{\\\"Max\\\", \\\"[\\\", RowBox[{\\\"validatedStepSize\\\", \\\",\\\", \
\\\"maxTime\\\"}], \\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"S0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\
\", \\\"-\\\", \\\"immuneFrac\\\", \\\"-\\\", \\\"onFireFrac\\\"}], \
\\\")\\\"}]}]}], \\\";\\\", RowBox[{\\\"F0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", \\\"onFireFrac\\\"}]}], \\\";\\\", \
RowBox[{\\\"D0\\\", \\\"=\\\", RowBox[{\\\"populationSize\\\", \\\" \\\", \
\\\"immuneFrac\\\"}]}], \\\";\\\", RowBox[{\\\"initialState\\\", \\\"=\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\", \
\\\"D0\\\"}], \\\"}\\\"}]}], \\\";\\\", RowBox[{\\\"steps\\\", \\\"=\\\", \
RowBox[{\\\"Range\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \
\\\"validatedMaxTime\\\", \\\",\\\", \\\"validatedStepSize\\\"}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"results\\\", \\\"=\\\", \
RowBox[{\\\"NestList\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"rk45Integrator\\\", \\\"[\\\", \
RowBox[{\\\"sirModel\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \
RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"fireSpreadRate\\\", \
\\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \\\"deathRate\\\", \\\",\\\", \
\\\"growthRate\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"initialState\\\", \\\",\\\", RowBox[{RowBox[{\\\"Length\\\", \\\"[\\\", \
\\\"steps\\\", \\\"]\\\"}], \\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]}], \
\\\";\\\", FractionBox[TemplateBox[List[\\\"results\\\"], \\\"Transpose\\\", \
Rule[SyntaxForm, SuperscriptBox]], \\\"populationSize\\\"]}]}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"[\\\", RowBox[{\\\"0.03`\\\", \\\",\\\", \
\\\"0.01`\\\", \\\",\\\", \\\"0.1`\\\", \\\",\\\", \\\"0.01`\\\", \\\",\\\", \
\\\"0.1`\\\", \\\",\\\", \\\"1.`\\\", \\\",\\\", \\\"150\\\", \\\",\\\", \
\\\"0.1`\\\", \\\",\\\", \\\"0.01`\\\"}], \\\"]\\\"}]\\).\"", 2, 29, 2324, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.94272773639098*^9},
 CellLabel->"",ExpressionUUID->"bfcf78a8-db4a-5048-beac-1f8f9605ffdd"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Function\\\", \
\\\"::\\\", \\\"fpct\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 29, 2325, 23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942727736423313*^9},
 CellLabel->"",ExpressionUUID->"74701c81-2ebf-f540-9f66-29801b392ffb"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 144, 2411, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942736320266491*^9},
 CellLabel->"",ExpressionUUID->"7acbce89-6c9f-634c-b7aa-59d84fe4c381"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 144, 2412, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942736320280073*^9},
 CellLabel->"",ExpressionUUID->"841a31d3-cf90-cb4c-ba38-268550eb2f74"],

Cell[BoxData[
 TemplateBox[{
  "General", "ovfl", "\"Overflow occurred in computation.\"", 2, 144, 2413, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427363202850285`*^9},
 CellLabel->"",ExpressionUUID->"fdf24658-0cb9-0149-9b21-ea2433bae563"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"ovfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 144, 2414, 23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942736320290489*^9},
 CellLabel->"",ExpressionUUID->"1929b9d4-3237-cc4f-b171-1942adc128e9"],

Cell[BoxData[
 TemplateBox[{
  "Function", "fpct", 
   "\"Too many parameters in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \
\\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}]\\) to be filled from \
\\!\\(\\*RowBox[{RowBox[{\\\"Function\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \
\\\",\\\", \\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Module\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"initialState\\\", \
\\\",\\\", \\\"steps\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \\\
\"validatedMaxTime\\\", \\\",\\\", \\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\
\", \\\"D0\\\", \\\",\\\", \\\"results\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"validatedStepSize\\\", \\\"=\\\", RowBox[{\\\"Max\\\", \\\
\"[\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", RowBox[{\\\"Min\\\", \\\"[\\\", \
RowBox[{\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\"}], \\\"]\\\"}]}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"validatedMaxTime\\\", \\\"=\\\", \
RowBox[{\\\"Max\\\", \\\"[\\\", RowBox[{\\\"validatedStepSize\\\", \\\",\\\", \
\\\"maxTime\\\"}], \\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"S0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\
\", \\\"-\\\", \\\"immuneFrac\\\", \\\"-\\\", \\\"onFireFrac\\\"}], \
\\\")\\\"}]}]}], \\\";\\\", RowBox[{\\\"F0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", \\\"onFireFrac\\\"}]}], \\\";\\\", \
RowBox[{\\\"D0\\\", \\\"=\\\", RowBox[{\\\"populationSize\\\", \\\" \\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"10\\\", \\\"\[RightSkeleton]\\\"}]}]}], \
\\\";\\\", RowBox[{\\\"initialState\\\", \\\"=\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\", \\\"D0\\\"}], \
\\\"}\\\"}]}], \\\";\\\", RowBox[{\\\"steps\\\", \\\"=\\\", RowBox[{\\\"Range\
\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"validatedMaxTime\\\", \
\\\",\\\", \\\"validatedStepSize\\\"}], \\\"]\\\"}]}], \\\";\\\", \
RowBox[{\\\"results\\\", \\\"=\\\", RowBox[{\\\"NestList\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"rk45Integrator\\\", \\\"[\\\", \
RowBox[{\\\"sirModel\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \
RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"fireSpreadRate\\\", \
\\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \\\"deathRate\\\", \\\",\\\", \
\\\"growthRate\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"initialState\\\", \\\",\\\", RowBox[{RowBox[{\\\"Length\\\", \\\"[\\\", \
\\\"steps\\\", \\\"]\\\"}], \\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]}], \
\\\";\\\", FractionBox[TemplateBox[List[\\\"results\\\"], \\\"Transpose\\\", \
Rule[SyntaxForm, SuperscriptBox]], \\\"populationSize\\\"]}]}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]\\).\"", 2, 228, 2524, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427444017401733`*^9},
 CellLabel->"",ExpressionUUID->"e6d1c11e-260d-9044-82bb-f02123728c74"],

Cell[BoxData[
 TemplateBox[{
  "Function", "fpct", 
   "\"Too many parameters in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \
\\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}]\\) to be filled from \
\\!\\(\\*RowBox[{RowBox[{\\\"Function\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \
\\\",\\\", \\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Module\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"initialState\\\", \
\\\",\\\", \\\"steps\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \\\
\"validatedMaxTime\\\", \\\",\\\", \\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\
\", \\\"D0\\\", \\\",\\\", \\\"results\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"validatedStepSize\\\", \\\"=\\\", RowBox[{\\\"Max\\\", \\\
\"[\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", RowBox[{\\\"Min\\\", \\\"[\\\", \
RowBox[{\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\"}], \\\"]\\\"}]}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"validatedMaxTime\\\", \\\"=\\\", \
RowBox[{\\\"Max\\\", \\\"[\\\", RowBox[{\\\"validatedStepSize\\\", \\\",\\\", \
\\\"maxTime\\\"}], \\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"S0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\
\", \\\"-\\\", \\\"immuneFrac\\\", \\\"-\\\", \\\"onFireFrac\\\"}], \
\\\")\\\"}]}]}], \\\";\\\", RowBox[{\\\"F0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", \\\"onFireFrac\\\"}]}], \\\";\\\", \
RowBox[{\\\"D0\\\", \\\"=\\\", RowBox[{\\\"populationSize\\\", \\\" \\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"10\\\", \\\"\[RightSkeleton]\\\"}]}]}], \
\\\";\\\", RowBox[{\\\"initialState\\\", \\\"=\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\", \\\"D0\\\"}], \
\\\"}\\\"}]}], \\\";\\\", RowBox[{\\\"steps\\\", \\\"=\\\", RowBox[{\\\"Range\
\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"validatedMaxTime\\\", \
\\\",\\\", \\\"validatedStepSize\\\"}], \\\"]\\\"}]}], \\\";\\\", \
RowBox[{\\\"results\\\", \\\"=\\\", RowBox[{\\\"NestList\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"rk45Integrator\\\", \\\"[\\\", \
RowBox[{\\\"sirModel\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \
RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"fireSpreadRate\\\", \
\\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \\\"deathRate\\\", \\\",\\\", \
\\\"growthRate\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"initialState\\\", \\\",\\\", RowBox[{RowBox[{\\\"Length\\\", \\\"[\\\", \
\\\"steps\\\", \\\"]\\\"}], \\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]}], \
\\\";\\\", FractionBox[TemplateBox[List[\\\"results\\\"], \\\"Transpose\\\", \
Rule[SyntaxForm, SuperscriptBox]], \\\"populationSize\\\"]}]}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]\\).\"", 2, 228, 2525, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942744401749506*^9},
 CellLabel->"",ExpressionUUID->"6b053862-4ff5-1341-bf3f-e60c57c37994"],

Cell[BoxData[
 TemplateBox[{
  "Function", "fpct", 
   "\"Too many parameters in \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \
\\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}]\\) to be filled from \
\\!\\(\\*RowBox[{RowBox[{\\\"Function\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"fireSpreadRate\\\", \\\",\\\", \\\"regrowthRate\\\", \
\\\",\\\", \\\"deathRate\\\", \\\",\\\", \\\"growthRate\\\", \\\",\\\", \
\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\", \\\",\\\", \\\"immuneFrac\\\", \
\\\",\\\", \\\"onFireFrac\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Module\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"initialState\\\", \
\\\",\\\", \\\"steps\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \\\
\"validatedMaxTime\\\", \\\",\\\", \\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\
\", \\\"D0\\\", \\\",\\\", \\\"results\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"validatedStepSize\\\", \\\"=\\\", RowBox[{\\\"Max\\\", \\\
\"[\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", RowBox[{\\\"Min\\\", \\\"[\\\", \
RowBox[{\\\"stepSize\\\", \\\",\\\", \\\"maxTime\\\"}], \\\"]\\\"}]}], \
\\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"validatedMaxTime\\\", \\\"=\\\", \
RowBox[{\\\"Max\\\", \\\"[\\\", RowBox[{\\\"validatedStepSize\\\", \\\",\\\", \
\\\"maxTime\\\"}], \\\"]\\\"}]}], \\\";\\\", RowBox[{\\\"S0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"1\\\
\", \\\"-\\\", \\\"immuneFrac\\\", \\\"-\\\", \\\"onFireFrac\\\"}], \
\\\")\\\"}]}]}], \\\";\\\", RowBox[{\\\"F0\\\", \\\"=\\\", \
RowBox[{\\\"populationSize\\\", \\\" \\\", \\\"onFireFrac\\\"}]}], \\\";\\\", \
RowBox[{\\\"D0\\\", \\\"=\\\", RowBox[{\\\"populationSize\\\", \\\" \\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"10\\\", \\\"\[RightSkeleton]\\\"}]}]}], \
\\\";\\\", RowBox[{\\\"initialState\\\", \\\"=\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"S0\\\", \\\",\\\", \\\"F0\\\", \\\",\\\", \\\"D0\\\"}], \
\\\"}\\\"}]}], \\\";\\\", RowBox[{\\\"steps\\\", \\\"=\\\", RowBox[{\\\"Range\
\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"validatedMaxTime\\\", \
\\\",\\\", \\\"validatedStepSize\\\"}], \\\"]\\\"}]}], \\\";\\\", \
RowBox[{\\\"results\\\", \\\"=\\\", RowBox[{\\\"NestList\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"rk45Integrator\\\", \\\"[\\\", \
RowBox[{\\\"sirModel\\\", \\\",\\\", \\\"validatedStepSize\\\", \\\",\\\", \
RowBox[{\\\"Slot\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"fireSpreadRate\\\", \
\\\",\\\", \\\"regrowthRate\\\", \\\",\\\", \\\"deathRate\\\", \\\",\\\", \
\\\"growthRate\\\", \\\",\\\", \\\"fireLimit\\\", \\\",\\\", \
\\\"naturalExtinction\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
\\\"initialState\\\", \\\",\\\", RowBox[{RowBox[{\\\"Length\\\", \\\"[\\\", \
\\\"steps\\\", \\\"]\\\"}], \\\"-\\\", \\\"1\\\"}]}], \\\"]\\\"}]}], \
\\\";\\\", FractionBox[TemplateBox[List[\\\"results\\\"], \\\"Transpose\\\", \
Rule[SyntaxForm, SuperscriptBox]], \\\"populationSize\\\"]}]}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]\\).\"", 2, 228, 2526, 
   23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.942744401758156*^9},
 CellLabel->"",ExpressionUUID->"66f85493-c8ab-cd4f-8646-9d990b557d78"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Function\\\", \
\\\"::\\\", \\\"fpct\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 228, 2527, 23997434032631410949, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9427444017861156`*^9},
 CellLabel->"",ExpressionUUID->"6a6537ed-30ac-6146-aa74-feb2d63dd9e1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.3 Limiting Fire Spread", "Section",
 CellChangeTimes->{{3.9427160326463795`*^9, 3.9427160449078465`*^9}, {
  3.942717062126623*^9, 
  3.942717065505808*^9}},ExpressionUUID->"71d2af2e-ca76-1c4b-a383-\
2de53e46e5c6"],

Cell[TextData[Cell[BoxData[""], \
"Code",ExpressionUUID->"31275d2e-573a-9b41-9eee-b7fe40d8b1a8"]], "Text",
 CellChangeTimes->{{3.942713435806343*^9, 
  3.9427134412202168`*^9}},ExpressionUUID->"3941b58a-bda5-a540-af76-\
6b969c75befc"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dS",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "=", 
    RowBox[{
     RowBox[{
      StyleBox["growthRate",
       FontSlant->"Italic"], 
      StyleBox["*",
       FontSlant->"Italic"], "S"}], "-", 
     FractionBox[
      RowBox[{
       StyleBox["firespread",
        FontSlant->"Italic"], "*", "S", "*", 
       RowBox[{"F", "(", 
        RowBox[{"1", "-", 
         FractionBox["F", 
          StyleBox["fireLimit",
           FontSlant->"Italic"]]}], ")"}]}], 
      StyleBox[
       RowBox[{"population", " ", "size"}],
       FontSlant->"Italic"]]}]}], TraditionalForm]],ExpressionUUID->
  "ec6d990d-dd8a-864f-87e3-1ba9b948faac"],
 "+ ",
 StyleBox["regrowthRate*D",
  FontSlant->"Italic"]
}], "EquationNumbered",
 CellChangeTimes->{{3.9427171059459934`*^9, 3.942717136765833*^9}, {
  3.9427172178504333`*^9, 
  3.942717221482401*^9}},ExpressionUUID->"292a27eb-b1b4-ac4f-8f8f-\
91ba6560c00c"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dF",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "="}], TraditionalForm]],ExpressionUUID->
  "41a82d4f-f42c-4641-a4f8-06dcb38c70d4"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      StyleBox["firespread",
       FontSlant->"Italic"], "*", "S", "*", 
      RowBox[{"F", "(", 
       RowBox[{"1", "-", 
        FractionBox["F", 
         StyleBox["fireLimit",
          FontSlant->"Italic"]]}], ")"}]}], 
     StyleBox[
      RowBox[{"population", " ", "size"}],
      FontSlant->"Italic"]], "-", 
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}], "-", 
    StyleBox["naturalExtinction",
     FontSlant->"Italic"]}], TraditionalForm]],ExpressionUUID->
  "4a7c0296-d89b-db4b-b3ee-d74c9e140272"]
}], "EquationNumbered",
 CellChangeTimes->{{3.9427171059459934`*^9, 
  3.9427172005546055`*^9}},ExpressionUUID->"f8a72074-fe31-0b4a-a84b-\
3f02bdac8875"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     StyleBox["dD",
      FontSlant->"Italic"], 
     StyleBox["dt",
      FontSlant->"Italic"]], "="}], TraditionalForm]],ExpressionUUID->
  "38593275-aaee-b948-abf5-9e61f8aeb3ca"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}], " ", "-", 
    StyleBox[
     RowBox[{"regrowthRate", "*", "D"}],
     FontSlant->"Italic"]}], TraditionalForm]],ExpressionUUID->
  "d9e80c17-0b05-0e48-9ca3-18af2e354ba1"]
}], "EquationNumbered",
 CellChangeTimes->{{3.9427171059459934`*^9, 
  3.942717153458908*^9}},ExpressionUUID->"de7c2ab4-44eb-4242-bb96-\
1241c04f5dab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "population", " ", "size"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"populationSize", " ", "=", " ", "1000"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"SIR", " ", "Model", " ", "Derivatives"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"sirModel", " ", "=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "state", ",", " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", 
         " ", "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",",
          " ", "naturalExtinction"}], "}"}], ",", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"S", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"F", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
           RowBox[{"D", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", "\n", "     ", 
          RowBox[{"(*", " ", 
           RowBox[{"dS", "/", "dt"}], " ", "*)"}], "\n", "     ", 
          RowBox[{
           RowBox[{
            RowBox[{"growthRate", " ", "*", " ", "S"}], " ", "-", " ", 
            RowBox[{
            "fireSpreadRate", " ", "*", " ", "S", " ", "*", " ", "F", " ", 
             "*", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", " ", "-", " ", 
                RowBox[{"F", " ", "/", " ", "fireLimit"}]}], ")"}], " ", "/", 
              " ", "populationSize"}]}], " ", "+", " ", 
            RowBox[{"regrowthRate", " ", "*", " ", "D"}]}], ",", "\n", 
           "     ", 
           RowBox[{"(*", " ", 
            RowBox[{"dF", "/", "dt"}], " ", "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{
            "fireSpreadRate", " ", "*", " ", "S", " ", "*", " ", "F", " ", 
             "*", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", " ", "-", " ", 
                RowBox[{"F", " ", "/", " ", "fireLimit"}]}], ")"}], " ", "/", 
              " ", "populationSize"}]}], " ", "-", " ", 
            RowBox[{"deathRate", " ", "*", " ", "F"}], " ", "-", " ", 
            "naturalExtinction"}], ",", "\n", "     ", 
           RowBox[{"(*", " ", 
            RowBox[{"dD", "/", "dt"}], " ", "*)"}], "\n", "     ", 
           RowBox[{
            RowBox[{"deathRate", " ", "*", " ", "F"}], " ", "-", " ", 
            RowBox[{"regrowthRate", " ", "*", " ", "D"}]}]}], "\n", "   ", 
          "}"}]}], "]"}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"RK4", 
     RowBox[{"(", "5", ")"}], " ", "Integrator"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"rk45Integrator", " ", "=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "modelFunction", ",", " ", "dt", ",", " ", "currentState", ",", " ", 
         "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
         ",", " ", "growthRate", ",", " ", "fireLimit", ",", " ", 
         "naturalExtinction"}], "}"}], ",", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
           "k5", ",", " ", "k6", ",", " ", "nextState"}], "}"}], ",", "\n", 
         "     ", 
         RowBox[{
          RowBox[{"k1", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
            "currentState", ",", " ", "fireSpreadRate", ",", " ", 
             "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate", 
             ",", " ", "fireLimit", ",", " ", "naturalExtinction"}], "]"}]}], 
          ";", "\n", "     ", 
          RowBox[{"k2", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"k1", " ", "/", " ", "4"}]}]}], ",", " ", 
             "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",", 
             " ", "naturalExtinction"}], "]"}]}], ";", "\n", "     ", 
          RowBox[{"k3", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "k1"}], " ", "+", " ", 
                  RowBox[{"9", " ", "k2"}]}], ")"}], " ", "/", " ", 
                "32"}]}]}], ",", " ", "fireSpreadRate", ",", " ", 
             "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate", 
             ",", " ", "fireLimit", ",", " ", "naturalExtinction"}], "]"}]}], 
          ";", "\n", "     ", 
          RowBox[{"k4", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1932", " ", "k1"}], " ", "-", " ", 
                  RowBox[{"7200", " ", "k2"}], " ", "+", " ", 
                  RowBox[{"7296", " ", "k3"}]}], ")"}], " ", "/", " ", 
                "2197"}]}]}], ",", " ", "fireSpreadRate", ",", " ", 
             "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate", 
             ",", " ", "fireLimit", ",", " ", "naturalExtinction"}], "]"}]}], 
          ";", "\n", "     ", 
          RowBox[{"k5", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"439", " ", 
                  RowBox[{"k1", " ", "/", " ", "216"}]}], " ", "-", " ", 
                 RowBox[{"8", " ", "k2"}], " ", "+", " ", 
                 RowBox[{"3680", " ", 
                  RowBox[{"k3", " ", "/", " ", "513"}]}], " ", "-", " ", 
                 RowBox[{"845", " ", 
                  RowBox[{"k4", " ", "/", " ", "4104"}]}]}], ")"}]}]}], ",", 
             " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",", 
             " ", "naturalExtinction"}], "]"}]}], ";", "\n", "     ", 
          RowBox[{"k6", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "8"}], " ", 
                  RowBox[{"k1", " ", "/", " ", "27"}]}], " ", "+", " ", 
                 RowBox[{"2", " ", "k2"}], " ", "-", " ", 
                 RowBox[{"3544", " ", 
                  RowBox[{"k3", " ", "/", " ", "2565"}]}], " ", "+", " ", 
                 RowBox[{"1859", " ", 
                  RowBox[{"k4", " ", "/", " ", "4104"}]}], " ", "-", " ", 
                 RowBox[{"11", " ", 
                  RowBox[{"k5", " ", "/", " ", "40"}]}]}], ")"}]}]}], ",", 
             " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",", 
             " ", "naturalExtinction"}], "]"}]}], ";", "\n", "     ", 
          RowBox[{"nextState", " ", "=", " ", 
           RowBox[{"currentState", " ", "+", " ", 
            RowBox[{"dt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"16", " ", 
                RowBox[{"k1", " ", "/", " ", "135"}]}], " ", "+", " ", 
               RowBox[{"6656", " ", 
                RowBox[{"k3", " ", "/", " ", "12825"}]}], " ", "+", " ", 
               RowBox[{"28561", " ", 
                RowBox[{"k4", " ", "/", " ", "56430"}]}], " ", "-", " ", 
               RowBox[{"9", " ", 
                RowBox[{"k5", " ", "/", " ", "50"}]}], " ", "+", " ", 
               RowBox[{"2", " ", 
                RowBox[{"k6", " ", "/", " ", "55"}]}]}], ")"}]}]}]}], ";", 
          "\n", "     ", "nextState"}]}], "\n", "   ", "]"}]}], "\n", "]"}]}],
     ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"SIR", " ", "Simulation", " ", "Function"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"simulateSIR", " ", "=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
         ",", " ", "growthRate", ",", " ", "fireLimit", ",", " ", 
         "naturalExtinction", ",", " ", "stepSize", ",", " ", "maxTime", ",", 
         " ", "immuneFrac", ",", " ", "onFireFrac"}], "}"}], ",", "\n", "   ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "initialState", ",", " ", "steps", ",", " ", "validatedStepSize", 
           ",", " ", "validatedMaxTime", ",", " ", "S0", ",", " ", "F0", ",", 
           " ", "D0", ",", " ", "results"}], "}"}], ",", "\n", "     ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Validate", " ", "step", " ", "size", " ", "and", " ", "max", " ", 
           "time", " ", "explicitly"}], " ", "*)"}], "\n", "     ", 
         RowBox[{
          RowBox[{"validatedStepSize", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"0.001", ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"stepSize", ",", " ", "maxTime"}], "]"}]}], "]"}]}], 
          ";", "\n", "     ", 
          RowBox[{"validatedMaxTime", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"validatedStepSize", ",", " ", "maxTime"}], "]"}]}], ";", 
          "\n", "     ", 
          RowBox[{"(*", " ", 
           RowBox[{"Initial", " ", "conditions"}], " ", "*)"}], "\n", "     ", 
          RowBox[{"S0", " ", "=", " ", 
           RowBox[{"populationSize", " ", "*", " ", 
            RowBox[{"(", 
             RowBox[{
             "1", " ", "-", " ", "immuneFrac", " ", "-", " ", "onFireFrac"}], 
             ")"}]}]}], ";", "\n", "     ", 
          RowBox[{"F0", " ", "=", " ", 
           RowBox[{"populationSize", " ", "*", " ", "onFireFrac"}]}], ";", 
          "\n", "     ", 
          RowBox[{"D0", " ", "=", " ", 
           RowBox[{"populationSize", " ", "*", " ", "immuneFrac"}]}], ";", 
          "\n", "     ", 
          RowBox[{"initialState", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"S0", ",", " ", "F0", ",", " ", "D0"}], "}"}]}], ";", 
          "\n", "     ", 
          RowBox[{"steps", " ", "=", " ", 
           RowBox[{"Range", "[", 
            RowBox[{
            "0", ",", " ", "validatedMaxTime", ",", " ", 
             "validatedStepSize"}], "]"}]}], ";", "\n", "     ", 
          RowBox[{"(*", " ", 
           RowBox[{"Compute", " ", "simulation", " ", "results"}], " ", 
           "*)"}], "\n", "     ", 
          RowBox[{"results", " ", "=", " ", 
           RowBox[{"NestList", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rk45Integrator", "[", 
               RowBox[{
               "sirModel", ",", " ", "validatedStepSize", ",", " ", "#", ",", 
                " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
                "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", 
                ",", " ", "naturalExtinction"}], "]"}], " ", "&"}], ",", " ", 
             "initialState", ",", " ", 
             RowBox[{
              RowBox[{"Length", "[", "steps", "]"}], " ", "-", " ", "1"}]}], 
            "]"}]}], ";", "\n", "     ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Normalize", " ", "results", " ", "to", " ", "proportions"}], " ", 
           "*)"}], "\n", "     ", 
          RowBox[{
           RowBox[{"Transpose", "[", "results", "]"}], " ", "/", " ", 
           "populationSize"}]}]}], "\n", "   ", "]"}]}], "\n", "]"}]}], ";"}],
    "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Visualization", " ", "and", " ", "Controls"}], " ", "*)"}], "\n", 
   RowBox[{"Manipulate", "[", "\n", " ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", ",", " ", "xRange", ",", " ", "yRange"}], "}"}], ",", 
       "\n", "   ", 
       RowBox[{"(*", " ", 
        RowBox[{"Set", " ", "up", " ", "dynamic", " ", "ranges"}], " ", 
        "*)"}], "\n", "   ", 
       RowBox[{
        RowBox[{"xRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"timeStart", ",", " ", 
           RowBox[{"timeStart", " ", "+", " ", "timeWindow"}]}], "}"}]}], ";",
         "\n", "   ", 
        RowBox[{"yRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"proportionStart", ",", " ", 
           RowBox[{"proportionStart", " ", "+", " ", "proportionWindow"}]}], 
          "}"}]}], ";", "\n", "   ", 
        RowBox[{"(*", " ", 
         RowBox[{"Simulate", " ", "SIR", " ", "model"}], " ", "*)"}], "\n", 
        "   ", 
        RowBox[{"data", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
           ",", " ", "growthRate", ",", " ", "fireLimit", ",", " ", 
           "naturalExtinction", ",", " ", "timeStep", ",", " ", "duration", 
           ",", " ", "immuneFraction", ",", " ", "onFireFraction"}], "]"}]}], 
        ";", "\n", "   ", 
        RowBox[{"(*", " ", 
         RowBox[{"Plot", " ", "results"}], " ", "*)"}], "\n", "   ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"Susceptible", ",", " ", 
            RowBox[{"On", " ", "Fire"}], ",", " ", "Burned"}], " ", "*)"}], 
          "\n", "    ", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", " ", "yRange"}], "}"}]}], ",", "\n", 
          "    ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Blue", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}]}], "}"}]}], 
          ",", "\n", "    ", 
          RowBox[{"AspectRatio", " ", "->", " ", "Full"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"400", ",", " ", "300"}], "}"}]}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", "\n", "    ", 
          RowBox[{"FrameLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (days)\>\"", ",", " ", 
             "\"\<Proportion of Population\>\""}], "}"}]}], ",", "\n", "    ", 
          RowBox[{"PlotLegends", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Susceptible\>\"", ",", " ", "\"\<On Fire\>\"", ",", " ", 
             "\"\<Burned\>\""}], "}"}]}]}], "\n", "   ", "]"}]}]}], "\n", " ",
       "]"}], ",", "\n", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Parameter", " ", "Controls"}], " ", "*)"}], "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Fire Parameters\>\"", ",", " ", "Bold"}], "]"}], ",", "\n",
      " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "0.4", ",", " ", 
         "\"\<Fire Spread Rate\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1.0", ",", " ", "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "growthRate", ",", " ", "0.01", ",", " ", "\"\<Growth Rate\>\""}], 
        "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "regrowthRate", ",", " ", "0.01", ",", " ", "\"\<Regrowth Rate\>\""}],
         "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "deathRate", ",", " ", "0.1", ",", " ", "\"\<Death Rate\>\""}], "}"}],
        ",", " ", "0.05", ",", " ", "0.3", ",", " ", "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireLimit", ",", " ", "500", ",", " ", "\"\<Fire Limit\>\""}], "}"}],
        ",", " ", "50", ",", " ", "populationSize", ",", " ", "50", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "naturalExtinction", ",", " ", "0.05", ",", " ", 
         "\"\<Natural Extinction Rate\>\""}], "}"}], ",", " ", "0", ",", " ", 
       "0.5", ",", " ", "0.01", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", "Delimiter", ",", "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Initial Conditions\>\"", ",", " ", "Bold"}], "]"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "immuneFraction", ",", " ", "0.1", ",", " ", 
         "\"\<Initially Immune\>\""}], "}"}], ",", " ", "0", ",", " ", "0.9", 
       ",", " ", "0.01", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "onFireFraction", ",", " ", "0.01", ",", " ", 
         "\"\<Initially on Fire\>\""}], "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"1", " ", "-", " ", "immuneFraction"}], ",", " ", "0.01", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", "Delimiter", ",", "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Time Settings\>\"", ",", " ", "Bold"}], "]"}], ",", "\n", 
     " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStep", ",", " ", "1.0", ",", " ", "\"\<Time Step (days)\>\""}], 
        "}"}], ",", " ", "0.001", ",", " ", "1.0", ",", " ", "0.001", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "duration", ",", " ", "150", ",", " ", "\"\<Total Time (days)\>\""}], 
        "}"}], ",", " ", "10", ",", " ", "300", ",", " ", "10", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeWindow", ",", " ", "150", ",", " ", 
         "\"\<Time Window (days)\>\""}], "}"}], ",", " ", "10", ",", " ", 
       "300", ",", " ", "1", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStart", ",", " ", "0", ",", " ", "\"\<Start Time (days)\>\""}], 
        "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"duration", " ", "-", " ", "timeWindow"}], ",", " ", "1", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", "Delimiter", ",", "\n", " ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Proportion Settings\>\"", ",", " ", "Bold"}], "]"}], ",", 
     "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionWindow", ",", " ", "1", ",", " ", 
         "\"\<Proportion Window\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1", ",", " ", "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionStart", ",", " ", "0.0", ",", " ", 
         "\"\<Proportion Start\>\""}], "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"1", " ", "-", " ", "proportionWindow"}], ",", " ", "0.05", 
       ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", " ", 
     RowBox[{"ControlPlacement", " ", "->", " ", "Left"}], ",", "\n", " ", 
     RowBox[{"SaveDefinitions", " ", "->", " ", "True"}]}], "\n", "]"}], 
   "\n"}]}]], "Code",
 CellChangeTimes->{{3.942713449342407*^9, 3.942713451024933*^9}, 
   3.9427139124277287`*^9, {3.9427178478085155`*^9, 3.9427179023003025`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"9a7d27f3-f672-104f-8963-40aa5476340e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ =
     150, $CellContext`fireLimit$$ = 500, $CellContext`fireSpreadRate$$ = 
    0.4, $CellContext`growthRate$$ = 0.01, $CellContext`immuneFraction$$ = 
    0.1, $CellContext`naturalExtinction$$ = 
    0.05, $CellContext`onFireFraction$$ = 
    0.01, $CellContext`proportionStart$$ = 
    0., $CellContext`proportionWindow$$ = 1, $CellContext`regrowthRate$$ = 
    0.01, $CellContext`timeStart$$ = 0, $CellContext`timeStep$$ = 
    1., $CellContext`timeWindow$$ = 150, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["Fire Parameters", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`fireSpreadRate$$], 0.4, "Fire Spread Rate"}, 0.05, 
      1., 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`growthRate$$], 0.01, "Growth Rate"}, 0., 0.05, 0.005,
       ControlType -> Manipulator}, {{
       Hold[$CellContext`regrowthRate$$], 0.01, "Regrowth Rate"}, 0., 0.05, 
      0.005, ControlType -> Manipulator}, {{
       Hold[$CellContext`deathRate$$], 0.1, "Death Rate"}, 0.05, 0.3, 0.05, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`fireLimit$$], 500, "Fire Limit"}, 50, 1000, 50, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`naturalExtinction$$], 0.05, 
       "Natural Extinction Rate"}, 0, 0.5, 0.01, ControlType -> Manipulator}, {
      Hold[
       Style["Initial Conditions", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`immuneFraction$$], 0.1, "Initially Immune"}, 0, 0.9, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`onFireFraction$$], 0.01, "Initially on Fire"}, 0, 
      Dynamic[1 - $CellContext`immuneFraction$$], 0.01, ControlType -> 
      Manipulator}, {
      Hold[
       Style["Time Settings", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`timeStep$$], 1., "Time Step (days)"}, 0.001, 1., 
      0.001, ControlType -> Manipulator}, {{
       Hold[$CellContext`duration$$], 150, "Total Time (days)"}, 10, 300, 10, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`timeWindow$$], 150, "Time Window (days)"}, 10, 300, 
      1, ControlType -> Manipulator}, {{
       Hold[$CellContext`timeStart$$], 0, "Start Time (days)"}, 0, 
      Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
      ControlType -> Manipulator}, {
      Hold[
       Style["Proportion Settings", Bold]], Manipulate`Dump`ThisIsNotAControl,
       ControlType -> None}, {{
       Hold[$CellContext`proportionWindow$$], 1, "Proportion Window"}, 0.05, 
      1, 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`proportionStart$$], 0., "Proportion Start"}, 0, 
      Dynamic[1 - $CellContext`proportionWindow$$], 0.05, ControlType -> 
      Manipulator}}, Typeset`size$$ = {
    452.55515524864194`, {132.61904303182382`, 137.38095696817618`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ = 
        150, $CellContext`fireLimit$$ = 500, $CellContext`fireSpreadRate$$ = 
        0.4, $CellContext`growthRate$$ = 0.01, $CellContext`immuneFraction$$ = 
        0.1, $CellContext`naturalExtinction$$ = 
        0.05, $CellContext`onFireFraction$$ = 
        0.01, $CellContext`proportionStart$$ = 
        0., $CellContext`proportionWindow$$ = 1, $CellContext`regrowthRate$$ = 
        0.01, $CellContext`timeStart$$ = 0, $CellContext`timeStep$$ = 
        1., $CellContext`timeWindow$$ = 150}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> 
      Module[{$CellContext`data$, $CellContext`xRange$, \
$CellContext`yRange$}, $CellContext`xRange$ = {$CellContext`timeStart$$, \
$CellContext`timeStart$$ + $CellContext`timeWindow$$}; $CellContext`yRange$ = \
{$CellContext`proportionStart$$, $CellContext`proportionStart$$ + \
$CellContext`proportionWindow$$}; $CellContext`data$ = \
$CellContext`simulateSIR[$CellContext`fireSpreadRate$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`fireLimit$$, \
$CellContext`naturalExtinction$$, $CellContext`timeStep$$, \
$CellContext`duration$$, $CellContext`immuneFraction$$, \
$CellContext`onFireFraction$$]; ListLinePlot[{
           Part[$CellContext`data$, 1], 
           Part[$CellContext`data$, 2], 
           Part[$CellContext`data$, 3]}, 
          PlotRange -> {$CellContext`xRange$, $CellContext`yRange$}, 
          PlotStyle -> {{
             Darker[Green], 
             Thickness[0.007]}, {
             Lighter[Red], 
             Thickness[0.007]}, {
             Lighter[Blue], 
             Thickness[0.007]}}, AspectRatio -> Full, ImageSize -> {400, 300},
           Frame -> True, 
          FrameLabel -> {"Time (days)", "Proportion of Population"}, 
          PlotLegends -> {"Susceptible", "On Fire", "Burned"}]], 
      "Specifications" :> {
        Style[
        "Fire Parameters", 
         Bold], {{$CellContext`fireSpreadRate$$, 0.4, "Fire Spread Rate"}, 
         0.05, 1., 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`growthRate$$, 0.01, "Growth Rate"}, 0., 
         0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`regrowthRate$$, 0.01, "Regrowth Rate"}, 
         0., 0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`deathRate$$, 0.1, "Death Rate"}, 0.05, 
         0.3, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`fireLimit$$, 500, "Fire Limit"}, 50, 1000,
          50, Appearance -> 
         "Labeled"}, {{$CellContext`naturalExtinction$$, 0.05, 
          "Natural Extinction Rate"}, 0, 0.5, 0.01, Appearance -> "Labeled"}, 
        Delimiter, 
        Style[
        "Initial Conditions", 
         Bold], {{$CellContext`immuneFraction$$, 0.1, "Initially Immune"}, 0, 
         0.9, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`onFireFraction$$, 0.01, 
          "Initially on Fire"}, 0, 
         Dynamic[1 - $CellContext`immuneFraction$$], 0.01, Appearance -> 
         "Labeled"}, Delimiter, 
        Style[
        "Time Settings", 
         Bold], {{$CellContext`timeStep$$, 1., "Time Step (days)"}, 0.001, 1.,
          0.001, Appearance -> 
         "Labeled"}, {{$CellContext`duration$$, 150, "Total Time (days)"}, 10,
          300, 10, Appearance -> 
         "Labeled"}, {{$CellContext`timeWindow$$, 150, "Time Window (days)"}, 
         10, 300, 1, Appearance -> 
         "Labeled"}, {{$CellContext`timeStart$$, 0, "Start Time (days)"}, 0, 
         Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
         Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Proportion Settings", 
         Bold], {{$CellContext`proportionWindow$$, 1, "Proportion Window"}, 
         0.05, 1, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`proportionStart$$, 0., 
          "Proportion Start"}, 0, 
         Dynamic[1 - $CellContext`proportionWindow$$], 0.05, Appearance -> 
         "Labeled"}}, "Options" :> {ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{
      792.6732673773765, {182.76533265255853`, 187.52724658891088`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`simulateSIR = 
       Function[{$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction, $CellContext`stepSize, $CellContext`maxTime, \
$CellContext`immuneFrac, $CellContext`onFireFrac}, 
         Module[{$CellContext`initialState, $CellContext`steps, \
$CellContext`validatedStepSize, $CellContext`validatedMaxTime, \
$CellContext`S0, $CellContext`F0, $CellContext`D0, $CellContext`results}, \
$CellContext`validatedStepSize = Max[0.001, 
             
             Min[$CellContext`stepSize, $CellContext`maxTime]]; \
$CellContext`validatedMaxTime = 
           Max[$CellContext`validatedStepSize, $CellContext`maxTime]; \
$CellContext`S0 = $CellContext`populationSize (
             1 - $CellContext`immuneFrac - $CellContext`onFireFrac); \
$CellContext`F0 = $CellContext`populationSize $CellContext`onFireFrac; \
$CellContext`D0 = $CellContext`populationSize $CellContext`immuneFrac; \
$CellContext`initialState = {$CellContext`S0, $CellContext`F0, \
$CellContext`D0}; $CellContext`steps = 
           Range[0, $CellContext`validatedMaxTime, \
$CellContext`validatedStepSize]; $CellContext`results = 
           NestList[$CellContext`rk45Integrator[$CellContext`sirModel, \
$CellContext`validatedStepSize, #, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction]& , \
$CellContext`initialState, Length[$CellContext`steps] - 1]; 
          Transpose[$CellContext`results]/$CellContext`populationSize]], \
$CellContext`populationSize = 1000, $CellContext`rk45Integrator = 
       Function[{$CellContext`modelFunction, $CellContext`dt, \
$CellContext`currentState, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction}, 
         Module[{$CellContext`k1, $CellContext`k2, $CellContext`k3, \
$CellContext`k4, $CellContext`k5, $CellContext`k6, $CellContext`nextState}, \
$CellContext`k1 = $CellContext`modelFunction[$CellContext`currentState, \
$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k2 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt \
($CellContext`k1/
               4), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k3 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                3 $CellContext`k1 + 9 $CellContext`k2)/
               32), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k4 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                1932 $CellContext`k1 - 7200 $CellContext`k2 + 
                7296 $CellContext`k3)/
               2197), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k5 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt (
               439 ($CellContext`k1/216) - 8 $CellContext`k2 + 
               3680 ($CellContext`k3/513) - 
               845 ($CellContext`k4/
                4104)), $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction]; $CellContext`k6 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((-8) \
($CellContext`k1/27) + 2 $CellContext`k2 - 3544 ($CellContext`k3/2565) + 
               1859 ($CellContext`k4/4104) - 
               11 ($CellContext`k5/
                40)), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`nextState = \
$CellContext`currentState + $CellContext`dt (16 ($CellContext`k1/135) + 
              6656 ($CellContext`k3/12825) + 28561 ($CellContext`k4/56430) - 
              9 ($CellContext`k5/50) + 
              2 ($CellContext`k6/
                55)); $CellContext`nextState]], $CellContext`sirModel = 
       Function[{$CellContext`state, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction}, 
         Module[{$CellContext`S = Part[$CellContext`state, 1], $CellContext`F = 
           Part[$CellContext`state, 2], D = 
           Part[$CellContext`state, 
             3]}, {$CellContext`growthRate $CellContext`S - \
$CellContext`fireSpreadRate $CellContext`S $CellContext`F ((
             1 - $CellContext`F/$CellContext`fireLimit)/$CellContext`\
populationSize) + $CellContext`regrowthRate 
            D, $CellContext`fireSpreadRate $CellContext`S $CellContext`F ((
              1 - $CellContext`F/$CellContext`fireLimit)/$CellContext`\
populationSize) - $CellContext`deathRate $CellContext`F - \
$CellContext`naturalExtinction, $CellContext`deathRate $CellContext`F - \
$CellContext`regrowthRate D}]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.9427134601915035`*^9, 3.942713913975811*^9, 3.9427178069458637`*^9, {
   3.9427178585650063`*^9, 3.9427179038538265`*^9}, 3.942718133861328*^9, 
   3.9427232048224163`*^9, 3.942745154471842*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"1d185ee6-c6b8-eb41-9a2c-7b1e68c9548a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.4 Fire suppression", "Section",
 CellChangeTimes->{{3.9427236711107674`*^9, 
  3.942723691991297*^9}},ExpressionUUID->"c3427378-5b83-7b40-9c8e-\
14f8767f141a"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    StyleBox["dS",
     FontSlant->"Italic"], 
    StyleBox["dt",
     FontSlant->"Italic"]], "=", 
   RowBox[{
    RowBox[{
     StyleBox["growthRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "S"}], "-", 
    FractionBox[
     RowBox[{
      StyleBox["firespread",
       FontSlant->"Italic"], "*", "S", "*", 
      RowBox[{"F", "(", 
       RowBox[{"1", "-", 
        FractionBox["F", 
         StyleBox["fireLimit",
          FontSlant->"Italic"]]}], ")"}]}], 
     StyleBox[
      RowBox[{"population", " ", "size"}],
      FontSlant->"Italic"]], "+", 
    StyleBox[
     RowBox[{"regrowthRate", "*", "D"}],
     FontSlant->"Italic"]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.9427236711107674`*^9, 
  3.942723736361088*^9}},ExpressionUUID->"354f2c47-d8af-5545-a0fa-\
b0b6324188b7"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    StyleBox["dF",
     FontSlant->"Italic"], 
    StyleBox["dt",
     FontSlant->"Italic"]], "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      StyleBox["firespread",
       FontSlant->"Italic"], "*", "S", "*", 
      RowBox[{"F", "(", 
       RowBox[{"1", "-", 
        FractionBox["F", 
         StyleBox["fireLimit",
          FontSlant->"Italic"]]}], ")"}]}], 
     StyleBox[
      RowBox[{"population", " ", "size"}],
      FontSlant->"Italic"]], "-", 
    FractionBox[
     SuperscriptBox["F", "2"], 
     RowBox[{"1", "+", 
      SuperscriptBox["F", "2"]}]], "-", 
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}], "-", 
    StyleBox["naturalExtinction",
     FontSlant->"Italic"]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.9427236711107674`*^9, 3.942723755676708*^9}, {
  3.942723810363102*^9, 
  3.9427238395954323`*^9}},ExpressionUUID->"2094d32f-56a3-9646-9e01-\
f756fc78b90d"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    StyleBox["dD",
     FontSlant->"Italic"], 
    StyleBox["dt",
     FontSlant->"Italic"]], "=", 
   RowBox[{
    RowBox[{
     StyleBox["deathRate",
      FontSlant->"Italic"], 
     StyleBox["*",
      FontSlant->"Italic"], "F"}], " ", "-", 
    StyleBox[
     RowBox[{"regrowthRate", "*", "D"}],
     FontSlant->"Italic"]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.9427236711107674`*^9, 
  3.942723756545492*^9}},ExpressionUUID->"c17e5af6-0615-aa4d-b1b6-\
6576fbfd3714"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "population", " ", "size"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"populationSize", " ", "=", " ", "1000"}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "SIR", " ", "Model", " ", "Derivatives", " ", "with", " ", "Fire", " ", 
     "Suppression", " ", "Factor", " ", "and", " ", "Natural", " ", 
     "Extinction"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"sirModel", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "state", ",", " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", 
         " ", "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",",
          " ", "naturalExtinction"}], "}"}], ",", " ", "\n", "    ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"S", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"F", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
           RowBox[{"D", " ", "=", " ", 
            RowBox[{"state", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", "\n", "      ", 
          RowBox[{"(*", " ", 
           RowBox[{"dS", "/", "dt"}], " ", "*)"}], "\n", "      ", 
          RowBox[{
           RowBox[{
            RowBox[{"growthRate", "*", "S"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fireSpreadRate", "*", "S", "*", "F"}], ")"}], "/", 
             "populationSize"}], " ", "+", " ", 
            RowBox[{"D", "*", "regrowthRate"}]}], ",", "\n", "      ", "\n", 
           "      ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"dF", "/", "dt"}], " ", "-", " ", 
             RowBox[{
             "Fire", " ", "Growth", " ", "with", " ", "Suppression", " ", 
              "Term", " ", "and", " ", "Natural", " ", "Extinction"}]}], " ", 
            "*)"}], "\n", "      ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"fireSpreadRate", "*", "S", "*", "F", "*", 
               RowBox[{"(", 
                RowBox[{"1", " ", "-", " ", 
                 RowBox[{"F", "/", "fireLimit"}]}], ")"}]}], ")"}], "/", 
             "populationSize"}], " ", "-", " ", 
            RowBox[{"F", "*", "deathRate"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"F", "^", "2"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", " ", "+", " ", 
               RowBox[{"F", "^", "2"}]}], ")"}]}], " ", "-", " ", 
            "naturalExtinction"}], ",", "\n", "      ", "\n", "      ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"dD", "/", "dt"}], " ", "-", " ", 
             RowBox[{"Death", " ", "Recovery"}]}], " ", "*)"}], "\n", 
           "      ", 
           RowBox[{
            RowBox[{"F", "*", "deathRate"}], " ", "-", " ", 
            RowBox[{"D", "*", "regrowthRate"}]}]}], "\n", "    ", "}"}]}], 
        "]"}]}], "\n", "  ", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"RK4", 
     RowBox[{"(", "5", ")"}], " ", "Integrator"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"rk45Integrator", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "modelFunction", ",", " ", "dt", ",", " ", "currentState", ",", " ", 
         "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
         ",", " ", "growthRate", ",", " ", "fireLimit", ",", " ", 
         "naturalExtinction"}], "}"}], ",", " ", "\n", "    ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "k1", ",", " ", "k2", ",", " ", "k3", ",", " ", "k4", ",", " ", 
           "k5", ",", " ", "k6", ",", " ", "nextState"}], "}"}], ",", " ", 
         "\n", "      ", 
         RowBox[{
          RowBox[{"k1", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
            "currentState", ",", " ", "fireSpreadRate", ",", " ", 
             "regrowthRate", ",", " ", "deathRate", ",", " ", "growthRate", 
             ",", " ", "fireLimit", ",", " ", "naturalExtinction"}], "]"}]}], 
          ";", "\n", "      ", 
          RowBox[{"k2", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"k1", "/", "4"}]}]}], ",", " ", "fireSpreadRate", ",", 
             " ", "regrowthRate", ",", " ", "deathRate", ",", " ", 
             "growthRate", ",", " ", "fireLimit", ",", " ", 
             "naturalExtinction"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"k3", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", " ", "k1"}], " ", "+", " ", 
                  RowBox[{"9", " ", "k2"}]}], ")"}], "/", "32"}]}]}], ",", 
             " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",", 
             " ", "naturalExtinction"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"k4", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"1932", " ", "k1"}], " ", "-", " ", 
                  RowBox[{"7200", " ", "k2"}], " ", "+", " ", 
                  RowBox[{"7296", " ", "k3"}]}], ")"}], "/", "2197"}]}]}], 
             ",", " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",", 
             " ", "naturalExtinction"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"k5", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"439", " ", 
                  RowBox[{"k1", "/", "216"}]}], " ", "-", " ", 
                 RowBox[{"8", " ", "k2"}], " ", "+", " ", 
                 RowBox[{"3680", " ", 
                  RowBox[{"k3", "/", "513"}]}], " ", "-", " ", 
                 RowBox[{"845", " ", 
                  RowBox[{"k4", "/", "4104"}]}]}], ")"}]}]}], ",", " ", 
             "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",", 
             " ", "naturalExtinction"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"k6", " ", "=", " ", 
           RowBox[{"modelFunction", "[", 
            RowBox[{
             RowBox[{"currentState", " ", "+", " ", 
              RowBox[{"dt", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "8"}], " ", 
                  RowBox[{"k1", "/", "27"}]}], " ", "+", " ", 
                 RowBox[{"2", " ", "k2"}], " ", "-", " ", 
                 RowBox[{"3544", " ", 
                  RowBox[{"k3", "/", "2565"}]}], " ", "+", " ", 
                 RowBox[{"1859", " ", 
                  RowBox[{"k4", "/", "4104"}]}], " ", "-", " ", 
                 RowBox[{"11", " ", 
                  RowBox[{"k5", "/", "40"}]}]}], ")"}]}]}], ",", " ", 
             "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
             "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", ",", 
             " ", "naturalExtinction"}], "]"}]}], ";", "\n", "      ", 
          RowBox[{"nextState", " ", "=", " ", 
           RowBox[{"currentState", " ", "+", " ", 
            RowBox[{"dt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"16", " ", 
                RowBox[{"k1", "/", "135"}]}], " ", "+", " ", 
               RowBox[{"6656", " ", 
                RowBox[{"k3", "/", "12825"}]}], " ", "+", " ", 
               RowBox[{"28561", " ", 
                RowBox[{"k4", "/", "56430"}]}], " ", "-", " ", 
               RowBox[{"9", " ", 
                RowBox[{"k5", "/", "50"}]}], " ", "+", " ", 
               RowBox[{"2", " ", 
                RowBox[{"k6", "/", "55"}]}]}], ")"}]}]}]}], ";", "\n", 
          "      ", "nextState"}]}], "\n", "    ", "]"}]}], "\n", "  ", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"SIR", " ", "Simulation", " ", "Function"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"simulateSIR", " ", "=", " ", "\n", "  ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
         ",", " ", "growthRate", ",", " ", "stepSize", ",", " ", "maxTime", 
         ",", " ", "immuneFrac", ",", " ", "onFireFrac", ",", " ", 
         "fireLimit", ",", " ", "naturalExtinction"}], "}"}], ",", " ", "\n", 
       "    ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "initialState", ",", " ", "steps", ",", " ", "validatedStepSize", 
           ",", " ", "validatedMaxTime", ",", " ", "S0", ",", " ", "F0", ",", 
           " ", "D0", ",", " ", "results"}], "}"}], ",", "\n", "      ", 
         RowBox[{
          RowBox[{"validatedStepSize", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"0.001", ",", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"stepSize", ",", " ", "maxTime"}], "]"}]}], "]"}]}], 
          ";", "\n", "      ", 
          RowBox[{"validatedMaxTime", " ", "=", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"validatedStepSize", ",", " ", "maxTime"}], "]"}]}], ";", 
          "\n", "      ", "\n", "      ", 
          RowBox[{"(*", " ", 
           RowBox[{"Initial", " ", "conditions"}], " ", "*)"}], "\n", 
          "      ", 
          RowBox[{"S0", " ", "=", " ", 
           RowBox[{"populationSize", "*", 
            RowBox[{"(", 
             RowBox[{
             "1", " ", "-", " ", "immuneFrac", " ", "-", " ", "onFireFrac"}], 
             ")"}]}]}], ";", "\n", "      ", 
          RowBox[{"F0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "onFireFrac"}]}], ";", "\n", 
          "      ", 
          RowBox[{"D0", " ", "=", " ", 
           RowBox[{"populationSize", "*", "immuneFrac"}]}], ";", "\n", 
          "      ", 
          RowBox[{"initialState", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"S0", ",", " ", "F0", ",", " ", "D0"}], "}"}]}], ";", 
          "\n", "      ", 
          RowBox[{"steps", " ", "=", " ", 
           RowBox[{"Range", "[", 
            RowBox[{
            "0", ",", " ", "validatedMaxTime", ",", " ", 
             "validatedStepSize"}], "]"}]}], ";", "\n", "      ", "\n", 
          "      ", 
          RowBox[{"(*", " ", 
           RowBox[{"Compute", " ", "simulation", " ", "results"}], " ", 
           "*)"}], "\n", "      ", 
          RowBox[{"results", " ", "=", " ", 
           RowBox[{"NestList", "[", "\n", "        ", 
            RowBox[{
             RowBox[{
              RowBox[{"rk45Integrator", "[", 
               RowBox[{
               "sirModel", ",", " ", "validatedStepSize", ",", " ", "#", ",", 
                " ", "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", 
                "deathRate", ",", " ", "growthRate", ",", " ", "fireLimit", 
                ",", " ", "naturalExtinction"}], "]"}], " ", "&"}], ",", " ", 
             "initialState", ",", " ", 
             RowBox[{
              RowBox[{"Length", "[", "steps", "]"}], " ", "-", " ", "1"}]}], 
            "]"}]}], ";", "\n", "      ", "\n", "      ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Normalize", " ", "results", " ", "to", " ", "proportions"}], " ", 
           "*)"}], "\n", "      ", 
          RowBox[{
           RowBox[{"Transpose", "[", "results", "]"}], "/", 
           "populationSize"}]}]}], "\n", "    ", "]"}]}], "\n", "  ", "]"}]}],
     ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Visualization", " ", "and", " ", "Controls"}], " ", "*)"}], "\n", 
   RowBox[{"Manipulate", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", ",", " ", "xRange", ",", " ", "yRange"}], "}"}], ",", 
       "\n", "    ", 
       RowBox[{
        RowBox[{"xRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"timeStart", ",", " ", 
           RowBox[{"timeStart", " ", "+", " ", "timeWindow"}]}], "}"}]}], ";",
         "\n", "    ", 
        RowBox[{"yRange", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"proportionStart", ",", " ", 
           RowBox[{"proportionStart", " ", "+", " ", "proportionWindow"}]}], 
          "}"}]}], ";", "\n", "    ", "\n", "    ", 
        RowBox[{"(*", " ", 
         RowBox[{"Simulate", " ", "SIR", " ", "model"}], " ", "*)"}], "\n", 
        "    ", 
        RowBox[{"data", " ", "=", " ", 
         RowBox[{"simulateSIR", "[", 
          RowBox[{
          "fireSpreadRate", ",", " ", "regrowthRate", ",", " ", "deathRate", 
           ",", " ", "growthRate", ",", " ", "timeStep", ",", " ", "duration",
            ",", " ", "immuneFraction", ",", " ", "onFireFraction", ",", " ", 
           "fireLimit", ",", " ", "naturalExtinction"}], "]"}]}], ";", "\n", 
        "    ", "\n", "    ", 
        RowBox[{"(*", " ", 
         RowBox[{"Plot", " ", "results"}], " ", "*)"}], "\n", "    ", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{"data", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", " ", "\n", 
          "      ", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"xRange", ",", " ", "yRange"}], "}"}]}], ",", " ", "\n", 
          "      ", 
          RowBox[{"PlotStyle", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "[", "Green", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Red", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Lighter", "[", "Blue", "]"}], ",", " ", 
               RowBox[{"Thickness", "[", "0.007", "]"}]}], "}"}]}], "}"}]}], 
          ",", " ", "\n", "      ", 
          RowBox[{"AspectRatio", " ", "->", " ", "Full"}], ",", " ", 
          RowBox[{"ImageSize", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"400", ",", " ", "300"}], "}"}]}], ",", " ", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", "\n", "      ", 
          RowBox[{"FrameLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (days)\>\"", ",", " ", 
             "\"\<Proportion of Population\>\""}], "}"}]}], ",", " ", "\n", 
          "      ", 
          RowBox[{"PlotLegends", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Susceptible\>\"", ",", " ", "\"\<On Fire\>\"", ",", " ", 
             "\"\<Burned\>\""}], "}"}]}]}], "\n", "    ", "]"}]}]}], "\n", 
      "  ", "]"}], ",", "\n", "  ", "\n", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"Parameter", " ", "Controls"}], " ", "*)"}], "\n", "  ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Fire Parameters\>\"", ",", " ", "Bold"}], "]"}], ",", "\n",
      "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireSpreadRate", ",", " ", "0.4", ",", " ", 
         "\"\<Fire Spread Rate\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1.0", ",", " ", "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "growthRate", ",", " ", "0.01", ",", " ", "\"\<Growth Rate\>\""}], 
        "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "regrowthRate", ",", " ", "0.01", ",", " ", "\"\<Regrowth Rate\>\""}],
         "}"}], ",", " ", "0.", ",", " ", "0.05", ",", " ", "0.005", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "deathRate", ",", " ", "0.1", ",", " ", "\"\<Death Rate\>\""}], "}"}],
        ",", " ", "0.05", ",", " ", "0.3", ",", " ", "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fireLimit", ",", " ", "500", ",", " ", "\"\<Fire Limit\>\""}], "}"}],
        ",", " ", "100", ",", " ", "1000", ",", " ", "50", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "naturalExtinction", ",", " ", "0.01", ",", " ", 
         "\"\<Natural Extinction Rate\>\""}], "}"}], ",", " ", "0.0", ",", 
       " ", "0.1", ",", " ", "0.01", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", "\n", "  ", "Delimiter", ",", "\n", "  ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Initial Conditions\>\"", ",", " ", "Bold"}], "]"}], ",", 
     "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "immuneFraction", ",", " ", "0.1", ",", " ", 
         "\"\<Initially Immune\>\""}], "}"}], ",", " ", "0", ",", " ", "0.9", 
       ",", " ", "0.01", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "onFireFraction", ",", " ", "0.01", ",", " ", 
         "\"\<Initially on Fire\>\""}], "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"1", " ", "-", " ", "immuneFraction"}], ",", " ", "0.01", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", "\n", "  ", "Delimiter", ",", " ", "\n", "  ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Time Settings\>\"", ",", " ", "Bold"}], "]"}], ",", "\n", 
     "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStep", ",", " ", "1.0", ",", " ", "\"\<Time Step (days)\>\""}], 
        "}"}], ",", " ", "0.001", ",", " ", "1.0", ",", " ", "0.001", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "duration", ",", " ", "150", ",", " ", "\"\<Total Time (days)\>\""}], 
        "}"}], ",", " ", "10", ",", " ", "300", ",", " ", "10", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeWindow", ",", " ", "150", ",", " ", 
         "\"\<Time Window (days)\>\""}], "}"}], ",", " ", "10", ",", " ", 
       "300", ",", " ", "1", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timeStart", ",", " ", "0", ",", " ", "\"\<Start Time (days)\>\""}], 
        "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"duration", " ", "-", " ", "timeWindow"}], ",", " ", "1", ",", 
       " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", "\n", "  ", "Delimiter", ",", " ", "\n", "  ", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Proportion Settings\>\"", ",", " ", "Bold"}], "]"}], ",", 
     "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionWindow", ",", " ", "1", ",", " ", 
         "\"\<Proportion Window\>\""}], "}"}], ",", " ", "0.05", ",", " ", 
       "1", ",", " ", "0.05", ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "proportionStart", ",", " ", "0.0", ",", " ", 
         "\"\<Proportion Start\>\""}], "}"}], ",", " ", "0", ",", " ", 
       RowBox[{"1", " ", "-", " ", "proportionWindow"}], ",", " ", "0.05", 
       ",", " ", 
       RowBox[{"Appearance", " ", "->", " ", "\"\<Labeled\>\""}]}], "}"}], 
     ",", "\n", "  ", "\n", "  ", 
     RowBox[{"ControlPlacement", " ", "->", " ", "Left"}], ",", " ", "\n", 
     "  ", 
     RowBox[{"SaveDefinitions", " ", "->", " ", "True"}]}], "\n", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.942722489089514*^9, 3.9427224910496006`*^9}, 
   3.942722527074356*^9, {3.942722557964592*^9, 3.9427225835220203`*^9}, 
   3.942722850466526*^9, 3.9427238575415516`*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"54b81a61-6483-c341-a090-6206caddef91"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ =
     150, $CellContext`fireLimit$$ = 500, $CellContext`fireSpreadRate$$ = 
    0.4, $CellContext`growthRate$$ = 0.01, $CellContext`immuneFraction$$ = 
    0.1, $CellContext`naturalExtinction$$ = 
    0.01, $CellContext`onFireFraction$$ = 
    0.01, $CellContext`proportionStart$$ = 
    0., $CellContext`proportionWindow$$ = 1, $CellContext`regrowthRate$$ = 
    0.01, $CellContext`timeStart$$ = 0, $CellContext`timeStep$$ = 
    1., $CellContext`timeWindow$$ = 150, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[
       Style["Fire Parameters", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`fireSpreadRate$$], 0.4, "Fire Spread Rate"}, 0.05, 
      1., 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`growthRate$$], 0.01, "Growth Rate"}, 0., 0.05, 0.005,
       ControlType -> Manipulator}, {{
       Hold[$CellContext`regrowthRate$$], 0.01, "Regrowth Rate"}, 0., 0.05, 
      0.005, ControlType -> Manipulator}, {{
       Hold[$CellContext`deathRate$$], 0.1, "Death Rate"}, 0.05, 0.3, 0.05, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`fireLimit$$], 500, "Fire Limit"}, 100, 1000, 50, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`naturalExtinction$$], 0.01, 
       "Natural Extinction Rate"}, 0., 0.1, 0.01, ControlType -> 
      Manipulator}, {
      Hold[
       Style["Initial Conditions", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`immuneFraction$$], 0.1, "Initially Immune"}, 0, 0.9, 
      0.01, ControlType -> Manipulator}, {{
       Hold[$CellContext`onFireFraction$$], 0.01, "Initially on Fire"}, 0, 
      Dynamic[1 - $CellContext`immuneFraction$$], 0.01, ControlType -> 
      Manipulator}, {
      Hold[
       Style["Time Settings", Bold]], Manipulate`Dump`ThisIsNotAControl, 
      ControlType -> None}, {{
       Hold[$CellContext`timeStep$$], 1., "Time Step (days)"}, 0.001, 1., 
      0.001, ControlType -> Manipulator}, {{
       Hold[$CellContext`duration$$], 150, "Total Time (days)"}, 10, 300, 10, 
      ControlType -> Manipulator}, {{
       Hold[$CellContext`timeWindow$$], 150, "Time Window (days)"}, 10, 300, 
      1, ControlType -> Manipulator}, {{
       Hold[$CellContext`timeStart$$], 0, "Start Time (days)"}, 0, 
      Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
      ControlType -> Manipulator}, {
      Hold[
       Style["Proportion Settings", Bold]], Manipulate`Dump`ThisIsNotAControl,
       ControlType -> None}, {{
       Hold[$CellContext`proportionWindow$$], 1, "Proportion Window"}, 0.05, 
      1, 0.05, ControlType -> Manipulator}, {{
       Hold[$CellContext`proportionStart$$], 0., "Proportion Start"}, 0, 
      Dynamic[1 - $CellContext`proportionWindow$$], 0.05, ControlType -> 
      Manipulator}}, Typeset`size$$ = {
    452.55515524864194`, {132.61904303182382`, 137.38095696817618`}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = False, 
    Typeset`keyframeActionsQ$$ = False, Typeset`keyframeList$$ = {}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`deathRate$$ = 0.1, $CellContext`duration$$ = 
        150, $CellContext`fireLimit$$ = 500, $CellContext`fireSpreadRate$$ = 
        0.4, $CellContext`growthRate$$ = 0.01, $CellContext`immuneFraction$$ = 
        0.1, $CellContext`naturalExtinction$$ = 
        0.01, $CellContext`onFireFraction$$ = 
        0.01, $CellContext`proportionStart$$ = 
        0., $CellContext`proportionWindow$$ = 1, $CellContext`regrowthRate$$ = 
        0.01, $CellContext`timeStart$$ = 0, $CellContext`timeStep$$ = 
        1., $CellContext`timeWindow$$ = 150}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$, Typeset`keyframeActionsQ$$, 
        Typeset`keyframeList$$}, "Body" :> 
      Module[{$CellContext`data$, $CellContext`xRange$, \
$CellContext`yRange$}, $CellContext`xRange$ = {$CellContext`timeStart$$, \
$CellContext`timeStart$$ + $CellContext`timeWindow$$}; $CellContext`yRange$ = \
{$CellContext`proportionStart$$, $CellContext`proportionStart$$ + \
$CellContext`proportionWindow$$}; $CellContext`data$ = \
$CellContext`simulateSIR[$CellContext`fireSpreadRate$$, \
$CellContext`regrowthRate$$, $CellContext`deathRate$$, \
$CellContext`growthRate$$, $CellContext`timeStep$$, $CellContext`duration$$, \
$CellContext`immuneFraction$$, $CellContext`onFireFraction$$, \
$CellContext`fireLimit$$, $CellContext`naturalExtinction$$]; ListLinePlot[{
           Part[$CellContext`data$, 1], 
           Part[$CellContext`data$, 2], 
           Part[$CellContext`data$, 3]}, 
          PlotRange -> {$CellContext`xRange$, $CellContext`yRange$}, 
          PlotStyle -> {{
             Darker[Green], 
             Thickness[0.007]}, {
             Lighter[Red], 
             Thickness[0.007]}, {
             Lighter[Blue], 
             Thickness[0.007]}}, AspectRatio -> Full, ImageSize -> {400, 300},
           Frame -> True, 
          FrameLabel -> {"Time (days)", "Proportion of Population"}, 
          PlotLegends -> {"Susceptible", "On Fire", "Burned"}]], 
      "Specifications" :> {
        Style[
        "Fire Parameters", 
         Bold], {{$CellContext`fireSpreadRate$$, 0.4, "Fire Spread Rate"}, 
         0.05, 1., 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`growthRate$$, 0.01, "Growth Rate"}, 0., 
         0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`regrowthRate$$, 0.01, "Regrowth Rate"}, 
         0., 0.05, 0.005, Appearance -> 
         "Labeled"}, {{$CellContext`deathRate$$, 0.1, "Death Rate"}, 0.05, 
         0.3, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`fireLimit$$, 500, "Fire Limit"}, 100, 
         1000, 50, Appearance -> 
         "Labeled"}, {{$CellContext`naturalExtinction$$, 0.01, 
          "Natural Extinction Rate"}, 0., 0.1, 0.01, Appearance -> "Labeled"},
         Delimiter, 
        Style[
        "Initial Conditions", 
         Bold], {{$CellContext`immuneFraction$$, 0.1, "Initially Immune"}, 0, 
         0.9, 0.01, Appearance -> 
         "Labeled"}, {{$CellContext`onFireFraction$$, 0.01, 
          "Initially on Fire"}, 0, 
         Dynamic[1 - $CellContext`immuneFraction$$], 0.01, Appearance -> 
         "Labeled"}, Delimiter, 
        Style[
        "Time Settings", 
         Bold], {{$CellContext`timeStep$$, 1., "Time Step (days)"}, 0.001, 1.,
          0.001, Appearance -> 
         "Labeled"}, {{$CellContext`duration$$, 150, "Total Time (days)"}, 10,
          300, 10, Appearance -> 
         "Labeled"}, {{$CellContext`timeWindow$$, 150, "Time Window (days)"}, 
         10, 300, 1, Appearance -> 
         "Labeled"}, {{$CellContext`timeStart$$, 0, "Start Time (days)"}, 0, 
         Dynamic[$CellContext`duration$$ - $CellContext`timeWindow$$], 1, 
         Appearance -> "Labeled"}, Delimiter, 
        Style[
        "Proportion Settings", 
         Bold], {{$CellContext`proportionWindow$$, 1, "Proportion Window"}, 
         0.05, 1, 0.05, Appearance -> 
         "Labeled"}, {{$CellContext`proportionStart$$, 0., 
          "Proportion Start"}, 0, 
         Dynamic[1 - $CellContext`proportionWindow$$], 0.05, Appearance -> 
         "Labeled"}}, "Options" :> {ControlPlacement -> Left}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{
      792.6732673773765, {191.37383265255855`, 196.1357465889109}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`simulateSIR = 
       Function[{$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`stepSize, \
$CellContext`maxTime, $CellContext`immuneFrac, $CellContext`onFireFrac, \
$CellContext`fireLimit, $CellContext`naturalExtinction}, 
         Module[{$CellContext`initialState, $CellContext`steps, \
$CellContext`validatedStepSize, $CellContext`validatedMaxTime, \
$CellContext`S0, $CellContext`F0, $CellContext`D0, $CellContext`results}, \
$CellContext`validatedStepSize = Max[0.001, 
             
             Min[$CellContext`stepSize, $CellContext`maxTime]]; \
$CellContext`validatedMaxTime = 
           Max[$CellContext`validatedStepSize, $CellContext`maxTime]; \
$CellContext`S0 = $CellContext`populationSize (
             1 - $CellContext`immuneFrac - $CellContext`onFireFrac); \
$CellContext`F0 = $CellContext`populationSize $CellContext`onFireFrac; \
$CellContext`D0 = $CellContext`populationSize $CellContext`immuneFrac; \
$CellContext`initialState = {$CellContext`S0, $CellContext`F0, \
$CellContext`D0}; $CellContext`steps = 
           Range[0, $CellContext`validatedMaxTime, \
$CellContext`validatedStepSize]; $CellContext`results = 
           NestList[$CellContext`rk45Integrator[$CellContext`sirModel, \
$CellContext`validatedStepSize, #, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction]& , \
$CellContext`initialState, Length[$CellContext`steps] - 1]; 
          Transpose[$CellContext`results]/$CellContext`populationSize]], \
$CellContext`populationSize = 1000, $CellContext`rk45Integrator = 
       Function[{$CellContext`modelFunction, $CellContext`dt, \
$CellContext`currentState, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction}, 
         Module[{$CellContext`k1, $CellContext`k2, $CellContext`k3, \
$CellContext`k4, $CellContext`k5, $CellContext`k6, $CellContext`nextState}, \
$CellContext`k1 = $CellContext`modelFunction[$CellContext`currentState, \
$CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k2 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt \
($CellContext`k1/
               4), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k3 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                3 $CellContext`k1 + 9 $CellContext`k2)/
               32), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k4 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((
                1932 $CellContext`k1 - 7200 $CellContext`k2 + 
                7296 $CellContext`k3)/
               2197), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`k5 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt (
               439 ($CellContext`k1/216) - 8 $CellContext`k2 + 
               3680 ($CellContext`k3/513) - 
               845 ($CellContext`k4/
                4104)), $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction]; $CellContext`k6 = \
$CellContext`modelFunction[$CellContext`currentState + $CellContext`dt ((-8) \
($CellContext`k1/27) + 2 $CellContext`k2 - 3544 ($CellContext`k3/2565) + 
               1859 ($CellContext`k4/4104) - 
               11 ($CellContext`k5/
                40)), $CellContext`fireSpreadRate, $CellContext`regrowthRate, \
$CellContext`deathRate, $CellContext`growthRate, $CellContext`fireLimit, \
$CellContext`naturalExtinction]; $CellContext`nextState = \
$CellContext`currentState + $CellContext`dt (16 ($CellContext`k1/135) + 
              6656 ($CellContext`k3/12825) + 28561 ($CellContext`k4/56430) - 
              9 ($CellContext`k5/50) + 
              2 ($CellContext`k6/
                55)); $CellContext`nextState]], $CellContext`sirModel = 
       Function[{$CellContext`state, $CellContext`fireSpreadRate, \
$CellContext`regrowthRate, $CellContext`deathRate, $CellContext`growthRate, \
$CellContext`fireLimit, $CellContext`naturalExtinction}, 
         Module[{$CellContext`S = Part[$CellContext`state, 1], $CellContext`F = 
           Part[$CellContext`state, 2], D = 
           Part[$CellContext`state, 
             3]}, {$CellContext`growthRate $CellContext`S - \
($CellContext`fireSpreadRate $CellContext`S \
$CellContext`F)/$CellContext`populationSize + 
           D $CellContext`regrowthRate, ($CellContext`fireSpreadRate \
$CellContext`S $CellContext`F (
              1 - $CellContext`F/$CellContext`fireLimit))/$CellContext`\
populationSize - $CellContext`F $CellContext`deathRate - $CellContext`F^2/(
           1 + $CellContext`F^2) - $CellContext`naturalExtinction, \
$CellContext`F $CellContext`deathRate - D $CellContext`regrowthRate}]]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.942722559210825*^9, 3.9427226410453033`*^9, 3.942722852647587*^9, 
   3.9427238587129707`*^9, {3.942724343262991*^9, 3.9427243573815975`*^9}, 
   3.9427244398456154`*^9, {3.9427375815453377`*^9, 3.942737590938469*^9}},
 CellLabel->
  "Out[152]=",ExpressionUUID->"cd0043f2-0d75-8046-bb94-9820bee36340"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "A  P  P  E  N  D  I  X    ",
 StyleBox[
 CounterBox["AppendixSectionLabel"], "BookChapterNumber"]
}], "AppendixSectionLabel",ExpressionUUID->"522278ff-a9c2-ed4b-8d86-\
aa101fca803b"],

Cell["Enter appendix title here", "AppendixSection",ExpressionUUID->"7ab28208-574b-4346-8ec3-824712108aed"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1428, 729.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->FrontEnd`FileName[{"Book"}, "Monograph.nb", 
  CharacterEncoding -> "UTF-8"],
PrivateNotebookOptions -> {"NotebookAuthor" -> ""},
ExpressionUUID->"e01bb1a1-09d4-5741-a3cf-c2bb044658e2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 85, 0, 99, "BookChapterNumber",ExpressionUUID->"8acb7c6c-d3ae-364f-913e-789658128682"],
Cell[664, 24, 216, 4, 125, "BookChapterTitle",ExpressionUUID->"c525ce74-888d-264f-864b-dd137e0fd588"],
Cell[CellGroupData[{
Cell[905, 32, 317, 8, 43, "Subtitle",ExpressionUUID->"9170263a-4ec9-0548-aa98-051e5ed25acc"],
Cell[1225, 42, 278, 6, 13, "Text",ExpressionUUID->"2593fa21-375a-d741-9909-241097411988"],
Cell[CellGroupData[{
Cell[1528, 52, 297, 11, 62, "Section",ExpressionUUID->"0ab83411-9d95-2040-a4a7-20cfe6d3b9ba"],
Cell[1828, 65, 316, 6, 13, "Text",ExpressionUUID->"d31298c6-f854-7e41-9ae1-07ad88d5d032"],
Cell[2147, 73, 243, 4, 13, "Text",ExpressionUUID->"903f321c-5b54-3a40-9bdf-8082a610a377"],
Cell[2393, 79, 694, 22, 32, "EquationNumbered",ExpressionUUID->"d80ffd99-bd60-0045-a62c-75cdcd409203"],
Cell[3090, 103, 912, 31, 32, "EquationNumbered",ExpressionUUID->"79f03985-80e9-ee47-9e87-480f8a4153fe"],
Cell[4005, 136, 690, 23, 30, "EquationNumbered",ExpressionUUID->"5ebef9e8-e419-164b-9b6b-dad861e3db6d"],
Cell[4698, 161, 316, 5, 13, "Text",ExpressionUUID->"c8f5ed6b-1bc4-5e4d-bfed-748ced127682"],
Cell[CellGroupData[{
Cell[5039, 170, 19715, 444, 1749, "Input",ExpressionUUID->"ea636ad0-04f2-754e-ab82-1032df9ccbbb"],
Cell[24757, 616, 11590, 211, 335, "Output",ExpressionUUID->"02f16c01-ccc7-994b-8678-b0e0811fa8ee"]
}, Open  ]],
Cell[36362, 830, 553, 10, 13, "Text",ExpressionUUID->"2ee45434-cfba-d14a-a4a8-550b224a82d2"],
Cell[36918, 842, 1234, 19, 28, "Text",ExpressionUUID->"9b259509-3a40-a048-a438-80ff2c0c7e77"],
Cell[38155, 863, 154, 3, 26, "Input",ExpressionUUID->"9de6ff98-9836-5347-83bf-7cb79fe0cae6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38358, 872, 218, 4, 43, "Subtitle",ExpressionUUID->"ae7dbb48-688a-ab42-974a-3e6f9af9da45"],
Cell[CellGroupData[{
Cell[38601, 880, 328, 6, 62, "Section",ExpressionUUID->"54333da6-be24-ed40-89c4-b4ca05e51e70"],
Cell[38932, 888, 71, 0, 13, "Text",ExpressionUUID->"68e12762-c2a7-6f4d-9fc6-62f376de2341"],
Cell[39006, 890, 791, 25, 32, "EquationNumbered",ExpressionUUID->"68e42aeb-15d2-f44f-9dba-e08b0a4e8a7e"],
Cell[39800, 917, 964, 33, 32, "EquationNumbered",ExpressionUUID->"84979b7c-7777-9f41-ae82-25e8d09fb98f"],
Cell[40767, 952, 793, 26, 30, "EquationNumbered",ExpressionUUID->"e4d2aac6-aa1b-354c-9614-df52cf34420c"],
Cell[CellGroupData[{
Cell[41585, 982, 23576, 512, 2052, "Code",ExpressionUUID->"7a686e6c-7c70-0b43-917a-000412e26724"],
Cell[65164, 1496, 14481, 258, 364, "Output",ExpressionUUID->"ba4c0222-5803-5443-bc05-c9e354ca65a2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79694, 1760, 363, 10, 62, "Section",ExpressionUUID->"0dbbeaeb-a675-e044-b36e-755dbf0b77f2"],
Cell[80060, 1772, 948, 31, 35, "EquationNumbered",ExpressionUUID->"3792d7d4-f4be-7840-a4e2-1c57bcb083da"],
Cell[81011, 1805, 994, 33, 35, "EquationNumbered",ExpressionUUID->"89d365ce-5858-9947-a7bc-7b0237ad375c"],
Cell[82008, 1840, 736, 25, 30, "EquationNumbered",ExpressionUUID->"2e18719f-ccc6-8841-9840-1f556bc2cc10"],
Cell[CellGroupData[{
Cell[82769, 1869, 21840, 491, 2063, "Code",ExpressionUUID->"b32f7c62-1bf0-e84b-8b7e-e343fa6d2d8f"],
Cell[104612, 2362, 13640, 245, 382, "Output",ExpressionUUID->"bab8c22a-8feb-594b-a4c3-ecd4a15e31f3"],
Cell[118255, 2609, 292, 6, 23, "Message",ExpressionUUID->"4e81a163-def2-604e-a4f9-4eb49a172bf4"],
Cell[118550, 2617, 292, 6, 23, "Message",ExpressionUUID->"038f795b-89fb-5444-bd35-f3dc23c3f1eb"],
Cell[118845, 2625, 292, 6, 23, "Message",ExpressionUUID->"d65741ef-facb-4b40-afcf-84d5c6370f11"],
Cell[119140, 2633, 417, 8, 23, "Message",ExpressionUUID->"8420246c-47cb-5a42-8ddf-c88b046f1f57"],
Cell[119560, 2643, 291, 6, 23, "Message",ExpressionUUID->"cddfe44c-5e66-734c-b02e-122ee5e893d7"],
Cell[119854, 2651, 291, 6, 23, "Message",ExpressionUUID->"fbb12755-cdd4-8548-ac19-5a93ef500798"],
Cell[120148, 2659, 291, 6, 23, "Message",ExpressionUUID->"0feff29b-1797-bf49-8f61-748621e28547"],
Cell[120442, 2667, 418, 8, 23, "Message",ExpressionUUID->"19595ba0-0a7c-ad4d-9a47-df16d454ded7"],
Cell[120863, 2677, 292, 6, 23, "Message",ExpressionUUID->"12b827a0-4b33-9e48-a56c-defa76e30565"],
Cell[121158, 2685, 292, 6, 23, "Message",ExpressionUUID->"b03c3276-d2f9-8a4b-a9c5-2220a5be1ea3"],
Cell[121453, 2693, 292, 6, 23, "Message",ExpressionUUID->"fe7b9c1b-0af5-fd47-afca-75d4f369f657"],
Cell[121748, 2701, 421, 8, 23, "Message",ExpressionUUID->"67f1890b-828b-dc45-8d91-d01493aaf329"],
Cell[122172, 2711, 293, 6, 23, "Message",ExpressionUUID->"abf81de1-d3ab-5c4e-bf46-bf05f0a8ebba"],
Cell[122468, 2719, 295, 6, 23, "Message",ExpressionUUID->"d0784125-1e83-b547-ac1f-5ec77124ab5f"],
Cell[122766, 2727, 293, 6, 23, "Message",ExpressionUUID->"b22305c9-a3a2-cc47-b25d-b8d6c1e546c5"],
Cell[123062, 2735, 422, 8, 23, "Message",ExpressionUUID->"bd3ac80b-8e43-e34e-9bfd-75a9570ed289"],
Cell[123487, 2745, 3705, 53, 97, "Message",ExpressionUUID->"2cdcd35d-9a7d-5843-950a-626323661319"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127229, 2803, 21977, 486, 2084, "Code",ExpressionUUID->"5bee933d-6a2a-ec4d-a2c5-69472cb92f4c"],
Cell[149209, 3291, 13448, 233, 425, "Output",ExpressionUUID->"0e791458-cd12-3d48-9258-8a1cc4f1c66f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162694, 3529, 12270, 280, 1119, "Code",ExpressionUUID->"26632834-c4fe-064a-9549-29ff6f83ea8b"],
Cell[174967, 3811, 14130, 249, 425, "Output",ExpressionUUID->"359ff6c5-0d34-ee4a-9ac9-c8311925d9af"],
Cell[189100, 4062, 3809, 55, 97, "Message",ExpressionUUID->"9920a177-b082-3342-b8ad-241e73df6ec5"],
Cell[192912, 4119, 3809, 55, 97, "Message",ExpressionUUID->"0aef425a-c9d8-f54f-9eb9-a8a91326d759"],
Cell[196724, 4176, 3806, 55, 97, "Message",ExpressionUUID->"bfcf78a8-db4a-5048-beac-1f8f9605ffdd"],
Cell[200533, 4233, 421, 8, 23, "Message",ExpressionUUID->"74701c81-2ebf-f540-9f66-29801b392ffb"],
Cell[200957, 4243, 294, 6, 23, "Message",ExpressionUUID->"7acbce89-6c9f-634c-b7aa-59d84fe4c381"],
Cell[201254, 4251, 294, 6, 23, "Message",ExpressionUUID->"841a31d3-cf90-cb4c-ba38-268550eb2f74"],
Cell[201551, 4259, 296, 6, 23, "Message",ExpressionUUID->"fdf24658-0cb9-0149-9b21-ea2433bae563"],
Cell[201850, 4267, 421, 8, 23, "Message",ExpressionUUID->"1929b9d4-3237-cc4f-b171-1942adc128e9"],
Cell[202274, 4277, 3705, 53, 97, "Message",ExpressionUUID->"e6d1c11e-260d-9044-82bb-f02123728c74"],
Cell[205982, 4332, 3703, 53, 97, "Message",ExpressionUUID->"6b053862-4ff5-1341-bf3f-e60c57c37994"],
Cell[209688, 4387, 3703, 53, 97, "Message",ExpressionUUID->"66f85493-c8ab-cd4f-8646-9d990b557d78"],
Cell[213394, 4442, 424, 8, 23, "Message",ExpressionUUID->"6a6537ed-30ac-6146-aa74-feb2d63dd9e1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[213867, 4456, 222, 4, 62, "Section",ExpressionUUID->"71d2af2e-ca76-1c4b-a383-2de53e46e5c6"],
Cell[214092, 4462, 234, 4, 14, "Text",ExpressionUUID->"3941b58a-bda5-a540-af76-6b969c75befc"],
Cell[214329, 4468, 1022, 35, 42, "EquationNumbered",ExpressionUUID->"292a27eb-b1b4-ac4f-8f8f-91ba6560c00c"],
Cell[215354, 4505, 1065, 36, 42, "EquationNumbered",ExpressionUUID->"f8a72074-fe31-0b4a-a84b-3f02bdac8875"],
Cell[216422, 4543, 738, 25, 30, "EquationNumbered",ExpressionUUID->"de7c2ab4-44eb-4242-bb96-1241c04f5dab"],
Cell[CellGroupData[{
Cell[217185, 4572, 21928, 497, 1467, "Code",ExpressionUUID->"9a7d27f3-f672-104f-8963-40aa5476340e"],
Cell[239116, 5071, 14147, 251, 383, "Output",ExpressionUUID->"1d185ee6-c6b8-eb41-9a2c-7b1e68c9548a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[253312, 5328, 167, 3, 62, "Section",ExpressionUUID->"c3427378-5b83-7b40-9c8e-14f8767f141a"],
Cell[253482, 5333, 896, 31, 52, "EquationNumbered",ExpressionUUID->"354f2c47-d8af-5545-a0fa-b0b6324188b7"],
Cell[254381, 5366, 1039, 35, 52, "EquationNumbered",ExpressionUUID->"2094d32f-56a3-9646-9e01-f756fc78b90d"],
Cell[255423, 5403, 549, 19, 39, "EquationNumbered",ExpressionUUID->"c17e5af6-0615-aa4d-b1b6-6576fbfd3714"],
Cell[CellGroupData[{
Cell[255997, 5426, 22107, 504, 1673, "Code",ExpressionUUID->"54b81a61-6483-c341-a090-6206caddef91"],
Cell[278107, 5932, 14183, 253, 401, "Output",ExpressionUUID->"cd0043f2-0d75-8046-bb94-9820bee36340"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[292339, 6191, 200, 5, 84, "AppendixSectionLabel",ExpressionUUID->"522278ff-a9c2-ed4b-8d86-aa101fca803b"],
Cell[292542, 6198, 107, 0, 125, "AppendixSection",ExpressionUUID->"7ab28208-574b-4346-8ec3-824712108aed"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

